function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function withLeafletMap(n){var e=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.initializeMap=this.initializeMap.bind(this),this.getMap=this.getMap.bind(this),this.fitWorld=this.fitWorld.bind(this),this.state={mapCreated:!1}}return _inherits(t,e),_createClass(t,[{key:"initializeMap",value:function(e){return this.map=this.loadMap(e),this.setState({mapCreated:!0}),Promise.resolve(this.map)}},{key:"getMap",value:function(){return this.map}},{key:"loadMap",value:function(e){var t=L.map(e);return L.tileLayer("//api.tiles.mapbox.com/v4/mapbox.high-contrast/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamlmZnlvbmRlbWFuZCIsImEiOiJiXzZGQ1o4In0.-cJyN_e12UG_Pjr5qZ7q3A",{attribution:'Map data &copy; <a href="//openstreetmap.org">OpenStreetMap</a> contributors, <a href="//creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery &copy; <a href="//mapbox.com">Mapbox</a>'}).addTo(t),t}},{key:"fitWorld",value:function(e){var t=arguments.length<=0||e===undefined?[]:e,n=[];n=0<t.length?L.latLngBounds(t):L.latLngBounds([[43.7085,-79.3959]]),this.map.fitBounds(n,{padding:[160,160],maxZoom:15})}},{key:"render",value:function(){return React.createElement(n,_extends({},this.props,{initializeMap:this.initializeMap,getMap:this.getMap,mapCreated:this.state.mapCreated,fitWorld:this.fitWorld}))}}]),t}(React.Component);return e.displayName="WithLeaflet"+n.name,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function googleAutocompleteHOC(n,r,a){var e={initialValue:React.PropTypes.string,hasError:React.PropTypes.bool,errorMsg:React.PropTypes.string,getCountryCode:React.PropTypes.bool,mappings:React.PropTypes.object,onResultClicked:React.PropTypes.func},t={mappings:{}},s=n.name,i=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.getData=this.getData.bind(this),this.handleInputChanged=this.handleInputChanged.bind(this),this.handleGoogleCallback=this.handleGoogleCallback.bind(this),this.handleResultClicked=this.handleResultClicked.bind(this),this.processPlace=this.processPlace.bind(this),this.processCountryCode=this.processCountryCode.bind(this),this.processAddressComponent=this.processAddressComponent.bind(this),this.processUnknownStreetNumber=this.processUnknownStreetNumber.bind(this),this.processCoordinates=this.processCoordinates.bind(this),this.assignAddressValue=this.assignAddressValue.bind(this),this.reset=this.reset.bind(this),this.clickedAddress={},this.state={results:[],inputData:""}}return _inherits(t,e),_createClass(t,[{key:"getData",value:function(e){(new google.maps.places.AutocompleteService).getPlacePredictions({input:e||" ",types:a,bounds:new google.maps.LatLngBounds(new google.maps.LatLng(37.280609,-94.570313),new google.maps.LatLng(52.681378,-70.664063))},this.handleGoogleCallback)}},{key:"reset",value:function(){this.component.reset()}},{key:"handleGoogleCallback",value:function(e,t){t==google.maps.places.PlacesServiceStatus.OK&&this.setState({results:e})}},{key:"handleInputChanged",value:function(e){this.setState({inputData:e}),this.getData(e)}},{key:"handleResultClicked",value:function(e){var n=this;new google.maps.places.PlacesService(document.createElement("div")).getDetails({placeId:e.place_id},function(e,t){t==google.maps.places.PlacesServiceStatus.OK&&(n.processPlace(e),n.props.onResultClicked&&n.props.onResultClicked(n.clickedAddress))})}},{key:"processPlace",value:function(e){for(var t=!1,n=e.address_components,r=0,a=n.length;r<a;r++){var s=n[r];"street_number"===s.types[0]&&(t=!0),this.processAddressComponent(s)}t||this.processUnknownStreetNumber(),this.processCoordinates(e)}},{key:"processAddressComponent",value:function(e){var t=e.types[0];if(this.processCountryCode(e),r[t]){var n=e[r[t]];this.assignAddressValue(t,n)}}},{key:"processUnknownStreetNumber",value:function(){if(r.street_number){var e=this.state.inputData.match(/^\d*/)[0];this.assignAddressValue("street_number",e)}}},{key:"processCountryCode",value:function(e){if("country"===e.types[0]&&this.props.getCountryCode){var t=e.short_name;this.assignAddressValue("country_code",t)}}},{key:"processCoordinates",value:function(e){if(e.geometry&&e.geometry.location&&this.props.getCoordinates){var t=e.geometry.location;this.assignAddressValue("latitude",t.lat()),this.assignAddressValue("longitude",t.lng())}}},{key:"assignAddressValue",value:function(e,t){var n,r=this.props.mappings;r[e]?(n=document.getElementById(r[e]))&&(n.value=t):(n=document.getElementById(e))&&(n.value=t);this.clickedAddress[e]=t}},{key:"render",value:function(){var t=this,e={handleInputChanged:this.handleInputChanged,handleResultClicked:this.handleResultClicked};return React.createElement(n,_extends({ref:function(e){return t.component=e}},this.props,this.state,{fns:e}))}}]),t}(React.Component);return i.propTypes=e,i.defaultProps=t,i.displayName="Google"+s,i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function autocompleteHOC(n){var e={onInputChanged:React.PropTypes.func.isRequired,placeholder:React.PropTypes.string,autoFocus:React.PropTypes.bool,results:React.PropTypes.array.isRequired,resultRow:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]).isRequired,additionalRow:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]),emptyRow:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]),resultClicked:React.PropTypes.func.isRequired,resultEntered:React.PropTypes.func,labelFunc:React.PropTypes.func,className:React.PropTypes.string,inputClass:React.PropTypes.string,selectOnBlur:React.PropTypes.bool,initialValue:React.PropTypes.string,hasError:React.PropTypes.bool,errorMsg:React.PropTypes.string},r=38,a=40,s=13,i=27,t=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.hideResult=this.hideResult.bind(this),this.handleOnBlur=this.handleOnBlur.bind(this),this.handleEnter=this.handleEnter.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleSelectOnBlur=this.handleSelectOnBlur.bind(this),this.bindKeyboard=this.bindKeyboard.bind(this),this.setPointer=this.setPointer.bind(this),this.increasePointer=this.increasePointer.bind(this),this.decreasePointer=this.decreasePointer.bind(this),this.registerRowRefs=this.registerRowRefs.bind(this),this.showResult=this.showResult.bind(this),this.toggleResult=this.toggleResult.bind(this),this.scrollToRow=this.scrollToRow.bind(this),this.setSelected=this.setSelected.bind(this),this.processLabel=this.processLabel.bind(this),this.reset=this.reset.bind(this),this.rowRefs=[],this.state={showResult:!1,dirty:!1,pointer:-1,selected:this.props.initialValue||""}}return _inherits(t,e),_createClass(t,[{key:"componentWillReceiveProps",value:function(e){this.resultDifferent(this.props.results,e.results)&&this.setPointer(-1)}},{key:"resultDifferent",value:function(e,t){if(e.length!==t.length)return!0;for(var n=0,r=e.length;n<r;n++)if(!this.objectsAreSame(e[n],t[n]))return!0;return!1}},{key:"objectsAreSame",value:function(e,t){var n=!0;for(var r in e)if(e.hasOwnProperty(r)&&t.hasOwnProperty(r)){if(e[r]!==t[r]){n=!1;break}}else n=!1;return n}},{key:"handleOnBlur",value:function(){this.props.onBlur&&this.props.onBlur(),this.props.selectOnBlur&&this.handleSelectOnBlur(),window.setTimeout(this.hideResult,100)}},{key:"handleEnter",value:function(){var e=this.state.pointer;if(-1<e){var t=this.props.results[e],n=this.processLabel({pointer:e});return this.setSelected(n),void(this.props.resultEntered?this.props.resultEntered(t):this.props.resultClicked(t))}if(e<0){t=this.props.results[0],n=this.processLabel({pointer:0});this.setSelected(n),this.props.resultEntered?this.props.resultEntered(t):this.props.resultClicked(t)}}},{key:"handleInputChange",value:function(e){var t=e.target.value,n={selected:t,showResult:!0};this.state.dirty||(n.dirty=!0),this.setState(n),this.props.onInputChanged&&this.props.onInputChanged(t)}},{key:"handleSelectOnBlur",value:function(){if(this.state.dirty){var e=this.props.results;if(0<e.length&&0<this.state.selected.trim().length){var t=undefined;t=this.state.pointer<0?0:this.state.pointer;var n=this.processLabel({pointer:t});this.setSelected(n),this.props.resultClicked(e[t])}}}},{key:"bindKeyboard",value:function(e){var t=this;e.onkeydown=function(e){switch(e.keyCode){case i:t.hideResult();break;case r:e.preventDefault(),t.decreasePointer(),t.scrollToRow();break;case a:e.preventDefault(),t.increasePointer(),t.scrollToRow();break;case s:e.preventDefault(),t.handleEnter(),t.hideResult()}}}},{key:"setPointer",value:function(e){this.setState({pointer:e})}},{key:"increasePointer",value:function(){if(0<this.props.results.length){if(this.state.pointer===this.props.results.length-1)return void this.setPointer(0);-1<=this.state.pointer&&this.setPointer(this.state.pointer+1)}}},{key:"decreasePointer",value:function(){if(0<this.props.results.length){if(this.state.pointer<=0)return void this.setPointer(this.props.results.length-1);0<this.state.pointer&&this.setPointer(this.state.pointer-1)}}},{key:"processLabel",value:function(e){var t=arguments.length<=0||e===undefined?{}:e,n=t.result,r=n===undefined?{}:n,a=t.pointer,s=a===undefined?0:a;if(this.props.labelFunc){if(r)return this.props.labelFunc(r);throw"Must pass an item object to process label with custom label function"}var i="result-row-"+s,o=ReactDOM.findDOMNode(this.rowRefs[i]);return $(o).text()}},{key:"setSelected",value:function(e){this.setState({selected:e})}},{key:"reset",value:function(){this.setState({showResult:!1,dirty:!1,pointer:-1,selected:this.props.initialValue||""})}},{key:"registerRowRefs",value:function(e){this.rowRefs=e}},{key:"hideResult",value:function(){this.setState({showResult:!1})}},{key:"showResult",value:function(){(this.state.dirty||0<this.props.results.length)&&this.setState({showResult:!0})}},{key:"toggleResult",value:function(){(this.state.dirty||0<this.props.results.length)&&this.setState({showResult:!this.state.showResult})}},{key:"scrollToRow",value:function(){var e="result-row-"+this.state.pointer,t=ReactDOM.findDOMNode(this.rowRefs[e]);t.parentNode.scrollTop=t.offsetTop}},{key:"render",value:function(){var e={hideResult:this.hideResult,handleOnBlur:this.handleOnBlur,handleEnter:this.handleEnter,handleInputChange:this.handleInputChange,handleSelectOnBlur:this.handleSelectOnBlur,bindKeyboard:this.bindKeyboard,setPointer:this.setPointer,increasePointer:this.increasePointer,decreasePointer:this.decreasePointer,registerRowRefs:this.registerRowRefs,showResult:this.showResult,toggleResult:this.toggleResult,scrollToRow:this.scrollToRow,setSelected:this.setSelected,processLabel:this.processLabel,reset:this.reset};return React.createElement(n,_extends({},this.props,{state:this.state,fns:e}))}}]),t}(React.Component);return t.displayName="Autocomplete"+n.name,t.propTypes=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function twilioHOC(n){var e={tokenPath:React.PropTypes.string.isRequired},t=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.getToken=this.getToken.bind(this),this.updateToken=this.updateToken.bind(this),this.initChatClient=this.initChatClient.bind(this),this.initAccessManager=this.initAccessManager.bind(this),this.serializeTwilioMessage=this.serializeTwilioMessage.bind(this),this.handleConnectionState=this.handleConnectionState.bind(this),this.state={chatClient:null}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){var t=this;this.getToken().then(function(e){return t.initChatClient(e)})}},{key:"getToken",value:function(){var r=this;return new Promise(function(t,n){var e=$.ajax({url:r.props.tokenPath,dataType:"JSON",type:"GET"});e.done(function(e){t(e.token)}),e.fail(function(e){alertify.alert("Could not authenticate!"),n(e)})})}},{key:"initChatClient",value:function(r){var a=this;return new Promise(function(t,n){Twilio.Chat.Client.create(r).then(function(e){a.setState({chatClient:e}),e.on("connectionStateChanged",a.handleConnectionState),a.initAccessManager(r),t(e)})["catch"](function(e){return n(e)})})}},{key:"initAccessManager",value:function(e){var t=this;this.accessManager=new Twilio.AccessManager(e),this.accessManager.on("tokenWillExpire",function(){t.getToken().then(function(e){return t.updateToken(e)})}),this.accessManager.on("tokenExpired",function(){t.getToken().then(function(e){return t.updateToken(e)})})}},{key:"updateToken",value:function(e){this.accessManager.updateToken(e),this.state.chatClient.updateToken(e)}},{key:"serializeTwilioMessage",value:function(e,t){t=t||"sent";try{return{author:e.author,body:e.body,attributes:e.attributes,channel:e.channel,dateUpdated:e.dateUpdated,lastUpdatedBy:e.lastUpdatedBy,index:e.index,sid:e.sid,timestamp:e.timestamp,status:t}}catch(n){console.log(e)}}},{key:"handleConnectionState",value:function(e){var t=this;"denied"===e&&this.getToken().then(function(e){return t.updateToken(e)})}},{key:"render",value:function(){if(this.state.chatClient){var e={serializeTwilioMessage:this.serializeTwilioMessage};return React.createElement(n,_extends({},this.props,{fns:e,chatClient:this.state.chatClient}))}return React.createElement("div",{className:"chat-channels"},React.createElement("div",{id:"loading-overlay"},React.createElement("div",{id:"loader"},React.createElement("i",{className:"fa fa-spinner fa-pulse fa-3x fa-fw"}))))}}]),t}(React.Component);return t.displayName="Twilio"+n.name,t.propTypes=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function CCFormPanelSidebar(){return React.createElement("div",{className:"job-panel-sidebar job-panel-sidebar-top"},React.createElement("p",null,React.createElement("strong",null,"Any questions about billing?"),React.createElement("br",null),"Reach out to us at any time. We're always available to answer your questions by chat, ",React.createElement("a",{href:"mailto:jerry@jiffyondemand.com"},"email")," or ",React.createElement("a",{href:"sms:647-490-1524"},"text message")))}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t)
;e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function withFormV2(t){var e={value:React.PropTypes.any,disabled:React.PropTypes.bool,validations:React.PropTypes.array,serializable:React.PropTypes.bool,inputRef:React.PropTypes.func},n={formV2:React.PropTypes.object.isRequired},r={validations:[],serializable:!0},a=function(e){function n(e){_classCallCheck(this,n),_get(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.setValue=this.setValue.bind(this),this.getValue=this.getValue.bind(this),this.hasValue=this.hasValue.bind(this),this.reset=this.reset.bind(this),this.validate=this.validate.bind(this),this.enable=this.enable.bind(this),this.disable=this.disable.bind(this),this.name=this.props.name,this.validations=[];var t=this.props.value||"";this.state={value:t,errors:[],isValid:!0,isPristine:!0,pristineValue:t,disabled:this.props.disabled}}return _inherits(n,e),_createClass(n,[{key:"componentWillMount",value:function(){this.detachFromForm=this.context.formV2.registerInput(this)}},{key:"componentWillUnmount",value:function(){this.detachFromForm()}},{key:"validate",value:function(){var r=this;if(this.props.validations.length<1)return!0;var e=this.props.validations.reduce(function(e,t){var n=Validators[t](r.state.value);return e.concat(n)},[]);return 0<e.length?(this.setState({errors:e,isValid:!1}),!1):(this.setState({errors:e,isValid:!0}),!0)}},{key:"getValue",value:function(){return this.state.value}},{key:"hasValue",value:function(){return this.state.value&&""!==this.state.value}},{key:"setErrors",value:function(e){this.setState({errors:e,isValid:!1,isPristine:!1})}},{key:"setValue",value:function(e){var t=this;this.setState({value:e,isPristine:!1},function(){t.validate()})}},{key:"disable",value:function(){this.setState({disabled:!0})}},{key:"enable",value:function(){this.setState({disabled:!1})}},{key:"reset",value:function(){this.setState({value:this.state.pristineValue,isPristine:!0,isValid:!0,errors:[]})}},{key:"render",value:function(){return React.createElement(t,_extends({},this.props,{ref:this.props.inputComponentRef,value:this.state.value,setValue:this.setValue,hasError:!this.state.isValid,errors:this.state.errors,disabled:this.state.disabled}))}}]),n}(React.Component);return a.displayName="WithFormV2"+(t.displayName||t.name),a.propTypes=e,a.contextTypes=n,a.defaultProps=r,a}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function withMasking(n){var e={maskPattern:React.PropTypes.string},t=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleInputRef=this.handleInputRef.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.props.maskPattern&&$(this.inputElement).mask(this.props.maskPattern)}},{key:"componentWillReceiveProps",value:function(e){e.maskPattern||$(this.inputElement).unmask(),e.maskPattern!==this.props.maskPattern&&$(this.inputElement).mask(e.maskPattern)}},{key:"handleInputRef",value:function(e){this.inputElement=e,this.props.inputRef&&this.props.inputRef(e)}},{key:"render",value:function(){return React.createElement(n,_extends({},this.props,{inputRef:this.handleInputRef}))}}]),t}(React.Component);return t.propTypes=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function jobBillingUtilities(n){var e=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.calculateJobTotal=this.calculateJobTotal.bind(this),this.calculateQuotedJob=this.calculateQuotedJob.bind(this),this.calculateRegularJob=this.calculateRegularJob.bind(this)}return _inherits(t,e),_createClass(t,[{key:"calculateQuotedJob",value:function(e,t,n){var r=100*(Number(e.quoted_cost)||0),a=r,s=100*(Number(e.additional_cost)||0),i=0,o=0,l=0;return 0<s?(i=s*n,labourTax=a*t,a+=s):(a+=s,labourTax=a*t),l=a+(o=labourTax+i),{subtotal:(a/100).toFixed(2),unitTotal:(r/100).toFixed(2),total:(l/100).toFixed(2),labourTax:(labourTax/100).toFixed(2),partsTax:(i/100).toFixed(2),tax:(o/100).toFixed(2),smartDevicesCost:"0.00"}}},{key:"calculateRegularJob",value:function(e,t,n){var r=0,a=0,s=0,i=0,o=0,l=Number(e.units_billed)||0,c=100*(Number(e.additional_cost)||0),u=e.after_hours_billed,p=e.minimum_charge_cents,h=l*e.unit_price_cents,d=100*this.calculateSmartDevicesCost(this.props.smartDevices);return h<p&&(h=p),u&&(h*=1.5),c<0?(i=d*Number(n),s=(h+c)*Number(t)):(i=(c+d)*Number(n),s=h*Number(t)),r=h/100,h+=c,h+=d,d/=100,a=(h/=100)+(o=(s/=100)+(i/=100)),{subtotal:h.toFixed(2),unitTotal:r.toFixed(2),total:a.toFixed(2),labourTax:s.toFixed(2),partsTax:i.toFixed(2),tax:o.toFixed(2),smartDevicesCost:d.toFixed(2)}}},{key:"calculateJobTotal",value:function(e,t,n){return e.quoted_cost?this.calculateQuotedJob(e,t,n):this.calculateRegularJob(e,t,n)}},{key:"calculateSmartDevicesCost",value:function(e){return e?e.reduce(function(e,t){var n=t.device_prices[0];return isEmptyObject(n)?e+0:e+(n.price||0)},0):0}},{key:"render",value:function(){var e={calculateJobTotal:this.calculateJobTotal,calculateSmartDevicesCost:this.calculateSmartDevicesCost};return React.createElement(n,_extends({},this.props,{utils:e}))}}]),t}(React.Component);return e.displayName=n.name,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}
function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function jobTableHOC(n){var e={scope:React.PropTypes.string,columns:React.PropTypes.arrayOf(React.PropTypes.object).isRequired,defaultSort:React.PropTypes.object,searchPath:React.PropTypes.string,row:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]).isRequired,className:React.PropTypes.string,onChange:React.PropTypes.func,namespace:React.PropTypes.string,dataRoot:React.PropTypes.string.isRequired,filters:React.PropTypes.array,idle:React.PropTypes.bool},t={defaultSort:{accepted:{sortColumn:"eta",direction:"asc"},awaiting_payment:{sortColumn:"finished_at",direction:"desc"},completed:{sortColumn:"finished_at",direction:"desc"}}},r=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.getData=this.getData.bind(this),this.setInitialState=this.setInitialState.bind(this),this.handleSearch=this.handleSearch.bind(this),this.handlePageChanged=this.handlePageChanged.bind(this),this.handleSort=this.handleSort.bind(this),this.setActiveJob=this.setActiveJob.bind(this),this.unsetActiveJob=this.unsetActiveJob.bind(this),this.handleSetFilters=this.handleSetFilters.bind(this),this.handleClearFilters=this.handleClearFilters.bind(this),this.handleApplyFilters=this.handleApplyFilters.bind(this),this.activeRequest=null,this.setStateDebounced=$.debounce(this.setState,300),this.state={jobs:[],activeJobId:null,scope:this.props.scope,query:"",sort:"created_at",direction:"desc",alertDismissed:!0,currentFilters:{},metadata:{}},this.state=this.setInitialState(this.state)}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.getData(),setInterval(this.getData,15e3)}},{key:"getData",value:function(t){var n=this,e={scope:this.state.scope,query:this.state.query,sort:this.state.sort,direction:this.state.direction,page:this.state.metadata.current_page,filters:this.state.currentFilters};if(!this.props.idle){this.activeRequest&&this.activeRequest.abort();var r=$.ajax({url:this.props.searchPath,dataType:"json",method:"GET",data:e});(this.activeRequest=r).done(function(e){n.activeRequest=null,n.setState({jobs:e[n.props.dataRoot],metadata:e.meta},function(){n.props.onChange&&n.props.onChange(e)}),t&&t(e)}),r.fail(function(e){n.activeRequest=null,"abort"!==e.statusText&&n.state.alertDismissed&&(n.setState({alertDismissed:!1}),alertify.alert("Could not fetch jobs!",function(){n.setState({alertDismissed:!0})}))})}}},{key:"setInitialState",value:function(e){var t=this.props,n=t.scope,r=t.defaultSort,a=r[n];return a?(e.sort=a.sortColumn,e.direction=a.direction):r["default"]&&(e.sort=r["default"].sortColumn,e.direction=r["default"].direction),e}},{key:"handleSetFilters",value:function(e){var t=this;this.setState({currentFilters:Object.assign({},this.state.currentFilters,e),metadata:{current_page:1}},function(){t.getData()})}},{key:"handleApplyFilters",value:function(){var e=this;this.setState({metadata:{current_page:1}},function(){e.getData()})}},{key:"handleClearFilters",value:function(){var e=this;this.setState({currentFilters:{}},function(){e.getData()})}},{key:"handlePageChanged",value:function(e){var t=this;this.setState({metadata:{current_page:e},activeJobId:null},function(){return t.getData()})}},{key:"handleSearch",value:function(e){var t=this,n=e.trim();this.setState({query:n,sort:""===n?"":"_score",direction:""===n?"":"desc",metadata:{current_page:1}},function(){t.getData()})}},{key:"handleSort",value:function(e,t){var n=this;this.setState({sort:e,direction:t,paginate:{current_page:1}},function(){n.getData()})}},{key:"setActiveJob",value:function(e){this.setStateDebounced({activeJobId:e.id})}},{key:"unsetActiveJob",value:function(){this.setStateDebounced({activeJobId:null})}},{key:"render",value:function(){var e={handlePageChanged:this.handlePageChanged,handleSort:this.handleSort,setActiveJob:this.setActiveJob,unsetActiveJob:this.unsetActiveJob,handleSearch:this.handleSearch,handleSetFilters:this.handleSetFilters,handleClearFilters:this.handleClearFilters,handleApplyFilters:this.handleApplyFilters};return React.createElement(n,_extends({},this.props,this.state,e))}}]),t}(React.Component);return r.propTypes=e,r.defaultProps=t,r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}for(var days=[],i=1;i<=31;i++)days.push(i);var months=[{value:1,full_month:"January",short_month:"Jan"},{value:2,full_month:"February",short_month:"Feb"},{value:3,full_month:"March",short_month:"Mar"},{value:4,full_month:"April",short_month:"Apr"},{value:5,full_month:"May",short_month:"May"},{value:6,full_month:"June",short_month:"Jun"},{value:7,full_month:"July",short_month:"Jul"},{value:8,full_month:"August",short_month:"Aug"},{value:9,full_month:"September",short_month:"Sep"},{value:10,full_month:"October",short_month:"Oct"},{value:11,full_month:"November",short_month:"Nov"},{value:12,full_month:"December",short_month:"Dec"}],maxYear=(new Date).getFullYear(),years=[];for(i=0;i<=100;i++)years.push(maxYear-i);var regions=[{longName:"Canada",code:"CA",currency:"CAD",subregions:[{longName:"Ontario",code:"ON"}]},{longName:"United States",code:"US",currency:"USD",subregions:[{longName:"Massachusetts",code:"MA"},{longName:"Illinois",code:"IL"}]}],SIN_REGEXP=/^(\d{9})$/,SSN_REGEXP=/^(\d{4})$/,ZIP_CODE_REGEXP=/^\d{5}(?:[-\s]\d{4})?$/,POSTAL_CODE_REGEXP=/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/,USER_TRANSACTION_FORM_LABELS=["Bonus","Complaint","Removed"],_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},{coordinate:React.PropTypes.array,map:React.PropTypes.object.isRequired,popupHtml:React.PropTypes.func}),StandardMapMarker=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.drawMarker()}},{key:"componentWillUnmount",value:function(){this.props.map.removeLayer(this.marker)}},{key:"getMarker",value:function(){return this.marker}},{key:"drawMarker",value:function(){var e={icon:new L.Icon.Default},t=this.props.coordinate,n=L.latLng(t[0],t[1]);if(this.marker=L.marker(n,e).addTo(this.props.map),this.props.popupHtml){var r=this.props.popupHtml();this.marker=this.marker.bindPopup(r)}return this.marker}},{key:"render",value:function(){return React.createElement("div",{className:"map-marker"})}}]),t}(React.Component);StandardMapMarker.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var AddressAutocomplete=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.reset=this.reset.bind(this)}return _inherits(t,e),_createClass(t,[{key:"reset",value:function(){this.autocompleteInput.reset()}},{key:"render",value:function(){var t=this,e=React.createElement("span",null,React.createElement("i",null,"No results found")),n=React.createElement("img",{src:"https://maps.gstatic.com/mapfiles/api-3/images/powered-by-google-on-white3.png"});return React.createElement("div",{className:"form-group address-autocomplete-group"},
React.createElement(AutocompleteComponent,_extends({},this.props,{ref:function(e){return t.autocompleteInput=e},className:"address-autocomplete",onInputChanged:this.props.fns.handleInputChanged,placeholder:"e.g. 89 Roehampton Avenue",results:this.props.results,resultClicked:this.props.fns.handleResultClicked,resultRow:AddressResultRow,emptyRow:e,additionalRow:n,selectOnBlur:!0})))}}]),t}(React.Component);AddressAutocomplete=googleAutocompleteHOC(AddressAutocomplete,{street_number:"short_name",route:"long_name",locality:"long_name",sublocality_level_1:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},["geocode"]);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var AddressResultRow=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("span",null,this.props.item.description)}}]),t}(React.Component),AddressesForm=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleAddressSubmission=this.handleAddressSubmission.bind(this),this.reset=this.reset.bind(this)}return _inherits(t,e),_createClass(t,[{key:"reset",value:function(){this.autocompleteInput.reset()}},{key:"handleAddressSubmission",value:function(e){e.preventDefault(),this.props.handleSubmit()}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"address-panel"},React.createElement("div",{className:"form address-form"},React.createElement("div",{className:"form-horizontal-group"},React.createElement("div",{className:"horizontal-input-group inline"},React.createElement(AddressAutocomplete,{ref:function(e){return t.autocompleteInput=e},hasError:this.props.hasError,errorMsg:this.props.errorMsg,onResultClicked:this.props.handleClickedAddress,getCoordinates:!0}),React.createElement("div",{className:"form-group"},React.createElement("input",{type:"text",className:"form-control",placeholder:"Unit/Suite",onChange:this.props.handleUnitChanged})))),React.createElement("div",{className:"form-group"},React.createElement("a",{href:"#",className:"btn btn-success",onClick:this.handleAddressSubmission},"Save New Address"))))}}]),t}(React.Component)),ReactCSSTransitionGroup=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},React.addons.CSSTransitionGroup),AddressesListing=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleAddressSubmit=this.handleAddressSubmit.bind(this),this.updateAddress=this.updateAddress.bind(this),this.removeAddress=this.removeAddress.bind(this),this.handleRemoveAddress=this.handleRemoveAddress.bind(this),this.fetchAddresses=this.fetchAddresses.bind(this),this.pollAddresses=this.pollAddresses.bind(this),this.setAddressDefault=this.setAddressDefault.bind(this),this.handleSetAddressDefault=this.handleSetAddressDefault.bind(this),this.handleClickedAddress=this.handleClickedAddress.bind(this),this.handleUnitChanged=this.handleUnitChanged.bind(this),this.state={addresses:[],error:!1,errorMsg:null,address:{city:null,country:null,line1:null,line2:null,postal_code:null,latitude:null,longitude:null,subregion:null},formValid:!1,isFetching:!1}}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.fetchAddresses(),setInterval(this.pollAddresses,1e4)}},{key:"updateAddress",value:function(e){this.setState({addresses:this.state.addresses.concat([e])}),$(".address-form").find(":input").val(null),this.addressForm.reset()}},{key:"fetchAddresses",value:function(){var t=this;$.ajax({url:this.props.crudPaths.index,dataType:"json",type:"GET"}).done(function(e){t.setState({addresses:e,isFetching:!1})})}},{key:"setAddressDefault",value:function(t){var e=this.state.addresses;if(0<e.length){var n=e.map(function(e){return e["default"]&&(e["default"]=!1),e.id===t.id&&(e["default"]=!0),e});this.setState({addresses:n})}}},{key:"pollAddresses",value:function(){this.state.isFetching||(this.setState({isFetching:!0}),this.fetchAddresses())}},{key:"removeAddress",value:function(e){var n=this.state.addresses.map(function(e){return e.id}).indexOf(e.id),t=this.state.addresses.filter(function(e,t){return t!==n});this.setState({addresses:t})}},{key:"handleSetAddressDefault",value:function(e){var t=this;this.setState({isFetching:!0});var n=$.ajax({url:this.props.crudPaths.set_default+e.id+"/set_default",dataType:"json",type:"PATCH"});n.done(function(){t.setAddressDefault(e)}),n.fail(function(){alertify.alert("Couldn't save your address properly. Please contact Jiffy for support")}),this.setState({isFetching:!1})}},{key:"handleRemoveAddress",value:function(e){var t=this,n=$.ajax({url:this.props.crudPaths["delete"]+e.id,dataType:"json",data:{id:e.id},type:"DELETE"});n.done(function(){t.removeAddress(e)}),n.fail(function(){alertify.alert("Some error occurred!")})}},{key:"handleAddressSubmit",value:function(){var t=this;this.setState({error:!1,errorMsg:null});var e=$.ajax({url:this.props.crudPaths.create,dataType:"json",type:"POST",data:{address:this.state.address}});e.done(this.updateAddress),e.fail(function(e){t.setState({error:!0,errorMsg:e.responseJSON.errors.address_autocomplete[0]})})}},{key:"handleClickedAddress",value:function(e){this.setState({address:{city:e.locality,country:e.country,street_number:e.street_number,line1:e.route,postal_code:e.postal_code,latitude:e.latitude,longitude:e.longitude,subregion:e.administrative_area_level_1}})}},{key:"handleUnitChanged",value:function(e){var t=this.state.address;t.line2=e.target.value,this.setState({address:t})}},{key:"render",value:function(){var t=this,e=this.state.addresses.map(function(e){return React.createElement(AddressesShow,{address:e,onRemoveAddress:t.handleRemoveAddress,setDefault:t.handleSetAddressDefault,key:e.id})});return React.createElement("div",{className:"user-addresses"},React.createElement(ReactCSSTransitionGroup,{transitionName:"user-address",transitionEnterTimeout:2500,transitionLeaveTimeout:300,transitionAppearTimeout:500},React.createElement("div",{className:"panel"},React.createElement("table",{className:"table table-bordered"},React.createElement("tbody",null,e)))),React.createElement(AddressesForm,{ref:function(e){return t.addressForm=e},hasError:this.state.error,errorMsg:this.state.errorMsg,handleClickedAddress:this.handleClickedAddress,handleUnitChanged:this.handleUnitChanged,handleSubmit:this.handleAddressSubmit}))}}]),t}(React.Component),AddressesShow=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.removeAddress=this.removeAddress.bind(this),this.setAddressDefault=this.setAddressDefault.bind(this)}return _inherits(t,e),_createClass(t,[{key:"removeAddress",value:function(e){e.preventDefault(),this.props.onRemoveAddress(this.props.address)}},{key:"setAddressDefault",value:function(e){e.preventDefault(),this.props.setDefault(this.props.address)}},{key:"renderSetDefault",value:function(){return this.props.address["default"]?React.createElement("span",{className:"text-muted"}," Default "):React.createElement("a",{className:"red-hover text-primary",onClick:this.setAddressDefault},"Set As Default")}},{key:"render",value:function(){return React.createElement("tr",{className:"address-row"},React.createElement("td",{className:"vertical-center"},this.props.address.full_line),React.createElement("td",{className:"text-left small vertical-center"},this.renderSetDefault()),React.createElement("td",{className:"text-left small vertical-center"},React.createElement("a",{className:"red-hover text-danger",onClick:this.removeAddress},React.createElement("i",{className:"fa fa-remove"}))))}}]),t}(React.Component)),CityAutocomplete=(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){var e=React.createElement("span",null,React.createElement("i",null,"No results found")),t=React.createElement("img",{src:"https://maps.gstatic.com/mapfiles/api-3/images/powered-by-google-on-white3.png"});return React.createElement("div",{className:"form-group"},React.createElement(AutocompleteComponent,_extends({},this.props,{className:"address-autocomplete",onInputChanged:this.props.fns.handleInputChanged,placeholder:"e.g. Toronto",results:this.props.results,resultClicked:this.props.fns.handleResultClicked,resultRow:AddressResultRow,emptyRow:e,additionalRow:t,selectOnBlur:!0})))}}]),t}(React.Component));CityAutocomplete=googleAutocompleteHOC(CityAutocomplete,{locality:"long_name",country:"short_name"},["(cities)"]);_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var AutocompleteComponent=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderResultVisibility=this.renderResultVisibility.bind(this),this.renderClass=this.renderClass.bind(this),this.renderErrorMessage=this.renderErrorMessage.bind(this)}return _inherits(t,e),_createClass(t,[{key:"renderResultVisibility",value:function(){return this.props.state.showResult?"results show":"results hidden"}},{key:"renderClass",value:function(){var e="autocomplete-form";return this.props.className&&(e+=" "+this.props.className),this.props.hasError&&(e+=" has-error"),e}},{key:"renderErrorMessage",value:function(){return this.props.hasError?React.createElement("span",{className:"help-block"},this.props.errorMsg):null}},{key:"render",value:function(){return React.createElement("div",{className:this.renderClass()},React.createElement(AutocompleteInput,{autofocus:this.props.autofocus,placeholder:this.props.placeholder||"Search...",inputClass:this.props.inputClass,bindKeyboard:this.props.fns.bindKeyboard,handleOnBlur:this.props.fns.handleOnBlur,handleOnClick:this.props.fns.showResult,selected:this.props.state.selected,handleOnChange:this.props.fns.handleInputChange,id:"location"}),this.renderErrorMessage(),React.createElement("div",{className:this.renderResultVisibility()},React.createElement(AutocompleteResult,{setPointer:this.props.fns.setPointer,pointer:this.props.state.pointer,registerRowRefs:this.props.fns.registerRowRefs,selected:this.props.state.selected,setSelected:this.props.fns.setSelected,processLabel:this.props.fns.processLabel,resultRow:this.props.resultRow,resultClicked:this.props.resultClicked,results:this.props.results,emptyRow:this.props.emptyRow,additionalRow:this.props.additionalRow})))}}]),t}(React.Component);AutocompleteComponent=autocompleteHOC(AutocompleteComponent);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={handleOnChange:React.PropTypes.func.isRequired,bindKeyboard:React.PropTypes.func.isRequired,handleOnClick:React.PropTypes.func,handleOnFocus:React.PropTypes.func,handleOnBlur:React.PropTypes.func,selected:React.PropTypes.string,placeholder:React.PropTypes.string,autoFocus:React.PropTypes.bool,inputClass:React.PropTypes.string};var defaultProps={autoFocus:!1,selected:"",placeholder:"Search...",inputClass:"form-control"},AutocompleteInput=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.blur=this.blur.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.props.bindKeyboard(this.inputField)}},{key:"blur",value:function(){this.inputField.blur()}},{key:"render",value:function(){var t=this;return React.createElement("input",{ref:function(e){return t.inputField=e},id:this.props.id||"core-autocomplete-input",autoFocus:this.props.autoFocus,className:this.props.inputClass,name:"search-box",type:"text",autoComplete:"off",onChange:this.props.handleOnChange,value:this.props.selected,onBlur:this.props.handleOnBlur,placeholder:this.props.placeholder,onClick:this.props.handleOnClick,onFocus:this.props.handleOnFocus})}}]),t}(React.Component);AutocompleteInput.propTypes=propTypes,AutocompleteInput.defaultProps=defaultProps;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={results:React.PropTypes.array,resultRow:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]),resultClicked:React.PropTypes.func,selected:React.PropTypes.string,additionalRow:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]),setSelected:React.PropTypes.func,processLabel:React.PropTypes.func,emptyRow:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object])},defaultProps={results:[],selected:""};var AutocompleteResult=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderRows=this.renderRows.bind(this),this.renderActiveClass=this.renderActiveClass.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentDidUpdate",value:function(){this.props.registerRowRefs(this.refs)}},{key:"handleMouseDown",value:function(e,t){var n=this.props.processLabel({pointer:t});this.props.setPointer(t),this.props.setSelected(n),this.props.resultClicked(e)}},{key:"renderActiveClass",value:function(e,t){return e===this.props.selected||t===this.props.pointer?"result-row active":"result-row"}},{key:"renderRows",value:function(){var n=this,r=this.props.resultRow,e=this.props.results.map(function(e,t){return React.createElement("li",{ref:"result-row-"+t,key:e.id,className:n.renderActiveClass(e,t),onMouseDown:function(){return n.handleMouseDown(e,t)},onTouchStart:function(){return n.handleMouseDown(e,t)}},React.createElement(r,{item:e}))});return 0===e.length&&(e=[React.createElement("li",{className:"result-additional-row",key:Date.now()+1},this.props.emptyRow)]),this.props.additionalRow&&e.push(React.createElement("li",{className:"result-additional-row",key:Date.now()+2},this.props.additionalRow)),e}},{key:"render",value:function(){return React.createElement("ul",{className:"result-list list-unstyled"},this.renderRows())}}]),t}(React.Component);AutocompleteResult.propTypes=propTypes,AutocompleteResult.defaultProps=defaultProps;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var ChatClient=function(){function e(){_classCallCheck(this,e),this.token=null,this.jwtAuthToken=null,this.currentUser=null,this.instance=null,this.tokenPath="",this.firebaseClient=FirebaseWrapper.getInstance(),this.getChannels=this.getChannels.bind(this),this.sendMessage=this.sendMessage.bind(this)}return _createClass(e,[{key:"configureFirebase",value:function(e){this.markAsReadUrl="https://us-central1-"+e.projectId+".cloudfunctions.net/markAsRead/",this.firebaseClient.config(e)}},{key:"getToken",value:function(){var t=this,e=$.ajax({url:this.tokenPath,type:"GET",dataType:"JSON",headers:{Authorization:"Token "+this.jwtAuthToken,"API-VERSION":"1.0"}});return e.then(function(e){t.token=e.token}),e.fail(function(){alertify.alert("Could not connect to server! Please try again.")}),e}},{key:"signInWithToken",value:function(e){var t=this.firebaseClient.auth().signInWithCustomToken(e);return t.then(function(){}),t["catch"](function(e){var t=e.code;e.message;"auth/invalid-custom-token"===t?alertify.alert("The token you provided is not valid."):console.error(e)}),t}},{key:"signIn",value:function(){var r=this;return new Promise(function(t,n){var e=r.getToken();e.then(function(){r.firebaseClient.auth().setPersistence(r.firebaseClient.persistence().SESSION).then(function(){var e=r.signInWithToken(r.token);e.then(function(e){r.currentUser=e,t(e)}),e["catch"](function(e){n(e)})})}),e.fail(function(e){n(e)})})}},{key:"getChannels",value:function(e){var o=this,l=arguments.length<=0||e===undefined?{}:e;return new Promise(function(t,n){var e=new Date(1970,0,1),r=["updatedAt."+o.currentUser.uid+" > "+e.toISOString()],a=["updatedAt."+o.currentUser.uid+" desc"],s=l.from,i=o.firebaseClient.list("channels",{filters:r,orders:a,startAfter:s,limit:25});i.then(function(e){var n=[];e.forEach(function(e){var t=_extends({id:e.id,docRef:e},e.data());n.push(ChatChannel.fromJSON(t))}),t(n)}),i["catch"](function(e){n(e)})})}},{key:"getChannelsWithMembers",value:function(a){var s=this;return new Promise(function(t,n){var e=a.map(function(e){return"members."+e+" == true"}),r=s.firebaseClient.list("channels",{filters:e});r.then(function(e){var n=[];e.forEach(function(e){var t=_extends({id:e.id,docRef:e},e.data());n.push(ChatChannel.fromJSON(t))}),t(n)}),r["catch"](function(e){n(e)})})}},{key:"getChannel",value:function(r){var a=this;return new Promise(function(n,t){var e=a.firebaseClient.get("channels/"+r);e.then(function(e){var t=_extends({id:e.id,docRef:e},e.data());n(ChatChannel.fromJSON(t))}),e["catch"](function(e){t(e)})})}},{key:"getMessages",value:function(r){var a=this;return new Promise(function(t,n){var e=a.firebaseClient.list("messages",{filters:["channelID == "+r],orders:["createdAt desc"]});e.then(function(e){var n=[];e.forEach(function(e){var t=_extends({id:e.id,docRef:e,metadata:e.metadata},e.data());n.push(ChatMessage.fromJSON(t))}),t(n)}),e["catch"](function(e){n(e)})})}},{key:"getLastMessage",value:function(n){var a=this;return new Promise(function(r,t){var e=a.firebaseClient.list("messages",{filters:["channelID == "+n],orders:["createdAt desc"],limit:1});e.then(function(e){var t=e.docs[0],n=_extends({id:t.id,docRef:t,metadata:t.metadata},t.data());r(ChatMessage.fromJSON(n))}),e["catch"](function(e){t(e)})})}},{key:"sendMessage",value:function(r){var a=this;return new Promise(function(t,n){var e=a.firebaseClient.create("messages",r);e.then(function(e){t(e.id)}),e["catch"](function(e){return n(e)})})}},{key:"markMessageAsRead",value:function(e){var s=this;return new Promise(function(n,r){var a=e.channelID;s.currentUser.getIdToken(!0).then(function(e){var t=$.ajax({url:s.markAsReadUrl,type:"POST",dataType:"JSON",headers:{Authorization:"Bearer "+e},data:{channelId:a}});t.then(n),t.fail(r)})})}},{key:"markAllAsRead",value:function(a){var s=this;return new Promise(function(n,r){s.currentUser.getIdToken(!0).then(function(e){var t=$.ajax({url:s.markAsReadUrl,type:"POST",dataType:"JSON",headers:{Authorization:"Bearer "+e},data:{channelId:a,all:!0}});t.done(n),t.fail(r)})})}},{key:"messagePageUp",value:function(r,a){var s=this;return new Promise(function(t,n){var e=s.firebaseClient.list("messages",{filters:["channelID == "+r],orders:["createdAt desc"],startAfter:a,limit:ChatConstants.PAGE_LIMIT});e.then(function(e){var n=[];e.forEach(function(e){var t=_extends({id:e.id,metadata:e.metadata,docRef:e},e.data());n.push(ChatMessage.fromJSON(t))}),t(n)}),e["catch"](function(e){return n(e)})})}},{key:"subscribeToActivities",value:function(e,t){return Subscription.subscribeToActivities(this.currentUser.uid),PubSub.subscribe(e,t)}},{key:"leaveChannel",value:function(r){var e=this;return new Promise(function(t,n){e.firebaseClient.auth().currentUser.getIdToken(!0).then(function(e){$.ajax({method:"POST",url:"https://us-central1-chat-63a45.cloudfunctions.net/leaveChannel/",headers:{Authorization:"Bearer "+e},data:{channelID:r}}).done(function(){t(!0)}).fail(function(e){n(e)})})["catch"](function(e){n(e)})})}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}(),ChatPresence=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),function(){function e(){_classCallCheck(this,e),this.broadcastInterval=36e5,this.firebaseClient=FirebaseWrapper.getInstance(),this.chatClient=ChatClient.getInstance()}return _createClass(e,[{key:"broadcast",value:function(){var e=this;return this.setStatus(),setInterval(function(){e.setStatus()},this.broadcastInterval)}},{key:"setStatus",value:function(){var e=this.chatClient.currentUser.uid,t=this.firebaseClient.fieldValue().serverTimestamp();this.firebaseClient.doc("/"+ChatConstants.STATUS_COLLECTION+"/"+e).set({state:"online",lastSeenAt:t})}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}()),ChatTypingIndicator=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),function(){function e(){_classCallCheck(this,e),this.updateInterval=5e3,this.debounceTimeout=2e3,this.firebaseClient=FirebaseWrapper.getInstance(),this.chatClient=ChatClient.getInstance()}return _createClass(e,[{key:"startDebounce",value:function(e){var t=this;return $.debounce(function(){t.start.apply(t,[e])},this.debounceTimeout,!0)}},{key:"stopDebounce",value:function(e){var t=this;return $.debounce(function(){t.stop.apply(t,[e])},this.debounceTimeout,!1)}},{key:"setTypingVal",value:function(e){var t=this.chatClient.currentUser.uid,n=this.firebaseClient.fieldValue().serverTimestamp();this.firebaseClient.doc("/"+ChatConstants.TYPINGS_COLLECTION+"/"+t).set({channelID:e,memberID:this.chatClient.currentUser.uid,lastTypedAt:n})}},{key:"start",value:function(e){var t=this;this.setTypingVal(e),this.timestampUpdater=setInterval(function(){t.setTypingVal(e)},this.updateInterval)}},{key:"stop",value:function(){clearInterval(this.timestampUpdater)}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}()),FirebaseWrapper=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"config",value:function(e){firebase.initializeApp(e)}},{key:"persistence",value:function(){return firebase.auth.Auth.Persistence}},{key:"fieldValue",value:function(){return firebase.firestore.FieldValue}},{key:"serverValue",value:function(){return firebase.database.ServerValue}},{key:"auth",value:function(){return firebase.auth()}},{key:"database",value:function(){return firebase.firestore()}},{key:"realtimeDb",value:function(){return firebase.database()}},{key:"batch",value:function(){return this.database().batch()}},{key:"doc",value:function(e){return this.database().doc(e)}},{key:"transaction",value:function(e){return firebase.firestore().runTransaction(e)}},{key:"subscribeToDoc",value:function(e,t){var n=arguments.length<=1||t===undefined?{}:t,r=this.database().doc(e),a=n.success,s=n.error;return r.onSnapshot(a,s)}},{key:"subscribeToCollection",value:function(e,t){var n=arguments.length<=1||t===undefined?{}:t,r=this.collectionRefBuilder(e,n),a=n.success,s=n.error;return r.onSnapshot(a,s)}},{key:"list",value:function(e,t){var n=arguments.length<=1||t===undefined?{}:t,r=this.collectionRefBuilder(e,n);return new Promise(function(t,n){r.get().then(function(e){t(e)})["catch"](function(e){n(e)})})}},{key:"get",value:function(e){var r=this.database().doc(e);return new Promise(function(t,n){r.get().then(function(e){e.exists?t(e):n(null)})["catch"](function(e){n(e)})})}},{key:"create",value:function(a,s){var i=this;return new Promise(function(t,n){var e=Object.assign({},s,{createdAt:i.fieldValue().serverTimestamp(),updatedAt:i.fieldValue().serverTimestamp()}),r=i.database().collection(a).add(e);r.then(function(e){return t(e)}),r["catch"](function(e){return n(e)})})}},{key:"update",value:function(r,a){var s=this;return new Promise(function(e,t){var n=s.database().doc(r).set(Object.assign({},a,{updatedAt:s.fieldValue().serverTimestamp()}),{merge:!0});n.then(function(){return e(!0)}),n["catch"](function(e){return t(e)})})}},{key:"collectionRefBuilder",value:function(e,t){var n=arguments.length<=1||t===undefined?{}:t,r=this.database().collection(e);return n.filters&&(r=this.collectionRefFilter(r,n.filters)),n.orders&&(r=this.collectionRefOrder(r,n.orders)),n.startAfter&&(r=r.startAfter(n.startAfter)),n.limit&&(r=r.limit(n.limit)),r}},{key:"collectionRefOrder",value:function(e,t){if(!Array.isArray(t))throw new TypeError("orders must be an array");if(0<t.length){var n=(r=e,t.forEach(function(e){var t,n=e.split(" ");r=(t=r).orderBy.apply(t,_toConsumableArray(n))}),{v:r});if("object"==typeof n)return n.v}var r}},{key:"collectionRefFilter",value:function(e,t){var a,s=this;if(!Array.isArray(t))throw new TypeError("filters must be an array");if(0<t.length){var n=(a=e,t.forEach(function(e){var t,n=e.split(" "),r=n[2];n[2]=s.parseStringValueType(r),a=(t=a).where.apply(t,_toConsumableArray(n))}),{v:a});if("object"==typeof n)return n.v}}},{key:"parseStringValueType",value:function(e){var t=undefined;try{t=null!==ChatConstants.ISO8601_REGEX.exec(e)?new Date(e):JSON.parse(e)}catch(n){t=e}return t}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}()),ChatConstants={BATCH_INTERVAL:5e3,PAGE_LIMIT:25,MESSAGE_COLLECTION:"messages",CHANNEL_COLLECTION:"channels",ACTIVITIES_COLLECTION:"activities",STATUS_COLLECTION:"statuses",TYPINGS_COLLECTION:"typing_indicators",MARK_AS_READ_URL:"https://us-central1-chat-63a45.cloudfunctions.net/markAsRead/",CHANNEL_EVENT_PREFIX:"channel",ISO8601_REGEX:/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,EVENTS:{MESSAGE_LOADED:"messageLoaded",MESSAGE_ADDED:"messageAdded",MESSAGE_CHANGED:"messageChanged",MESSAGE_REMOVED:"messageRemoved",CHANNEL_ADDED:"channelAdded",CHANNEL_CHANGED:"channelChanged",ACTIVITY_CHANGED:"activityChanged",TYPING:"typing",PRESENCE_CHANGED:"statusChanged"}},ChatChannel=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),function(){function a(e){_classCallCheck(this,a),this.chatClient=ChatClient.getInstance(),this.docRef=null,this.id=e,this.lastMessage={},this.readIndex={},this.unreadCount={},this.messagesCount=null,this.createdAt=null,this.updatedAt=null,this.members=[],this.messages=[],this.subscribed=!1}return _createClass(a,[{key:"subscribe",value:function(){this.id&&(this.unsubscriptions=[Subscription.subscribeToMessagesOfChannel(this.id),Subscription.subscribeToChannel(this.id),Subscription.subscribeToTypings(this.id)],this.subscribed=!0)}},{key:"unsubscribe",value:function(){this.unsubscriptions.forEach(function(e){e()}),this.subscribed=!1}},{key:"on",value:function(e,t){var n=ChatConstants.CHANNEL_EVENT_PREFIX+"."+this.id+"."+e;return PubSub.subscribe(n,t)}},{key:"sendMessage",value:function(e){
var t=new ChatMessage;return t.body=e,t.channelID=this.id,t.authorID=this.chatClient.currentUser.uid,this.chatClient.sendMessage(t.serializeForCreate())}},{key:"getMessages",value:function(){var r=this;return new Promise(function(t,n){var e=r.chatClient.getMessages(r.id);e.then(function(e){r.messages=e.reverse(),t(e)}),e["catch"](function(e){alertify.alert("Could not fetch messages"),console.log(e),n(e)})})}},{key:"getLastMessage",value:function(){var r=this;return new Promise(function(t,n){var e=r.chatClient.getLastMessage(r.id);e.then(function(e){return t(e)}),e["catch"](function(e){return n(e)})})}},{key:"markAllAsRead",value:function(){var r=this;return new Promise(function(n,t){if(!isEmptyObject(r.lastMessage)){var e=r.chatClient.markAllAsRead(r.id);return e.then(function(e){var t=r.chatClient.currentUser.uid;r.unreadCount[t]=0,n(e)}),void e["catch"](function(e){return t(e)})}0===r.messages.length&&isEmptyObject(r.lastMessage)?t("No messages in channel"):t()})}},{key:"incrementUnreadCount",value:function(){var e=this.chatClient.currentUser.uid;this.unreadCount[e]=this.unreadCount[e]+1}},{key:"serializeForCreate",value:function(){var e=this.serialize();return delete e.id,e}},{key:"serialize",value:function(){return{id:this.id,lastMessage:this.lastMessage,readIndex:this.readIndex,messagesCount:this.messagesCount,members:this.serializeMembers(),messages:this.messages}}},{key:"serializeMembers",value:function(){var t={};return this.members.forEach(function(e){t[e]=!0}),t}}],[{key:"fromJSON",value:function(e){var t=new a(e.id),n=[];for(var r in t.docRef=e.docRef,t.messagesCount=e.messagesCount,t.createdAt=e.createdAt,t.updatedAt=e.updatedAt,t.lastMessage=e.lastMessage,t.readIndex=e.readIndex,t.unreadCount=e.unreadCount,e.members)n.push(r);return t.members=n,t}}]),a}()),ChatMessage=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),function(){function n(e){_classCallCheck(this,n),this.chatClient=ChatClient.getInstance(),this.id=e,this.docRef=null,this.body="",this.metadata=null,this.channelID=null,this.authorID=null,this.createdAt=null,this.updatedAt=null}return _createClass(n,[{key:"markAsRead",value:function(){return this.chatClient.markMessageAsRead(this)}},{key:"markAsReadDebounced",value:function(){var e=this;return $.debounce(function(){e.markAsRead.apply(e)},2e3)()}},{key:"serializeForCreate",value:function(){var e=this.serialize();return delete e.id,e}},{key:"serialize",value:function(){return{id:this.id,body:this.body,channelID:this.channelID,authorID:this.authorID}}}],[{key:"fromJSON",value:function(e){var t=new n(e.id);return t.docRef=e.docRef,t.metadata=e.metadata,t.body=e.body,t.channelID=e.channelID,t.authorID=e.authorID,t.createdAt=e.createdAt,t.updatedAt=e.updatedAt,t}}]),n}());!function(e){"use strict";var t={};(function(c){"use strict";var u={},r=-1;function a(e){var t;for(t in e){if(e.hasOwnProperty(t)){return true}}return false}function s(t){return function e(){throw t}}function o(e,t,n){try{e(t,n)}catch(r){setTimeout(s(r),0)}}function l(e,t,n){e(t,n)}function i(e,t,n,r){var a=u[t],s=r?l:o,i;if(!u.hasOwnProperty(t)){return}for(i in a){if(a.hasOwnProperty(i)){s(a[i],e,n)}}}function p(r,a,s){return function e(){var t=String(r),n=t.lastIndexOf(".");i(r,r,a,s);while(n!==-1){t=t.substr(0,n);n=t.lastIndexOf(".");i(r,t,a,s)}}}function h(e){var t=String(e),n=Boolean(u.hasOwnProperty(t)&&a(u[t])),r=t.lastIndexOf(".");while(!n&&r!==-1){t=t.substr(0,r);r=t.lastIndexOf(".");n=Boolean(u.hasOwnProperty(t)&&a(u[t]))}return n}function n(e,t,n,r){var a=p(e,t,r),s=h(e);if(!s){return false}if(n===true){a()}else{setTimeout(a,0)}return true}c.publish=function(e,t){return n(e,t,false,c.immediateExceptions)};c.publishSync=function(e,t){return n(e,t,true,c.immediateExceptions)};c.subscribe=function(e,t){if(typeof t!=="function"){return false}if(!u.hasOwnProperty(e)){u[e]={}}var n="uid_"+String(++r);u[e][n]=t;return n};c.clearAllSubscriptions=function e(){u={}};c.clearSubscriptions=function e(t){var n;for(n in u){if(u.hasOwnProperty(n)&&n.indexOf(t)===0){delete u[n]}}};c.unsubscribe=function(e){var t=function(e){var t;for(t in u){if(u.hasOwnProperty(t)&&t.indexOf(e)===0){return true}}return false},n=typeof e==="string"&&(u.hasOwnProperty(e)||t(e)),r=!n&&typeof e==="string",a=typeof e==="function",s=false,i,o,l;if(n){c.clearSubscriptions(e);return}for(i in u){if(u.hasOwnProperty(i)){o=u[i];if(r&&o[e]){delete o[e];s=e;break}if(a){for(l in o){if(o.hasOwnProperty(l)&&o[l]===e){delete o[l];s=true}}}}}return s}})(e.PubSub=t),"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof exports&&(module!==undefined&&module.exports&&(exports=module.exports=t),exports.PubSub=t,module.exports=exports=t)}("object"==typeof window&&window||this);_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var Subscription=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"subscribeToActivities",value:function(e,t){var n=arguments.length<=1||t===undefined?{}:t;return FirebaseWrapper.getInstance().subscribeToCollection(ChatConstants.ACTIVITIES_COLLECTION,_extends({filters:["memberID == "+e],success:this.activitySuccessHandler,error:this.errorHandler},n))}},{key:"subscribeToChannel",value:function(e,t){var n=arguments.length<=1||t===undefined?{}:t;return FirebaseWrapper.getInstance().subscribeToDoc(ChatConstants.CHANNEL_COLLECTION+"/"+e,_extends({},n,{success:this.channelSuccessHandler,error:this.errorHandler}))}},{key:"subscribeToMessages",value:function(e){var t=this,n=arguments.length<=0||e===undefined?{}:e,r=FirebaseWrapper.getInstance(),a=n.eventPrefix;return r.subscribeToCollection(ChatConstants.MESSAGE_COLLECTION,_extends({},n,{success:function(e){return t.messagesSuccessHandler(e,a)},error:this.errorHandler,limit:ChatConstants.PAGE_LIMIT}))}},{key:"subscribeToMessagesOfChannel",value:function(e,t){var n=arguments.length<=1||t===undefined?{}:t;if(!e)throw new SyntaxError("Must specify a channel ID");return this.subscribeToMessages(_extends({},n,{filters:["channelID == "+e],orders:["createdAt desc"],eventPrefix:ChatConstants.CHANNEL_EVENT_PREFIX+"."+e}))}},{key:"subscribeToTypings",value:function(e){var t=this;if(!e)throw new SyntaxError("Must specify a channel ID");var n=FirebaseWrapper.getInstance(),r=ChatConstants.CHANNEL_EVENT_PREFIX+"."+e;return n.subscribeToCollection(ChatConstants.TYPINGS_COLLECTION,{filters:["channelID == "+e],success:function(e){return t.typingSuccessHandler(e,r)},error:this.errorHandler})}},{key:"subscribeToUserStatus",value:function(e){return FirebaseWrapper.getInstance().subscribeToDoc(ChatConstants.STATUS_COLLECTION+"/"+e,{success:this.userStatusHandler,error:this.errorHandler})}},{key:"errorHandler",value:function(e){console.error(e)}},{key:"messagesSuccessHandler",value:function(e,r){var a=e.ot.syncStateChanged,s=this.cleanUpMessagePayload(e);Object.keys(s).forEach(function(e){var t=r?r+".":"",n=s[e];switch(e){case"added":t+=a?ChatConstants.EVENTS.MESSAGE_LOADED:ChatConstants.EVENTS.MESSAGE_ADDED;break;case"modified":t+=ChatConstants.EVENTS.MESSAGE_CHANGED;break;case"removed":t+=ChatConstants.EVENTS.MESSAGE_REMOVED}PubSub.publish(t,n)})}},{key:"cleanUpMessagePayload",value:function(e){var a={};return e.docChanges.reverse().forEach(function(e){var t=_extends({id:e.doc.id,docRef:e.doc,metadata:e.doc.metadata},e.doc.data()),n=ChatMessage.fromJSON(t),r=a[e.type]||[];r.push(n),a[e.type]=r}),a}},{key:"channelSuccessHandler",value:function(e){var t=ChatConstants.CHANNEL_EVENT_PREFIX+"."+e.id+"."+ChatConstants.EVENTS.CHANNEL_CHANGED;if(e.exists){var n=_extends({id:e.id,docRef:e},e.data());PubSub.publish(t,n)}}},{key:"activitySuccessHandler",value:function(e){var n=ChatConstants.EVENTS.ACTIVITY_CHANGED;e.ot.syncStateChanged||e.docChanges.forEach(function(e){var t=_extends({id:e.doc.id},e.doc.data());PubSub.publish(n,t)})}},{key:"typingSuccessHandler",value:function(e,t){var n=t+"."+ChatConstants.EVENTS.TYPING;e.docChanges.forEach(function(e){var t=_extends({id:e.doc.id},e.doc.data());PubSub.publish(n,t)})}},{key:"userStatusHandler",value:function(e){if(e.exists){var t=e.id+"."+ChatConstants.EVENTS.PRESENCE_CHANGED,n=e.data(),r={id:e.id,state:n.state,lastSeenAt:n.lastSeenAt};PubSub.publish(t,r)}}}]),e}(),WriteQueue=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),function(){function e(){_classCallCheck(this,e),this.firebaseClient=FirebaseWrapper.getInstance(),this.execute=this.execute.bind(this),this.queue=[],this.timedOperation=setInterval(this.execute,ChatConstants.BATCH_INTERVAL)}return _createClass(e,[{key:"enqueue",value:function(e,t,n){var r={id:this.generateUID(),operationType:e,docPath:t,payload:n};return this.queue.push(r),r}},{key:"dequeue",value:function(t){var e=this.queue.findIndex(function(e){return e.id===t});return-1<e&&(this.queue.splice(e,1),!0)}},{key:"pop",value:function(){return this.queue.splice(0,1)}},{key:"execute",value:function(){for(var e=this.firebaseClient.batch();0<this.queue.length;){var t=this.pop(),n=this.firebaseClient.doc(t.docPath),r=t.payload;switch(t.operationType){case"update":e.set(n,r,{merge:!0});break;case"set":e.set(n,r);break;case"delete":e["delete"](n)}}var a=e.commit();return a.then(function(){console.log("committed batch")}),a["catch"](function(){console.error("batch transaction failed")}),a}},{key:"generateUID",value:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}()),Channel=(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currentUser:React.PropTypes.string,activeChannel:React.PropTypes.object,type:React.PropTypes.string,loading:React.PropTypes.bool,idle:React.PropTypes.bool,sendMessage:React.PropTypes.func.isRequired,retryMessage:React.PropTypes.func,disableInput:React.PropTypes.bool,loadMore:React.PropTypes.func,notifications:React.PropTypes.bool,startTyping:React.PropTypes.func,stopTyping:React.PropTypes.func,members:React.PropTypes.object,typings:React.PropTypes.object,leaveChannel:React.PropTypes.func},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.typingService=ChatTypingIndicator.getInstance(),this.handleLeaveChannel=this.handleLeaveChannel.bind(this),this.startTyping=this.startTyping.bind(this),this.stopTyping=this.stopTyping.bind(this),this.renderMessageForm=this.renderMessageForm.bind(this),this.renderNotificationWarning=this.renderNotificationWarning.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleLeaveChannel",value:function(e){var t=this;e&&e.preventDefault(),alertify.confirm("Are you sure you want to leave this channel?",function(){t.props.leaveChannel(t.props.activeChannel.id)},function(){})}},{key:"startTyping",value:function(){return this.typingService.startDebounce(this.props.activeChannel.id)}},{key:"stopTyping",value:function(){return this.typingService.stopDebounce(this.props.activeChannel.id)}},{key:"renderNotificationWarning",value:function(){if(!this.props.notifications)return React.createElement("div",{className:"notification-warning alert alert-warning"},"Your notifications are disabled. For the best experience, please enable notifications on your browser.")}},{key:"renderTypingMessage",value:function(){var e=this.props.activeChannel,t=this.props.typings[e.id],n=[];for(var r in t)if(t[r]&&r!==this.props.currentUser){var a=this.props.members[r];n.push(a.first_name+" "+a.last_name)}if(0<n.length)return 4<=n.length?n.slice(0,3).join(", ")+" and "+(n.length-3)+" are typing...":1<n.length?n.join(", ")+" are typing...":n[0]+" is typing..."}},{key:"renderMessageForm",value:function(){return this.props.disableInput?null:React.createElement(MessageForm,{sendMessage:this.props.sendMessage,typingMessage:this.renderTypingMessage(),startTyping:this.startTyping,stopTyping:this.stopTyping})}},{key:"contactCardMember",value:function(){var t=this,e=this.props.activeChannel,n=[];return e.members.forEach(function(e){e!==t.props.currentUser&&n.push(t.props.members[e])}),n}},{key:"render",value:function(){return React.createElement("div",{className:"chat-channel"},React.createElement(ContactCard,{members:this.contactCardMember(),leaveChannel:this.handleLeaveChannel}),React.createElement(ChannelMessages,this.props),this.renderMessageForm())}}]),t}(React.Component));Channel.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={activeChannel:React.PropTypes.object,currentUser:React.PropTypes.string,channels:React.PropTypes.object,members:React.PropTypes.object,retryMessage:React.PropTypes.func,loadMore:React.PropTypes.func.isRequired,type:React.PropTypes.string,sendMessage:React.PropTypes.func};var ChannelMessages=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.getAuthor=this.getAuthor.bind(this),this.scrollBottom=this.scrollBottom.bind(this),this.handleLoadMore=this.handleLoadMore.bind(this),this.renderMessages=this.renderMessages.bind(this),this.state={loadHistory:!1}}return _inherits(t,e),_createClass(t,[{key:"componentDidUpdate",value:function(e,t){if(!(t.loadHistory||!t.loadHistory&&this.state.loadHistory)){var n=this.msgContainer.scrollTop,r=this.msgContainer.scrollHeight-this.msgContainer.clientHeight;this.scrollAtBottom=r<=0||n===r,this.scrollAtBottom||this.scrollBottom()}}},{key:"handleLoadMore",value:function(e){var t=this;e.preventDefault(),this.setState({loadHistory:!0}),this.props.loadMore().then(function(){t.setState({loadHistory:!1})})}},{key:"getAuthor",value:function(e){return this.props.members[e]}},{key:"scrollBottom",value:function(){var e=this.msgContainer.scrollHeight-this.msgContainer.clientHeight;ReactDOM.findDOMNode(this.msgContainer).scrollTop=0<e?e:0}},{key:"renderLoadMoreLink",value:function(){var e=this.props.activeChannel.messages;return e.length<1?null:e.length<this.props.activeChannel.messagesCount?React.createElement("p",{className:"load-more text-center"},React.createElement("a",{href:"#",onClick:this.handleLoadMore},"Load Previous Messages")):null}},{key:"renderMessages",value:function(){var n=this,e=this.props.activeChannel.messages;if(!(0<e.length)){if("Professional"===this.props.type){var t=this.props.members[this.props.currentUser];return React.createElement(DefaultMessage,{sendMessage:this.props.sendMessage,author:t})}return React.createElement("div",{className:"message-container"},React.createElement("div",{className:"alert alert-danger"},"You have no messages from this person. Initiate a conversation by typing below!"))}var r,a=(r=null,{v:e.map(function(e){var t={author:n.getAuthor(e.authorID),authored:e.authorID!=r,owned:e.authorID===n.props.currentUser};return r=e.authorID,React.createElement(Message,_extends({key:"message-"+e.id,channelID:n.props.activeChannel.id,body:e.body},t,{retryMessage:n.props.retryMessage}))})});if("object"==typeof a)return a.v}},{key:"render",value:function(){var t=this;return React.createElement("div",{ref:function(e){return t.msgContainer=e},className:"messages"},this.renderLoadMoreLink(),this.renderMessages())}}]),t}(React.Component);ChannelMessages.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currentUser:React.PropTypes.string.isRequired,activeChannel:React.PropTypes.object,channels:React.PropTypes.object.isRequired,switchChannel:React.PropTypes.func.isRequired,channelOrder:React.PropTypes.array.isRequired,members:React.PropTypes.object.isRequired,leaveChannel:React.PropTypes.func,pageChannels:React.PropTypes.func,nextPage:React.PropTypes.bool};var ChannelSidebar=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleLoadMoreClicked=this.handleLoadMoreClicked.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleLoadMoreClicked",value:function(e){e.preventDefault(),this.props.pageChannels()}},{key:"renderChannels",value:function(){var n=this,e=this.props.channelOrder||[];return 0<e.length?e.map(function(e){var t=n.props.channels[e];return t||console.error("No channel matched"),React.createElement(ChannelSidebarItem,{key:e,currentUser:n.props.currentUser,switchChannel:n.props.switchChannel,members:n.props.members,activeChannel:n.props.activeChannel,channel:t})}):React.createElement("div",{className:"alert alert-info"},"You don't have any channels")}},{key:"renderLoadMoreLink",value:function(){return this.props.nextPage?React.createElement("a",{className:"load-more-channels",href:"",onClick:this.handleLoadMoreClicked},"Load More"):null}},{key:"render",value:function(){return React.createElement("div",{className:"chat-channels-list"},React.createElement("div",{className:"chat-channels-heading"},React.createElement("h1",null,"Chats")),React.createElement("ul",null,this.renderChannels()),this.renderLoadMoreLink())}}]),t}(React.Component);ChannelSidebar.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currentUser:React.PropTypes.string.isRequired,activeChannel:React.PropTypes.object,currentUser:React.PropTypes.string,members:React.PropTypes.object.isRequired,channel:React.PropTypes.object.isRequired,switchChannel:React.PropTypes.func.isRequired};var ChannelSidebarItem=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSwitchChannel=this.handleSwitchChannel.bind(this),this.state={channelParticipants:this.selectParticipant()}}return _inherits(t,e),_createClass(t,[{key:"singleParticipant",value:function(){return 1===this.state.channelParticipants.length}},{key:"selectParticipant",value:function(){var t=this,e=this.props.channel.members,n=[];return e.forEach(function(e){e!==t.props.currentUser&&n.push(t.props.members[e])}),n}},{key:"handleSwitchChannel",value:function(){this.props.switchChannel&&this.props.switchChannel(this.props.channel.id)}},{key:"renderUnreadCount",value:function(){var e=this.props,t=e.channel,n=e.currentUser;return!isEmptyObject(t)&&0<t.unreadCount[n]?React.createElement("span",{className:"label label-danger"},t.unreadCount[n]):null}},{key:"renderChannelClass",value:function(){var e=[],t=this.props,n=t.channel,r=t.activeChannel,a=t.currentUser;return isEmptyObject(r)||n.id===r.id&&e.push("selected"),0<n.unreadCount[a]&&e.push("has-unread"),e.join(" ")}},{key:"renderProfilePic",value:function(){var e=this.state.channelParticipants.map(function(e){return e.profile_picture_url});return React.createElement(ProfilePicture,{imageUrls:e.slice(0,3)})}},{key:"renderNames",value:function(){return this.state.channelParticipants.map(function(e){return e.first_name+" "+e.last_name}).join(", ")}},{key:"renderLastMessage",value:function(){if(!isEmptyObject(this.props.channel.lastMessage)){var e=this.props.channel.lastMessage.body;return 55<e.length?e.substr(0,52)+"...":e}return null}},{key:"render",value:function(){return React.createElement("li",{className:this.renderChannelClass(),onClick:this.handleSwitchChannel},React.createElement("div",{className:"contact-card-section"},React.createElement("div",{className:"heading-left"},this.renderProfilePic()),React.createElement("div",{className:"heading-main"},React.createElement("p",{className:"name"},this.renderNames()),React.createElement("p",{className:"subheading"},this.renderLastMessage())),this.renderUnreadCount()))}}]),t}(React.Component);ChannelSidebarItem.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={channels:React.PropTypes.array,user:React.PropTypes.object,tokenPath:React.PropTypes.string.isRequired,type:React.PropTypes.string.isRequired,channelPathBase:React.PropTypes.string,enableSidebar:React.PropTypes.bool,lockChannels:React.PropTypes.bool,disableInput:React.PropTypes.bool,size:React.PropTypes.string,sessionID:React.PropTypes.string,leaveOnExit:React.PropTypes.bool,autoSubscribe:React.PropTypes.bool},defaultProps={channels:[],enableSidebar:!0,channelsLocked:!1,autoSubscribe:!1};var Channels=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.setInitialState=this.setInitialState.bind(this),this.initialize=this.initialize.bind(this),this.fetchTwilioChannels=this.fetchTwilioChannels.bind(this),this.switchChannel=this.switchChannel.bind(this),this.handleMessageAdded=this.handleMessageAdded.bind(this),this.handleChannelAdded=this.handleChannelAdded.bind(this),this.appendMessage=this.appendMessage.bind(this),this.updateMsgConsumptionHorizon=this.updateMsgConsumptionHorizon.bind(this),this.markAllAsRead=this.markAllAsRead.bind(this),this.handleIdle=this.handleIdle.bind(this),this.handleActive=this.handleActive.bind(this),this.sendMessage=this.sendMessage.bind(this),this.updateMessage=this.updateMessage.bind(this),this.retryMessage=this.retryMessage.bind(this),this.pageUp=this.pageUp.bind(this),this.getCachedTwilioChannel=this.getCachedTwilioChannel.bind(this),this.setupUnsubscription=this.setupUnsubscription.bind(this),this.subscribeToChannel=this.subscribeToChannel.bind(this),this.trackEvent=this.trackEvent.bind(this),this.state=this.setInitialState()}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){var e=this;this.initialize(),this.requestNotificationPermission(),this.setupUnsubscription(),window.onbeforeunload=function(){return event.preventDefault(),e.trackEvent("closed"),null}}},{key:"componentWillUnmount",value:function(){this.props.chatClient.shutdown()}},{key:"setInitialState",value:function(){var t={},n=[];return this.props.channels.forEach(function(e){t[e.channel_sid]=e,n.push(e.channel_sid)}),{channels:t,channelOrder:n,activeChannel:null,loading:!0,idle:!1,notifications:!1}}},{key:"requestNotificationPermission",value:function(){var t=this;try{"granted"!=Notification.permission?Notification.requestPermission(function(e){"granted"!=e||t.setState({notifications:!0})}):this.setState({notifications:!0})}catch(e){console.log("Notifications not supported")}}},{key:"initialize",value:function(){var e=this;this.props.chatClient.on("messageAdded",this.handleMessageAdded),this.props.chatClient.on("channelAdded",this.handleChannelAdded),this.fetchTwilioChannels().then(function(){e.setState({loading:!1}),e.switchChannel(e.props.channels[0])})["catch"](function(){e.setState({loading:!1})})}},{key:"setupUnsubscription",value:function(){var t=this;this.props.leaveOnExit&&(window.onbeforeunload=function(e){e.preventDefault();$.ajax({url:t.props.unsubscribePath,dataType:"JSON",type:"GET"});return null})}},{key:"fetchChannel",value:function(e){var t=$.ajax({url:this.props.channelPathBase+"/"+e,dataType:"JSON",type:"GET"});return t.fail(function(){alertify.alert("Could not retrieve channel from our server!")}),t}},{key:"fetchTwilioChannels",value:function(){var r=this;return new Promise(function(t,n){if(0<r.props.channels.length){var e=r.props.chatClient.getUserChannelDescriptors();e.then(function(e){var s=r.state.channels;e.state.items.map(function(e){var t=e.descriptor,n=t.channel_sid,r={channel_sid:n,twilioChannel:null,messages:[],unreadCount:t.unread_messages_count};if(s.hasOwnProperty(n)){var a=s[n];a=_extends({},a,r),s[n]=a}}),r.setState({channels:s},function(){return t()})}),e["catch"](function(e){return n(e)})}else n()})}},{key:"fetchTwilioChannel",value:function(s){var i=this;return new Promise(function(t,n){var e=i.props.chatClient.getChannelBySid(s),r=null,a=e.then(function(e){var t=(r=e).getUnconsumedMessagesCount();return t["catch"](function(e){return n(e)}),t});e["catch"](function(e){50400===e.body.code?i.props.autoSubscribe&&i.handleChannelNotSubscribed(s,t,n):n(e)}),a.then(function(e){t({channel_sid:r.sid,twilioChannel:r,unreadCount:e})})})}},{key:"handleChannelNotSubscribed",value:function(e,t,n){var r=this,a=this.subscribeToChannel(e);a.then(function(){r.fetchTwilioChannel(e).then(function(e){return t(e)})["catch"](function(e){return n(e)})}),a["catch"](function(e){console.error(e),n(e)})}},{key:"subscribeToChannel",value:function(r){var a=this;return new Promise(function(t,n){var e=$.ajax({url:a.props.channelPathBase+"/"+r+"/subscribe",type:"POST",dataType:"JSON",data:{id:r}});e.then(function(e){t(e)}),e.fail(function(e){n(e)})})}},{key:"switchChannel",value:function(n){var r=this;this.trackEvent("closed"),this.setState({activeChannel:n,loading:!0},function(){r.trackEvent("opened");var e=n.channel_sid,t=r.getCachedChannel(e);r.shouldFetchMessages(t)?r.fetchChannelMessages(e).then(function(){r.markAllAsRead(),r.setState({loading:!1})})["catch"](function(e){console.log(e)}):(r.markAllAsRead(),r.setState({loading:!1}))})}},{key:"handleMessageAdded",value:function(e){var t=e.channel.sid,n=this.getCachedChannel(t);if(n){if(this.shouldFetchMessages(n))this.fetchChannelMessages(t);else{var r=this.findLocalMessageIndex(e);r<0?(this.appendMessage(e),sound=new Audio(this.props.sound),sound.volume=.3,sound.playbackRate=1.7,sound.play()):this.updateMessage(t,r,{index:e.index,status:"sent",sid:e.sid})}this.moveChannelTop(t)}this.state.idle||document.hidden||this.state.activeChannel.channel_sid!==t||this.updateMsgConsumptionHorizon(e.index)}},{key:"handleChannelAdded",value:function(r){var a=this,s=r.sid;if(this.props.channels.find(function(e){return e.channel_sid===s})||this.props.lockChannels)return!0;var e=[this.fetchChannel(s),r.getUnconsumedMessagesCount()];Promise.all(e).then(function(e){var t=e[0],n=e[1];t&&a.setState({channels:_extends({},a.state.channels,_defineProperty({},s,_extends({},t,{twilioChannel:r,messages:[],unreadCount:n}))),channelOrder:[].concat(_toConsumableArray(a.state.channelOrder),[s])})})}},{key:"updateMsgConsumptionHorizon",value:function(e){var t=this.state.activeChannel,n=this.state.channels[t.channel_sid].twilioChannel;n.lastConsumedMessageIndex<Number(e)&&n.updateLastConsumedMessageIndex(Number(e))["catch"](function(e){return console.log(e)})}},{key:"markAllAsRead",value:function(){var e=this.state.activeChannel,t=this.getCachedChannel(e.channel_sid),n=t.twilioChannel;0<t.unreadCount&&(n.setAllMessagesConsumed(),this.resetServerCache(e.id),this.setCachedChannelAttributes(e.channel_sid,{unreadCount:0}))}},{key:"appendMessage",value:function(e,t){var n=e.channel.sid,r=this.state.channels,a=this.props.fns.serializeTwilioMessage(e,t);if(r[n]){var s=r[n].messages.push(a);return this.state.activeChannel.channel_sid!==n&&(r[n].unreadCount+=1,time=Math.floor(Date.now()/6e4),tag=n+"-"+time,notification=new Notification("New message from Jiffy",{body:e.body,tag:tag})),this.setState({channels:r}),s-1}}},{key:"fetchChannelMessages",value:function(a){var s=this;return new Promise(function(r,t){var e=s.getCachedChannel(a).twilioChannel,n=function(n){n.getMessages(25).then(function(e){var t=e.items.map(function(e){return s.props.fns.serializeTwilioMessage(e)});n.getUnconsumedMessagesCount().then(function(e){s.setCachedChannelAttributes(a,{messages:t,unreadCount:e},function(){r()})})})["catch"](function(e){return t(e)})};return e?n(e):s.fetchTwilioChannel(a).then(function(e){s.setCachedChannelAttributes(e.channel_sid,e,function(){return n(e.twilioChannel)})})["catch"](function(e){console.log(e)})})}},{key:"shouldFetchMessages",value:function(e){return e?e.messages===undefined||e.messages.length<1:(console.error("Channel not passed in shouldFetchMessages"),!1)}},{key:"setCachedChannelAttributes",value:function(e,t,n){t===undefined&&(t={});var r=this.getCachedChannel(e);this.setState({channels:_extends({},this.state.channels,_defineProperty({},e,_extends({},r,t)))},n)}},{key:"handleIdle",value:function(){this.setState({idle:!0})}},{key:"handleActive",value:function(){this.setState({idle:!1}),this.markAllAsRead()}},{key:"findLocalMessageIndex",value:function(e){var t=e.channel.sid,n=e.attributes.web_client_message_id,r=this.getCachedChannel(t);return r?r.messages.findIndex(function(e){return e.attributes.web_client_message_id===n}):-1}},{key:"sendMessage",value:function(e){var t=this,n=this.getCachedTwilioChannel(this.state.activeChannel.channel_sid),r=new Date,a=this.props.sessionID+"-"+r.getTime(),s={author:this.props.user.uid,
attributes:{web_client_message_id:a},body:e,channel:n,timestamp:r,status:"sending"},i=this.appendMessage(s),o=n.sendMessage(e,{web_client_message_id:a});o["catch"](function(){t.updateMessage(n.sid,i,{status:"failed"})})}},{key:"updateMessage",value:function(e,t,n){var r=arguments.length<=2||n===undefined?{}:n,a=this.getCachedChannel(e).messages,s=a[t],i=_extends({},s,r);a[t]=i,this.setCachedChannelAttributes(e,{messages:a})}},{key:"retryMessage",value:function(e,t){var n=this,r=this.getCachedChannel(e),a="",s=r.messages.findIndex(function(e){if(e.attributes.web_client_message_id===t)return a=e.body,!0});r.messages.splice(s,1),this.setCachedChannelAttributes(e,{messages:r.messages},function(){return n.sendMessage(a)})}},{key:"pageUp",value:function(s){var i=this;this.setState({loading:!0});var o=this.state.activeChannel.channel_sid,l=this.getCachedChannel(o),e=l.twilioChannel,t=l.messages[0]?l.messages[0].index-1:null,c=25;if(t<=0)return this.setState({loading:!1}),!1;e.getMessages(c,t).then(function(e){for(var t=c-1,n=0;n<=t;t--){var r=e.items[t];if(r){var a=i.props.fns.serializeTwilioMessage(r);l.messages.unshift(a)}}i.setCachedChannelAttributes(o,{messages:l.messages},function(){i.setState({loading:!1}),s&&s()})})}},{key:"moveChannelTop",value:function(e){var t=this.state.channelOrder,n=t.indexOf(e),r=t.splice(n,1)[0];t.unshift(r),this.setState({channelOrder:t})}},{key:"getCachedTwilioChannel",value:function(e){return this.getCachedChannel(e).twilioChannel}},{key:"getCachedChannel",value:function(e){return this.state.channels[e]}},{key:"trackEvent",value:function(e){if(this.state.activeChannel&&"User"==this.props.type){var t=this.state.activeChannel.channel_sid;$.ajax({url:this.props.channelPathBase+"/"+t+"/track_event",datatype:"JSON",data:{event_name:e},type:"POST"}).fail(function(){console.error("Could not send analytics request for "+event+" event")})}}},{key:"resetServerCache",value:function(e){$.ajax({url:this.props.channelPathBase+"/"+e+"/invalidate_cache",datatype:"JSON",type:"POST"}).fail(function(){console.error("Could not invalidate cache")})}},{key:"renderChannel",value:function(){var t=this;if(this.state.activeChannel){var e=this.state.activeChannel,n=this.getCachedChannel(e.channel_sid),r=null;return n&&(r=n.messages),React.createElement(Channel,{ref:function(e){return t.channelComponent=e},channel:e,user:this.props.user,tokenPath:this.props.tokenPath,type:this.props.type,messages:r,loading:this.state.loading,retryMessage:this.retryMessage,sendMessage:this.sendMessage,notifications:this.state.notifications,disableInput:this.props.disableInput,pageUp:this.pageUp})}}},{key:"renderSidebar",value:function(){return this.props.enableSidebar?React.createElement(ChannelSidebar,{channels:this.state.channels,channelOrder:this.state.channelOrder,switchChannel:this.switchChannel,activeChannel:this.state.activeChannel}):null}},{key:"renderChannelsClass",value:function(){return this.props.size?"chat-channels chat-channels-"+this.props.size:"chat-channels"}},{key:"renderLoadingClass",value:function(){return this.state.loading?"":"hidden"}},{key:"render",value:function(){return React.createElement("div",{className:this.renderChannelsClass()},React.createElement(IdleTimer,{idleTime:3e5,onIdle:this.handleIdle,onActive:this.handleActive}),this.renderSidebar(),React.createElement("div",{id:"loading-overlay",className:this.renderLoadingClass()},React.createElement("div",{id:"loader"},React.createElement("i",{className:"fa fa-spinner fa-pulse fa-3x fa-fw"}))),this.renderChannel())}}]),t}(React.Component);Channels.propTypes=propTypes,Channels.defaultProps=defaultProps,Channels=twilioHOC(Channels);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={members:React.PropTypes.array,leaveChannel:React.PropTypes.func},defaultProps={members:[]};var ContactCard=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.deltaTime=36e5,this.setStateDebounced=$.debounce(this.setState,500),this.handleUserStatusChanged=this.handleUserStatusChanged.bind(this),this.subscribeToMemberStatus=this.subscribeToMemberStatus.bind(this),this.checkStatus=this.checkStatus.bind(this),this.state={lastSeenAt:null,memberStatus:"offline"}}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.singleParticipant()&&(this.subscribeToMemberStatus(this.props.members[0].uid),setInterval(this.checkStatus,this.deltaTime))}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.members,n=e.members,r=t[0],a=e.members[0];r.uid!==a.uid&&(this.resetSubscription(),1===n.length&&this.subscribeToMemberStatus(a.uid))}},{key:"subscribeToMemberStatus",value:function(e){var t=e+"."+ChatConstants.EVENTS.PRESENCE_CHANGED;this.memberStatusUnsubcribe=Subscription.subscribeToUserStatus(e),PubSub.subscribe(t,this.handleUserStatusChanged)}},{key:"handleUserStatusChanged",value:function(e,t){this.setStateDebounced({id:t.id,lastSeenAt:t.lastSeenAt,memberStatus:t.state})}},{key:"resetSubscription",value:function(){this.memberStatusUnsubcribe(),this.setState({id:null,lastSeenAt:null,memberStatus:"offline"})}},{key:"checkStatus",value:function(){var e=new Date,t=this.state,n=t.lastSeenAt;"online"===t.memberStatus&&(!n||e.getTime()-n.getTime()<this.deltaTime)&&this.setState({lastSeenAt:null,memberStatus:"offline"})}},{key:"renderRatingStars",value:function(){if(this.singleParticipant()){var e=this.props.members[0];if(e.average_rating)return React.createElement("div",{className:"heading-right hidden-xs"},React.createElement(Stars,{rating:e.average_rating,size:"sm"}))}return null}},{key:"renderNames",value:function(){if(this.props.members.length<1)return null;var t=[];return this.props.members.forEach(function(e){t.push(e.first_name+" "+e.last_name)}),React.createElement("p",{className:"name"},t.join(", "))}},{key:"renderProfilePicture",value:function(){if(this.singleParticipant()){var e=this.props.members[0];return React.createElement("img",{src:e.profile_picture_url,className:"chat-profile-picture visible"})}return null}},{key:"renderLeaveChannel",value:function(){return React.createElement("a",{className:"label label-danger leave-channel-link",onClick:this.props.leaveChannel},"Leave \xa0",React.createElement("i",{className:"fa fa-sign-out"}))}},{key:"renderContactHeading",value:function(){var e="contact-card-section";return 1<this.props.members.length&&(e+=" shadow-bottom"),React.createElement("div",{className:e},React.createElement("div",{className:"heading-left"},this.renderProfilePicture(),this.renderPresenceIndicator()),React.createElement("div",{className:"heading-main"},this.renderNames()),this.renderRatingStars())}},{key:"renderPresenceIndicator",value:function(){if(this.singleParticipant()){var e=this.props.members[0],t=this.state.id,n=this.state.memberStatus,r=this.state.lastSeenAt;if("online"===n&&e.uid===t)if((new Date).getTime()-r.getTime()<this.deltaTime)return React.createElement("span",{className:"presence-indicator"},React.createElement("i",{className:"fa fa-circle"}))}return null}},{key:"renderContactInfo",value:function(){if(this.singleParticipant()){var e=this.props.members[0];return React.createElement("div",{className:"contact-info-container"},React.createElement("a",{href:"mailto: "+e.email},React.createElement("i",{className:"fa fa-envelope"}),React.createElement("span",{className:"hidden-xs"},e.email)),React.createElement("a",{href:"tel: "+e.phone_number},React.createElement("i",{className:"fa fa-phone"}),React.createElement("span",{className:"hidden-xs"},e.phone_number)))}return null}},{key:"singleParticipant",value:function(){return 1===this.props.members.length}},{key:"render",value:function(){return React.createElement("div",{className:"contact-card"},this.renderContactHeading(),this.renderContactInfo())}}]),t}(React.Component);ContactCard.propTypes=propTypes,ContactCard.defaultProps=defaultProps;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={sendMessage:React.PropTypes.func.isRequired};var DefaultMessage=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSendMessage=this.handleSendMessage.bind(this),this.state={defaultMessage:"Hi, this is "+this.props.author.first_name+" your Jiffy pro.\n        Let me know if there's any more job details you want to go over before our appointment."}}return _inherits(t,e),_createClass(t,[{key:"handleSendMessage",value:function(){var e=this.state.defaultMessage;this.props.sendMessage(e)}},{key:"render",value:function(){return React.createElement("div",{className:"message-container authored owned"},React.createElement("img",{src:this.props.author.profile_picture_url,className:"chat-profile-picture"}),React.createElement("div",{className:"message"},React.createElement("small",{className:"pre-default-message text-danger"},"You have not contacted the customer yet. We've prepared a sample message for you. Press the button to send this message, or type in your own."),React.createElement("p",{className:"default-message"},this.state.defaultMessage),React.createElement("a",{className:"button",onClick:this.handleSendMessage},"Send Message")))}}]),t}(React.Component);DefaultMessage.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currentUser:React.PropTypes.string,activeChannel:React.PropTypes.object,channels:React.PropTypes.object,members:React.PropTypes.object,channelOrder:React.PropTypes.array,firebase:React.PropTypes.object,disableInput:React.PropTypes.bool,size:React.PropTypes.string,disableSidebar:React.PropTypes.bool,disableInput:React.PropTypes.bool,loading:React.PropTypes.bool,typings:React.PropTypes.object};var FirebaseChannels=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderChannelsClass",value:function(){return this.props.size?"chat-channels chat-channels-"+this.props.size:"chat-channels"}},{key:"renderChannel",value:function(){if(!isEmptyObject(this.props.activeChannel))return React.createElement(Channel,{currentUser:this.props.currentUser,activeChannel:this.props.activeChannel,channels:this.props.channels,members:this.props.members,loadMore:this.props.firebase.loadMore,sendMessage:this.props.firebase.sendMessage,disableInput:this.props.disableInput,typings:this.props.typings,leaveChannel:this.props.firebase.leaveChannel,type:this.props.type})}},{key:"renderLoader",value:function(){if(this.props.loading)return React.createElement("div",{id:"loading-overlay"},React.createElement("div",{id:"loader"},React.createElement("i",{className:"fa fa-spinner fa-pulse fa-3x fa-fw"})))}},{key:"renderChannelSidebar",value:function(){return this.props.disableSidebar?null:React.createElement(ChannelSidebar,{currentUser:this.props.currentUser,channels:this.props.channels,switchChannel:this.props.firebase.switchChannel,activeChannel:this.props.activeChannel,channelOrder:this.props.channelOrder,members:this.props.members,pageChannels:this.props.firebase.pageChannels,nextPage:this.props.nextPage})}},{key:"renderIdleTimer",value:function(){return this.props.disableIdleTimer?null:React.createElement(IdleTimer,{idleTime:3e5,onIdle:this.props.firebase.handleIdle,onActive:this.props.firebase.handleActive})}},{key:"render",value:function(){return React.createElement("div",{className:this.renderChannelsClass()},this.renderLoader(),this.renderIdleTimer(),this.renderChannelSidebar(),this.renderChannel())}}]),t}(React.Component);FirebaseChannels.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={tokenPath:React.PropTypes.string.isRequired,membersPath:React.PropTypes.string.isRequired,disableInput:React.PropTypes.bool,sound:React.PropTypes.string,channelPathBase:React.PropTypes.string,jwt:React.PropTypes.string,onlyParticipants:React.PropTypes.array,lockToParticipants:React.PropTypes.bool,disableSidebar:React.PropTypes.bool,firebaseConfig:React.PropTypes.object.isRequired};var FirebaseContainer=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.chatClient=ChatClient.getInstance(),this.chatClient.tokenPath=this.props.tokenPath,this.chatClient.jwtAuthToken=this.props.jwt,this.chatClient.configureFirebase(this.props.firebaseConfig),this.presenceService=ChatPresence.getInstance(),this.typingIndicatorService=ChatTypingIndicator.getInstance(),this.getChannels=this.getChannels.bind(this),this.getUserChannels=this.getUserChannels.bind(this),this.getChannelsWithMembers=this.getChannelsWithMembers.bind(this),this.subscribeToActivities=this.subscribeToActivities.bind(this),this.switchChannel=this.switchChannel.bind(this),this.updateChannel=this.updateChannel.bind(this),this.getMembersInfo=this.getMembersInfo.bind(this),this.addMessageToChannel=this.addMessageToChannel.bind(this),this.pageChannels=this.pageChannels.bind(this),this.handlePageChannels=this.handlePageChannels.bind(this),this.handleChannelResponse=this.handleChannelResponse.bind(this),this.handleMessageLoaded=this.handleMessageLoaded.bind(this),this.handleMessageAdded=this.handleMessageAdded.bind(this),this.handleActivityChanged=this.handleActivityChanged.bind(this),this.handleTyping=this.handleTyping.bind(this),this.defaultToFirstChannel=this.defaultToFirstChannel.bind(this),this.loadMore=this.loadMore.bind(this),this.sendMessage=this.sendMessage.bind(this),this.addMessageToChannel=this.addMessageToChannel.bind(this),this.trackPresence=this.trackPresence.bind(this),this.requestNotificationPermission=this.requestNotificationPermission.bind(this),this.trackEvent=this.trackEvent.bind(this),this.leaveChannel=this.leaveChannel.bind(this),this.removeLocalChannel=this.removeLocalChannel.bind(this),this.setStateDebounced=$.debounce(this.setState,500),this.handleUrlParams=this.handleUrlParams.bind(this),this.state={activeChannel:{},idle:!1,loading:!0,channels:{},channelOrder:[],members:{},notifications:!1,typings:{},channelsPagingMetadata:{},disableSidebar:this.props.disableSidebar,onlyParticipants:this.props.onlyParticipants||[],lockToParticipants:this.props.lockToParticipants}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){var e=this,t=this.chatClient.signIn();this.handleUrlParams(),t.then(this.getChannels).then(this.subscribeToActivities).then(function(){return e.setState({loading:!1})}).then(this.requestNotificationPermission).then(this.defaultToFirstChannel).then(this.trackPresence),window.onbeforeunload=function(){return event.preventDefault(),e.trackEvent("closed"),null}}},{key:"getLocalChannel",value:function(e){return this.state.activeChannel.id===e?this.state.activeChannel:this.state.channels[e]}},{key:"trackPresence",value:function(){this.presenceService.broadcast()}},{key:"requestNotificationPermission",value:function(){var t=this;try{"granted"!=Notification.permission?Notification.requestPermission(function(e){"granted"!=e||t.setState({notifications:!0})}):this.setState({notifications:!0})}catch(e){console.log("Notifications not supported")}}},{key:"defaultToFirstChannel",value:function(){this.state.lockToParticipants&&this.switchChannel(this.state.channelOrder[0])}},{key:"switchChannel",value:function(e){var t=this,n=this.getLocalChannel(e),r={activeChannel:n};if(this.state.activeChannel.id!==e){this.trackEvent("closed");var a=isEmptyObject(this.state.activeChannel)?n:this.state.activeChannel,s=_extends({},this.state.channels,_defineProperty({},a.id,a));r.channels=s,this.setState(r,function(){t.subscribeToChannelEvents(e),t.markAllMessagesAsRead(n),t.trackEvent("opened")})}}},{key:"updateChannel",value:function(e){var t={};e.id===this.state.activeChannel.id?t.activeChannel=e:t.channels=_extends({},this.state.channels,_defineProperty({},e.id,e)),this.setState(t)}},{key:"playNotificationSound",value:function(){sound=new Audio(this.props.sound),sound.volume=.3,sound.playbackRate=1.7,sound.play()}},{key:"subscribeToActivities",value:function(){var e=this.chatClient.subscribeToActivities("activityChanged",this.handleActivityChanged);return Promise.resolve(e)}},{key:"subscribeToChannelEvents",value:function(e){var t=this.getLocalChannel(e);t.subscribed||(t.on("messageAdded",this.handleMessageAdded),t.on("messageLoaded",this.handleMessageLoaded),t.on("typing",this.handleTyping),t.subscribe())}},{key:"getChannels",value:function(){return this.state.lockToParticipants?this.getChannelsWithMembers(this.state.onlyParticipants):this.getUserChannels()}},{key:"getChannelsWithMembers",value:function(e){var i=this;return new Promise(function(n,r){var a=[],s=[].concat(_toConsumableArray(e),[i.chatClient.currentUser.uid]);e.forEach(function(e){var t=[e,i.chatClient.currentUser.uid];a.push(i.chatClient.getChannelsWithMembers(t))}),Promise.all(a).then(function(e){var t=[].concat.apply([],e);i.handleChannelResponse(t),i.getMembersInfo(s).then(function(){n()}).fail(function(e){console.log(e),r()})})["catch"](function(e){console.log(e),r()})})}},{key:"getUserChannels",value:function(){var r=this;return new Promise(function(e,t){var n=r.chatClient.getChannels();n.then(r.handleChannelResponse).then(r.getMembersInfo).then(function(){return e()}),n["catch"](function(e){console.log(e),t()})})}},{key:"getMembersInfoForChannel",value:function(t){var n=this;return Promise(function(e){n.getMembersInfo(t.members).then(function(){return e(t)})})}},{key:"getMembersInfo",value:function(e){var t=this,n=$.ajax({url:this.props.membersPath,type:"GET",dataType:"JSON",headers:{Authorization:"Token "+this.props.jwt,"API-VERSION":"1.0"},data:{uids:e}});return n.then(function(e){t.setState({members:_extends({},t.state.members,t.transformMembersArray(e.chat_members))})}),n.fail(function(e){console.error(e)}),n}},{key:"getChannel",value:function(r){var a=this;return new Promise(function(t,n){var e=a.chatClient.getChannel(r);e.then(function(e){return t(e)}),e["catch"](function(e){return n(e)})})}},{key:"addChannel",value:function(e){var t=[].concat(_toConsumableArray(this.state.channelOrder),[e.id]),n=_extends({},this.state.channels,_defineProperty({},e.id,e));this.setState({channelOrder:t,channels:n})}},{key:"moveChannelUp",value:function(e){var t=this.state.channelOrder,n=t.indexOf(e);-1<n&&t.splice(n,1),t.unshift(e),this.setState({channelOrder:t})}},{key:"incrementChannelUnreadCount",value:function(e){e.incrementUnreadCount(),this.updateChannel(e)}},{key:"leaveChannel",value:function(e){var t=this,n=this.getLocalChannel(e);return n.subscribed&&n.unsubscribe(),this.chatClient.leaveChannel(e).then(function(){alertify.logPosition("top right"),alertify.log("Successfully left channel"),t.removeLocalChannel(e)})}},{key:"removeLocalChannel",value:function(t){var e=this.state,n=e.channels,r=e.typings,a=e.channelOrder;delete n[t],delete r[t];var s=a.filter(function(e){return e!==t}),i=a.indexOf(t);this.state.activeChannel.id===t&&(i===a.length-1?i-=1:i+=1),this.setState({channels:n,typings:r,channelOrder:s}),-1<i?this.switchChannel(a[i]):this.setState({activeChannel:{}})}},{key:"markAllMessagesAsRead",value:function(e){var t=this;e.markAllAsRead().then(function(){return t.updateChannel(e)})["catch"](function(){})}},{key:"addMessageToChannel",value:function(e,t){var n=this.getLocalChannel(e),r=n.messages||[],a=[];a=Array.isArray(t)?[].concat(_toConsumableArray(r),_toConsumableArray(t)):[].concat(_toConsumableArray(r),[t]),n.messages=a,this.updateChannel(n)}},{key:"updateChannelLastMessage",value:function(e){var t=this.getLocalChannel(e.channelID);t.lastMessage=e.serialize(),messagesCount=t.messagesCount||0,t.messagesCount=messagesCount+1,this.updateChannel(t)}},{key:"browserNotify",value:function(e){var t=Math.floor(Date.now()/6e4),n=e.channelID+"-"+t;if(e&&e.body)return new Notification("New message from Jiffy",{body:e.body,tag:n})}},{key:"pageChannels",value:function(){var r=this,a=this.state.channelsPagingMetadata.lastChannel;return new Promise(function(e,t){var n=r.chatClient.getChannels({from:a.docRef});n.then(r.handlePageChannels).then(e),n["catch"](function(e){console.log(e),t()})})}},{key:"handlePageChannels",value:function(i){var o=this;return i.length<1?(this.setState({channelsPagingMetadata:_extends({},this.state.channelsPagingMetadata,{nextPage:!1})}),Promise.resolve(!0)):new Promise(function(e,t){var n=_extends({},o.state.channels),r=[].concat(_toConsumableArray(o.state.channelOrder)),a=[];(i=o.filterChannelByMember(i)).forEach(function(e){n[e.id]=e,a=[].concat(_toConsumableArray(a),_toConsumableArray(e.members)),r.push(e.id)});var s=o.getMembersInfo(a);s.then(function(){o.setState({channels:n,channelOrder:r,channelsPagingMetadata:{lastChannel:i[i.length-1],nextPage:!0}},e)}),s.fail(function(e){console.error(e),t()})})}},{key:"handleActivityChanged",value:function(e,t){var n=this,r=t.channelID,a=this.getLocalChannel(r);if(a){if(a.id===this.state.activeChannel.id)return;if(a.subscribed)return;this.getChannel(r).then(function(e){n.updateChannel(e),n.subscribeToChannelEvents(e.id),n.moveChannelUp(e.id),n.playNotificationSound(),n.browserNotify(e.lastMessage)})}else{if(this.state.lockToParticipants)return;this.getChannel(r).then(this.getMembersInfoForChannel).then(this.addChannel).then(function(e){n.subscribeToChannelEvents(e.id),n.moveChannelUp(e.id),n.playNotificationSound(),n.browserNotify(a.lastMessage)})}}},{key:"handleChannelResponse",value:function(a){var s=this;return new Promise(function(e){var t=_extends({},s.state.channels),n=[].concat(_toConsumableArray(s.state.channelOrder)),r=[];(a=s.filterChannelByMember(a)).forEach(function(e){t[e.id]=e,r=[].concat(_toConsumableArray(r),_toConsumableArray(e.members)),n.push(e.id)}),s.setState({channels:t,channelOrder:n,channelsPagingMetadata:{lastChannel:a[a.length-1],nextPage:!0}},function(){return e(r)})})}},{key:"handleMessageLoaded",value:function(e,t){var n=this.getLocalChannel(t[0].channelID);n&&this.addMessageToChannel(n.id,t)}},{key:"handleMessageAdded",value:function(e,t){var n=this;0<t.length&&t.forEach(function(e){e.authorID===n.chatClient.currentUser.uid?n.handleMessageSent(e):n.handleMessageReceived(e),n.updateChannelLastMessage(e)})}},{key:"handleMessageReceived",value:function(e){if(e.channelID===this.state.activeChannel.id)this.state.idle?(this.playNotificationSound(),this.browserNotify(e),this.incrementChannelUnreadCount(this.state.activeChannel)):e.markAsReadDebounced();else{var t=this.getLocalChannel(e.channelID);this.playNotificationSound(),this.browserNotify(e),this.incrementChannelUnreadCount(t)}this.addMessageToChannel(e.channelID,e),this.moveChannelUp(e.channelID)}},{key:"handleMessageSent",value:function(e){this.addMessageToChannel(this.state.activeChannel.id,e),e.markAsReadDebounced()}},{key:"handleTyping",value:function(e,t){var n=this,r=t.channelID,a=t.memberID,s=t.lastTypedAt,i=new Date,o=5e3,l=!!s&&i.getTime()-s.getTime()<o;if(this.typingClearTimeout&&clearTimeout(this.typingClearTimeout),this.typingClearTimeout=setTimeout(function(){n.resetTyping(a,r)},6e3),isEmptyObject(this.state.typings[r])){var c=_extends({},this.state.typings,_defineProperty({},r,_defineProperty({},a,l)));this.setStateDebounced({typings:c})}else{var u=this.state.typings[r],p=_extends({},u,_defineProperty({},a,l));this.setStateDebounced({typings:_extends({},this.state.typings,_defineProperty({},r,p))})}}},{key:"resetTyping",value:function(e,t){var n=this.state.typings[t],r=_extends({},n,_defineProperty({},e,!1));this.setState({typings:_extends({},this.state.typings,_defineProperty({},t,r))})}},{key:"filterChannelByMember",value:function(e){var n=this;return this.state.lockToParticipants?e.filter(function(e){return e.members.reduce(function(e,t){return e||n.state.onlyParticipants.includes(t)},!1)}):e}},{key:"trackEvent",value:function(e){if(!isEmptyObject(this.state.activeChannel)&&"User"==this.props.type){var t=this.state.activeChannel.id;$.ajax({url:this.props.channelPathBase+"/"+t+"/track_event",datatype:"JSON",data:{event_name:e},type:"POST"}).fail(function(){console.error("Could not send analytics request for "+e+" event")})}}},{key:"loadMore",value:function(){var a=this;return new Promise(function(t,n){var r=a.state.activeChannel;if(0<r.messages.length&&r.messages.length<r.messagesCount){var e=a.chatClient.messagePageUp(r.id,r.messages[0].docRef);e.then(function(e){r.messages=[].concat(_toConsumableArray(e.reverse()),_toConsumableArray(r.messages)),a.setState({activeChannel:r},function(){return t(!0)})}),e["catch"](function(e){console.error(e),n(!1)})}else n(!1)})}},{key:"sendMessage",value:function(e){var t=this.state.activeChannel;if(t){var n=t.sendMessage(e);return n["catch"](function(e){return console.log(e)}),n}}},{key:"handleIdle",value:function(){this.setState({idle:!0})}},{key:"handleActive",value:function(){this.setState({idle:!1})}},{key:"transformMembersArray",value:function(e){var t={};for(key in e){if(e.hasOwnProperty(key))e[key].forEach(function(e){t[e.uid]=e})}return t}},{key:"handleUrlParams",value:function(){var e=getUrlParam("user_uid"),t=getUrlParam("mobile");e&&t&&this.setState({disableSidebar:!0,lockToParticipants:!0,onlyParticipants:[e]})}},{key:"render",value:function(){var e={sendMessage:this.sendMessage,loadMore:this.loadMore,switchChannel:this.switchChannel,handleIdle:this.handleIdle,handleActive:this.handleActive,leaveChannel:this.leaveChannel,pageChannels:this.pageChannels};return this.state.loading?null:React.createElement(FirebaseChannels,_extends({},this.props,{disableSidebar:this.state.disableSidebar,idle:this.state.idle,loading:this.state.loading,nextPage:this.state.channelsPagingMetadata.nextPage,activeChannel:this.state.activeChannel,currentUser:this.chatClient.currentUser.uid,members:this.state.members,channelOrder:this.state.channelOrder,channels:this.state.channels,firebase:e,messages:this.state.messages,typings:this.state.typings}))}}]),t}(React.Component);FirebaseContainer.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={participants:React.PropTypes.array,members:React.PropTypes.object,tokenPath:React.PropTypes.string,currentUser:React.PropTypes.string,disableInput:React.PropTypes.bool,firebaseConfig:React.PropTypes.object.isRequired};var FixedChannelContainer=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.chatClient=ChatClient.getInstance(),this.chatClient.tokenPath=this.props.tokenPath,this.chatClient.jwtAuthToken=this.props.jwt,this.chatClient.configureFirebase(this.props.firebaseConfig),this.getChannelsByMembers=this.getChannelsByMembers.bind(this),this.switchChannel=this.switchChannel.bind(this),this.loadMore=this.loadMore.bind(this),this.handleGetChannelsResponse=this.handleGetChannelsResponse.bind(this),this.handleMessageLoaded=this.handleMessageLoaded.bind(this),this.handleMessageAdded=this.handleMessageAdded.bind(this),this.addMessageToChannel=this.addMessageToChannel.bind(this),this.updateChannel=this.updateChannel.bind(this),this.defaultToFirstChannel=this.defaultToFirstChannel.bind(this),this.state={activeChannel:{},channels:{},channelOrder:[],loading:!0}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){var e=this;this.chatClient.signIn().then(this.getChannelsByMembers).then(this.defaultToFirstChannel).then(function(){e.setState({loading:!1})})}},{key:"getChannelsByMembers",value:function(){var a=this;return new Promise(function(e,t){var n=a.props.participants;if(!n||n.length<1)return t("Must pass in participants list");var r=a.props.participants.map(function(e){return a.chatClient.getChannelsWithMembers(e)});Promise.all(r)["catch"](function(e){return t(e)}).then(a.handleGetChannelsResponse).then(function(){return e()})})}},{key:"defaultToFirstChannel",value:function(){this.switchChannel(this.state.channelOrder[0])}},{key:"handleGetChannelsResponse",value:function(r){var a=this;return new Promise(function(e){var t={},n=[];r.forEach(function(e){e.forEach(function(e){t[e.id]=e,n.push(e.id)})}),a.setState({channels:t,channelOrder:n},function(){e(t)})})}},{key:"switchChannel",value:function(e){var t=this,n=this.getLocalChannel(e),r=this.state.activeChannel,a={activeChannel:n};if(r.id!==e){var s=isEmptyObject(r)?n:r,i=_extends({},this.state.channels,_defineProperty({},s.id,s));a.channels=i,this.setState(a,function(){t.subscribeToChannelEvents(e)})}}},{key:"subscribeToChannelEvents",value:function(e){var t=this.getLocalChannel(e);t.subscribed||(t.on("messageAdded",this.handleMessageAdded),t.on("messageLoaded",this.handleMessageLoaded),t.subscribe())}},{key:"getLocalChannel",value:function(e){return this.state.activeChannel.id===e?this.state.activeChannel:this.state.channels[e]}},{key:"handleMessageLoaded",value:function(e,t){var n=this.getLocalChannel(t[0].channelID);n&&this.addMessageToChannel(n.id,t)}},{key:"handleMessageAdded",value:function(e,t){var n=t[0].channelID;this.addMessageToChannel(n,t),this.updateChannelLastMessage(t[0])}},{key:"addMessageToChannel",value:function(e,t){var n=this.getLocalChannel(e),r=n.messages||[],a=[];a=Array.isArray(t)?[].concat(_toConsumableArray(r),_toConsumableArray(t)):[].concat(_toConsumableArray(r),[t]),n.messages=a,this.updateChannel(n)}},{key:"loadMore",value:function(){var a=this;return new Promise(function(t,n){var r=a.state.activeChannel;if(0<r.messages.length&&r.messages.length<r.messagesCount){var e=a.chatClient.messagePageUp(r.id,r.messages[0].docRef);e.then(function(e){r.messages=[].concat(_toConsumableArray(e.reverse()),_toConsumableArray(r.messages)),a.setState({activeChannel:r},function(){return t(!0)})}),e["catch"](function(e){console.error(e),n(!1)})}else n(!1)})}},{
key:"updateChannelLastMessage",value:function(e){var t=this.getLocalChannel(e.channelID);t.lastMessage=e.serialize(),this.updateChannel(t)}},{key:"updateChannel",value:function(e){var t={};e.id===this.state.activeChannel.id?t.activeChannel=e:t.channels=_extends({},this.state.channels,_defineProperty({},e.id,e)),this.setState(t)}},{key:"renderChannel",value:function(){return isEmptyObject(this.state.activeChannel)?null:React.createElement(Channel,{currentUser:this.props.currentUser,activeChannel:this.state.activeChannel,channels:this.state.channels,members:this.props.members,loadMore:this.loadMore,disableInput:this.props.disableInput})}},{key:"renderLoader",value:function(){if(this.props.loading)return React.createElement("div",{id:"loading-overlay"},React.createElement("div",{id:"loader"},React.createElement("i",{className:"fa fa-spinner fa-pulse fa-3x fa-fw"})))}},{key:"renderChannelSidebar",value:function(){return this.props.disableSidebar?null:React.createElement(ChannelSidebar,{currentUser:this.props.currentUser,channels:this.state.channels,switchChannel:this.switchChannel,activeChannel:this.state.activeChannel,channelOrder:this.state.channelOrder,members:this.props.members})}},{key:"render",value:function(){return this.state.loading?null:React.createElement("div",{className:"chat-channels chat-channels-md"},this.renderLoader(),this.renderChannelSidebar(),this.renderChannel())}}]),t}(React.Component);FixedChannelContainer.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={messageLocalId:React.PropTypes.string,body:React.PropTypes.string.isRequired,author:React.PropTypes.object.isRequired,authored:React.PropTypes.bool,owned:React.PropTypes.bool,retryMessage:React.PropTypes.func};var Message=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.messageClasses=this.messageClasses.bind(this),this.handleRetry=this.handleRetry.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleRetry",value:function(e){e.preventDefault(),this.props.retryMessage&&this.props.retryMessage(this.props.channelID,this.props.messageLocalId)}},{key:"messageClasses",value:function(){var e=["message-container"];return this.props.authored&&e.push("authored"),this.props.owned&&e.push("owned"),"failed"===this.props.status&&e.push("not-sent"),e.join(" ")}},{key:"renderFailureMessage",value:function(){return"failed"===this.props.status?React.createElement("small",{className:"failure-message text-danger"},React.createElement("i",null,"Failed to send message. ",React.createElement("a",{href:"#",onClick:this.handleRetry},"Retry?"))):null}},{key:"render",value:function(){return React.createElement("div",{className:this.messageClasses()},React.createElement("img",{src:this.props.author.profile_picture_url,className:"chat-profile-picture"}),React.createElement("div",{className:"message"},React.createElement("p",null,this.props.body)),this.renderFailureMessage())}}]),t}(React.Component),MessageForm=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={sendMessage:React.PropTypes.func.isRequired,startTyping:React.PropTypes.func,stopTyping:React.PropTypes.func,typingMessage:React.PropTypes.string},defaultProps={startTyping:function(){},stopTyping:function(){}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSend=this.handleSend.bind(this),this.handleTextChanged=this.handleTextChanged.bind(this),this.startTyping=this.props.startTyping(),this.stopTyping=this.props.stopTyping(),this.state={text:""}}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){var t=this;750<window.outerWidth&&$(this.msgInput).on("keypress",function(e){13===e.keyCode&&t.handleSend(e)})}},{key:"handleSend",value:function(e){e.preventDefault();var t=this.state.text;t.trim()&&(this.props.sendMessage(t),this.setState({text:""}))}},{key:"handleTextChanged",value:function(e){this.startTyping(),this.stopTyping(),this.setState({text:e.target.value})}},{key:"renderTypingText",value:function(){if(this.props.typingMessage)return React.createElement("div",{className:"text-muted typing-indicator"},React.createElement("i",null,this.props.typingMessage))}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"message-form"},this.renderTypingText(),React.createElement("div",{className:"form message-form-content"},React.createElement("textarea",{ref:function(e){return t.msgInput=e},onChange:this.handleTextChanged,className:"message-input form-control",placeholder:"Send a message",value:this.state.text}),React.createElement("a",{className:"hidden-md hidden-lg message-send-btn",href:"#",onClick:this.handleSend},React.createElement("i",{className:"fa fa-paper-plane"}))))}}]),t}(React.Component));MessageForm.propTypes=propTypes,MessageForm.defaultProps=defaultProps;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={imageUrls:React.PropTypes.array};var ProfilePicture=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderImages",value:function(){var n=this.calculatePixels(),e=this.props.imageUrls.map(function(e,t){return React.createElement("div",{key:"profile-pic-"+t,style:n[t]},React.createElement("img",{src:e}))});return React.createElement("div",null,e)}},{key:"calculatePixels",value:function(){return 3===this.props.imageUrls.length?[{width:"33px",height:"50px","float":"left"},{width:"17px",height:"50%","float":"right"},{width:"17px",height:"50%","float":"right"}]:2===this.props.imageUrls.length?[{width:"25px",height:"50px","float":"left"},{width:"25px",height:"50px","float":"right"}]:[{width:"50px",height:"50px"}]}},{key:"render",value:function(){return React.createElement("div",{className:"profile-picture-container"},this.renderImages())}}]),t}(React.Component);ProfilePicture.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var LocationPicker=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.selectRegion=this.selectRegion.bind(this),this.setRegion=this.setRegion.bind(this),this.state={currentRegion:this.props.currentRegion}}return _inherits(t,e),_createClass(t,[{key:"selectRegion",value:function(e){var t=this;call=$.ajax({url:"/regions/"+e.id+"/set",dataType:"json",method:"POST"}),call.done(function(e){t.setRegion(e)}),call.fail(function(e){console.error(e)})}},{key:"setRegion",value:function(){location.reload()}},{key:"drawMarkerIcon",value:function(){return React.createElement("svg",{version:"1.1",viewBox:"0 0 24 24"},React.createElement("g",null,React.createElement("path",{d:"M12,2C8.1,2,5,5.1,5,9c0,5.3,7,13,7,13s7-7.8,7-13C19,5.1,15.9,2,12,2z M12,12c-1.7,0-3-1.3-3-3s1.3-3,3-3s3,1.3,3,3 S13.7,12,12,12z"})))}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"dropdown-container"},React.createElement("a",{href:"#",className:"dropdown-toggle","data-toggle":"dropdown"},this.drawMarkerIcon(),this.state.currentRegion.name),React.createElement("ul",{className:"dropdown-menu"},this.props.regions.map(function(e){return React.createElement("li",{key:e.id},React.createElement("a",{href:"#",onClick:t.selectRegion.bind(t,e)},e.name))})))}}]),t}(React.Component),RegionForm=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.changeField=this.changeField.bind(this),this.state={boundary:this.props.boundary}}return _inherits(t,e),_createClass(t,[{key:"changeField",value:function(e){this.setState({boundary:e})}},{key:"render",value:function(){return React.createElement("div",{className:"admin-region-container"},React.createElement(RegionMap,{boundary:this.state.boundary,changeField:this.changeField}))}}]),t}(React.Component)),RegionMap=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.map=this.loadMap(),this.boundary=this.drawBoundary(),this.loadControls(),this.fitWorld(),this.handleEdit()}},{key:"loadMap",value:function(){var e=L.map("map-react",{editable:!0});return L.tileLayer("//api.tiles.mapbox.com/v4/mapbox.high-contrast/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiamlmZnlvbmRlbWFuZCIsImEiOiJiXzZGQ1o4In0.-cJyN_e12UG_Pjr5qZ7q3A",{attribution:'&copy; <a href="//openstreetmap.org">OpenStreetMap</a> | &copy; <a href="//mapbox.com">Mapbox</a>'}).addTo(e),e}},{key:"loadControls",value:function(){new L.Control.Draw({draw:!1,edit:{featureGroup:this.boundary,remove:!1}}).addTo(this.map)}},{key:"handleEdit",value:function(){var n=this;this.map.on("draw:edited",function(e){var t=e.layers.getLayers()[0].toGeoJSON();n.changeField(t)})}},{key:"changeField",value:function(e){this.props.changeField(e)}},{key:"drawBoundary",value:function(){return L.geoJson(this.props.boundary,{color:"#039be5",fillColor:"#039be5"}).addTo(this.map)}},{key:"fitWorld",value:function(){coordinates=this.props.boundary.coordinates[0].map(function(e){return[e[1],e[0]]});var e=L.latLngBounds(coordinates||[[43.7085,-79.3959]]);this.map.fitBounds(e,{padding:[25,25],maxZoom:15})}},{key:"render",value:function(){return React.createElement("div",{id:"map-react",className:"map-lg hidden-xs"})}}]),t}(React.Component)),RegionPicker=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.selectRegion=this.selectRegion.bind(this),this.setRegion=this.setRegion.bind(this),this.toggleDropdown=this.toggleDropdown.bind(this),this.hideMenu=this.hideMenu.bind(this),this.state={currentRegion:this.props.currentRegion,showMenu:!1}}return _inherits(t,e),_createClass(t,[{key:"hideMenu",value:function(e){e.preventDefault(),this.setState({showMenu:!1})}},{key:"selectRegion",value:function(e){var t=this,n=$.ajax({url:"/regions/"+e.id+"/set",dataType:"json",method:"POST"});n.done(function(e){t.setRegion(e)}),n.fail(function(e){console.error(e)})}},{key:"setRegion",value:function(){location.reload()}},{key:"toggleDropdown",value:function(e){e.preventDefault(),e.stopPropagation();var t=!this.state.showMenu;this.setState({showMenu:t})}},{key:"renderDropdownClass",value:function(){return this.state.showMenu?"dropdown-menu open":"dropdown-menu"}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"dropdown-container"},React.createElement("a",{href:"#",className:"link",onClick:this.toggleDropdown,onBlur:this.hideMenu},this.state.currentRegion.name,React.createElement("i",{className:"fa fa-chevron-down"})),React.createElement("ul",{className:this.renderDropdownClass()},this.props.regions.map(function(e){return React.createElement("li",{className:"dropdown-item",key:e.id,onMouseDown:t.selectRegion.bind(t,e)},React.createElement("a",{href:"#"},e.name))})))}}]),t}(React.Component)),CreditCardsFormPanel=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"job-details-panel"},React.createElement("div",{className:"job-details-body"},React.createElement(CCSatisfactionList,{lockIcon:this.props.lockIcon,checkIcon:this.props.checkIcon}),React.createElement(CardForm,this.props)))}}]),t}(React.Component)),CreditCardsIndex=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.pollCards=this.pollCards.bind(this),this.fetchCards=this.fetchCards.bind(this),this.updateCardDefault=this.updateCardDefault.bind(this),this.handleSetDefault=this.handleSetDefault.bind(this),this.updateCardList=this.updateCardList.bind(this),this.handleRemoveCard=this.handleRemoveCard.bind(this),this.renderCardTable=this.renderCardTable.bind(this),this.state={creditCards:this.props.cards||[],isFetching:!1}}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){setInterval(this.pollCards,1e4)}},{key:"fetchCards",value:function(){var t=this;$.ajax({url:this.props.crudPaths.index,dataType:"json",type:"GET"}).done(function(e){t.setState({isFetching:!1,creditCards:e.credit_cards})})}},{key:"updateCardDefault",value:function(t){var e=this.state.creditCards.map(function(e){return e.id===t.id?e["default"]=t["default"]:e["default"]=!1,e});this.setState({creditCards:e})}},{key:"handleSetDefault",value:function(e){var t=$.ajax({url:this.props.crudPaths.update+e.id,dataType:"json",type:"PATCH",data:{credit_card:{"default":!0}}});t.done(this.updateCardDefault),t.fail(function(){alert("Some error occurred!")})}},{key:"handleRemoveCard",value:function(e){var t=this,n=$.ajax({url:this.props.crudPaths.destroy+e.id,type:"DELETE",dataType:"JSON"});n.done(function(){t.fetchCards()}),n.fail(function(){alertify.alert("This card cannot be removed. Please try again when your open jobs are closed out.")})}},{key:"pollCards",value:function(){this.state.isFetching||(this.setState({isFetching:!0}),this.fetchCards())}},{key:"updateCardList",value:function(e){this.setState({creditCards:[e].concat(this.state.creditCards)}),this.updateCardDefault(e),this.scrollBackToTop()}},{key:"scrollBackToTop",value:function(){50<$(window).scrollTop()&&$("html, body").animate({scrollTop:0},800)}},{key:"renderCardTable",value:function(){return 0<this.state.creditCards.length?React.createElement(CreditCardsTable,{creditCards:this.state.creditCards,creditCardImages:this.props.creditCardImages,handleSetDefault:this.handleSetDefault,handleRemoveCard:this.handleRemoveCard}):React.createElement("p",{className:"alert alert-info"},"You don't have any credit cards on file.")}},{key:"render",value:function(){return React.createElement("div",{className:"user-credit-cards"},this.renderCardTable(),React.createElement(CreditCardsFormPanel,{model:this.props.model,stripePowerBadge:this.props.stripePowerBadge,creditCardImages:this.props.creditCardImages,onCreateCard:this.updateCardList,lockIcon:this.props.lockIcon,checkIcon:this.props.checkIcon,crudPaths:this.props.crudPaths}))}}]),t}(React.Component)),CreditCardsShow=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSetDefault=this.handleSetDefault.bind(this),this.renderBrandLogo=this.renderBrandLogo.bind(this),this.handleRemoveCard=this.handleRemoveCard.bind(this),this.checkExpiryDate=this.checkExpiryDate.bind(this),this.renderRowClass=this.renderRowClass.bind(this),this.state={expired:!1}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.checkExpiryDate(this.props.creditCard)}},{key:"componentWillReceiveProps",value:function(e){this.checkExpiryDate(e.creditCard)}},{key:"checkExpiryDate",value:function(e){var t=e.exp_month,n=e.exp_year,r=new Date;new Date(n,t,0)<r?this.setState({expired:!0}):this.setState({expired:!1})}},{key:"renderBrandLogo",value:function(e){var t="";switch(e){case"Visa":t=this.props.creditCardImages.visaImage;break;case"MasterCard":t=this.props.creditCardImages.mastercardImage;break;case"American Express":t=this.props.creditCardImages.amexImage;break;default:t=this.props.creditCardImages.unknownCardImage}return t}},{key:"handleSetDefault",value:function(e,t){t.preventDefault(),this.props.onSetDefault(e)}},{key:"handleRemoveCard",value:function(e,t){var n=this;t.preventDefault(),alertify.confirm("<p class='text-danger'>Are you sure you want to remove your card?</p>",function(){n.props.onRemoveCard(e)})}},{key:"renderSetDefaultLink",value:function(e){var t=this;return e&&this.state.expired?React.createElement("span",{className:"text-danger"},"Default (Expired)"):e?React.createElement("span",{className:"text-muted"},"Default"):this.state.expired?React.createElement("span",{className:"text-danger"},"Expired"):React.createElement("a",{className:"red-hover",onClick:function(e){t.handleSetDefault(t.props.creditCard,e)}},"Set As Default")}},{key:"renderMonthWithZero",value:function(e){return("0"+e).slice(-2)}},{key:"renderRowClass",value:function(){return this.state.expired?"credit-card-row text-center text-muted":"credit-card-row text-center"}},{key:"render",value:function(){var t=this;return React.createElement("tr",{className:this.renderRowClass()},React.createElement("td",{className:"vertical-center card-logo-container","data-title":"Brand"},React.createElement("img",{className:"card-logo",src:this.renderBrandLogo(this.props.creditCard.brand)})),React.createElement("td",{className:"vertical-center","data-title":"Last 4 digits"},React.createElement("span",null,"**** **** **** "+this.props.creditCard.last_four)),React.createElement("td",{className:"vertical-center","data-title":"Expiry Date"},React.createElement("span",null,this.renderMonthWithZero(this.props.creditCard.exp_month),"/",this.props.creditCard.exp_year)),React.createElement("td",{className:"text-left small vertical-center","data-title":"Default?"},this.renderSetDefaultLink(this.props.creditCard["default"])),React.createElement("td",{className:"text-left small vertical-center","data-title":"Actions"},React.createElement("a",{className:"red-hover text-danger",onClick:function(e){t.handleRemoveCard(t.props.creditCard,e)}},React.createElement("i",{className:"fa fa-remove"}))))}}]),t}(React.Component)),CreditCardsTable=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderCards=this.renderCards.bind(this)}return _inherits(t,e),_createClass(t,[{key:"renderCards",value:function(){var t=this;return this.props.creditCards.map(function(e){return React.createElement(CreditCardsShow,{creditCard:e,key:e.id,creditCardImages:t.props.creditCardImages,onSetDefault:t.props.handleSetDefault,onRemoveCard:t.props.handleRemoveCard})})}},{key:"render",value:function(){return React.createElement("div",{className:"table-responsive-vertical credit-cards-table"},React.createElement("table",{className:"table"},React.createElement(ReactCSSTransitionGroup,{component:"tbody",transitionName:"user-address",transitionEnterTimeout:2500,transitionLeaveTimeout:300,transitionAppearTimeout:500},this.renderCards())))}}]),t}(React.Component)),CardError=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},defaultProps={message:"Your card is invalid!"},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.show=this.show.bind(this),this.hide=this.hide.bind(this)}return _inherits(t,e),_createClass(t,[{key:"show",value:function(){$(this.errorElement).show()}},{key:"hide",value:function(){$(this.errorElement).hide()}},{key:"render",value:function(){var t=this;return React.createElement("p",{ref:function(e){t.errorElement=e},id:"card-error",style:{display:"none"}},this.props.message)}}]),t}(React.Component));CardError.defaultProps=defaultProps;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var CardExpField=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.validateCardExp=this.validateCardExp.bind(this),this.handleExpMonth=this.handleExpMonth.bind(this),this.handleExpYear=this.handleExpYear.bind(this),this.state={expMonth:null,expYear:null}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){Validators.cardExpDate=this.validateCardExp,Validators.cardCVC=this.validateCVC}},{key:"validateCVC",value:function(e){return Stripe.card.validateCVC(e)?[]:["Invalid CVC"]}},{key:"validateCardExp",value:function(){var e=this.state.expMonth,t=this.state.expYear;return e&&t?Stripe.card.validateExpiry(e,t)?[]:["Invalid"]:[]}},{key:"handleExpMonth",value:function(e){var t=this;this.setState({expMonth:e},function(){t.monthSelect.validate(),t.yearSelect.validate()})}},{key:"handleExpYear",value:function(e){var t=this;this.setState({expYear:e},function(){t.monthSelect.validate(),t.yearSelect.validate()})}},{key:"renderYearArray",value:function(){for(var e=(new Date).getFullYear(),t=[],n=0;n<15;n++)t.push(e+n);return t}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"form-horizontal-group"},React.createElement("label",{className:"horizontal-label"},"Expiration Date"),React.createElement("div",{className:"horizontal-input-group inline"},React.createElement(SelectInputV2,{ref:function(e){t.monthSelect=e},name:"exp_month",collection:["01","02","03","04","05","06","07","08","09","10","11","12"],validations:["required","cardExpDate"],onChange:this.handleExpMonth,includeBlank:"MM"}),React.createElement("div",{className:"divider"},React.createElement("span",null,"/")),React.createElement(SelectInputV2,{ref:function(e){t.yearSelect=e},name:"exp_year",collection:this.renderYearArray(),validations:["required","cardExpDate"],onChange:this.handleExpYear,includeBlank:"YYYY"}),React.createElement(TextInputV2,{name:"cvc",validations:["cardCVC"],placeholder:"CVC"})))}}]),t}(React.Component),CardForm=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={model:React.PropTypes.object.isRequired,stripePowerBadge:React.PropTypes.string.isRequired,creditCardImages:React.PropTypes.object.isRequired,onCreateCard:React.PropTypes.func.isRequired},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.stripeResponseHandler=this.stripeResponseHandler.bind(this),this.postForm=this.postForm.bind(this),this.handleSuccessPost=this.handleSuccessPost.bind(this),this.handleFailedPost=this.handleFailedPost.bind(this),this.resetForm=this.resetForm.bind(this),this.setupStripe(),this.state={submitDisabled:!1}}return _inherits(t,e),_createClass(t,[{key:"handleFormSubmit",value:function(n){var r=this,e={number:n.card_number,cvc:n.cvc,expMonth:n.exp_month,expYear:n.exp_year};this.setState({submitDisabled:!0}),Stripe.createToken(e,function(e,t){r.stripeResponseHandler(e,t,n)})}},{key:"stripeResponseHandler",value:function(e,t,n){t.error?(this.setState({apiErrorMessage:t.error.message}),this.cardErrorElement.show()):(n.stripe_card_token=t.id,this.postForm(n),this.cardErrorElement.hide())}},{key:"postForm",value:function(e){var t=$.ajax({url:this.props.crudPaths.create,type:"POST",dataType:"json",data:{credit_card_form:e}});t.done(this.handleSuccessPost),t.fail(this.handleFailedPost)}},{key:"handleSuccessPost",value:function(e){this.setState({submitDisabled:!1},this.resetForm),this.props.onCreateCard(e)}},{key:"handleFailedPost",value:function(e){var t=e.responseJSON;this.setState({apiErrorMessage:t.errors,submitDisabled:!1}),this.cardErrorElement.show()}},{key:"setupStripe",value:function(){"function"==typeof Stripe&&Stripe.setPublishableKey($("meta[name='stripe-publishable-key']").attr("content"))}},{key:"resetForm",value:function(){this.ccFormElement.reset(),this.cardNumberField.reset()}},{key:"render",value:function(){var t=this;return React.createElement(FormV2,{className:"form",ref:function(e){t.ccFormElement=e},id:"credit-card-form",submit:this.handleFormSubmit},React.createElement(CardError,{ref:function(e){t.cardErrorElement=e},message:this.state.apiErrorMessage}),React.createElement(CardNumberField,{ref:function(e){t.cardNumberField=e},creditCardImages:this.props.creditCardImages}),React.createElement(CardExpField,null),React.createElement(CardSubmitRow,{submitDisabled:this.state.submitDisabled,stripePowerBadge:this.props.stripePowerBadge}))}}]),t}(React.Component));CardForm.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var CardNumberField=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderCardLogo=this.renderCardLogo.bind(this),this.handleCardInput=this.handleCardInput.bind(this),this.reset=this.reset.bind(this),this.state={brand:""}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){Validators.creditCardNumber=this.validateCardNum}},
{key:"validateCardNum",value:function(e){return Stripe.card.validateCardNumber(e)?[]:[""]}},{key:"handleCardInput",value:function(e){var t=Stripe.card.cardType(e);this.setState({brand:t})}},{key:"reset",value:function(){this.setState({brand:""})}},{key:"renderCardLogo",value:function(){var e="";switch(this.state.brand){case"Visa":e=this.props.creditCardImages.visaImage;break;case"MasterCard":e=this.props.creditCardImages.mastercardImage;break;case"American Express":e=this.props.creditCardImages.amexImage;break;default:e=this.props.creditCardImages.unknownCardImage}return React.createElement("div",{id:"card-logo"},React.createElement("img",{src:e,alt:this.state.brand+"-logo"}))}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"form-horizontal-group"},React.createElement("label",{className:"horizontal-label"},"Card Number"),React.createElement("div",{className:"horizontal-input-group inline"},React.createElement(TextInputV2WithMask,{inputRef:function(e){t.cardNumberInput=e},validations:["creditCardNumber"],name:"card_number",maskPattern:"0000 0000 0000 0000",onChange:this.handleCardInput}),this.renderCardLogo()))}}]),t}(React.Component),CardSubmitRow=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"form-horizontal-group"},React.createElement("img",{className:"stripe-powered-badge",src:this.props.stripePowerBadge,alt:"Striped Powered"}),React.createElement(SubmitButtonV2,{className:"btn btn-success",id:"credit-card-submit",submitDisabled:this.props.submitDisabled},"Save Credit Card"))}}]),t}(React.Component)),CCSatisfactionList=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"payment-features-container"},React.createElement("div",{className:"payment-features"},React.createElement("div",{className:"feature"},React.createElement("img",{src:this.props.lockIcon,className:"feature-icon"}),React.createElement("span",null,"Secure Payment Processing")),React.createElement("div",{className:"feature"},React.createElement("img",{src:this.props.checkIcon,className:"feature-icon"}),React.createElement("span",null,"100% Satisfaction Guarantee"))))}}]),t}(React.Component)),Deal=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={deal:React.PropTypes.object.isRequired},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderDate",value:function(e){if(e){var t=new Date(e);return months[t.getMonth()].short_month+" "+t.getDate()}return"Unknown"}},{key:"renderTimeSlots",value:function(e){return e.map(function(e,t){return React.createElement("span",{key:"timeslot-"+t,className:"badge"},e)})}},{key:"renderDealClasses",value:function(){var e="deal-body deal-v-split";return this.props.selected&&(e+=" selected"),e}},{key:"render",value:function(){var t=this,n=this.props.deal;return React.createElement("div",{className:this.renderDealClasses()},React.createElement("div",{className:"deal-info",onClick:function(e){return t.props.handleClick(n,e)}},React.createElement("p",{className:"deal-date"},this.renderDate(n.eta)),React.createElement("div",{className:"time-slots"},this.renderTimeSlots(n.time_slots))),React.createElement("a",{href:n.url,className:"deal-accept"},React.createElement("i",{className:"fa fa-arrow-right"})))}}]),t}(React.Component));Deal.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={map:React.PropTypes.object,location:React.PropTypes.object.isRequired,activeDeal:React.PropTypes.string};var DealMapMarker=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.drawMarker=this.drawMarker.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.drawMarker()}},{key:"componentDidUpdate",value:function(){this.props.location.id===this.props.activeDeal?(this.marker.setZIndexOffset(999),$(this.marker._icon).addClass("selected-marker")):(this.marker.setZIndexOffset(0),$(this.marker._icon).removeClass("selected-marker"))}},{key:"componentWillUnmount",value:function(){this.props.map.removeLayer(this.marker)}},{key:"drawMarker",value:function(){var e=L.AwesomeMarkers.icon({icon:"circle",prefix:"fa",markerColor:"blue"});this.props.location.flash_deal&&(e=L.AwesomeMarkers.icon({icon:"bolt",prefix:"fa",markerColor:"red"}));var t={icon:e,riseOnHover:!0},n=[Number(this.props.location.latitude),Number(this.props.location.longitude)],r=this.popupHtml();this.marker=L.marker(n,t),this.marker.bindPopup(r),this.props.map.addLayer(this.marker)}},{key:"renderDate",value:function(e){if(e){var t=new Date(e);return months[t.getMonth()].short_month+" "+t.getDate()}return"Unknown"}},{key:"popupHtml",value:function(){var e=this.props.location,t='<p class="deal-popup-date">'+this.renderDate(e.eta)+"</p>";return t+="<a href="+e.url+" class='btn btn-block btn-success btn-xs'><i class='fa fa-arrow-right'></i></a>"}},{key:"render",value:function(){return React.createElement("div",{className:"deal-map-marker"})}}]),t}(React.Component);DealMapMarker.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={deals:React.PropTypes.array,userAddress:React.PropTypes.object,userAddresses:React.PropTypes.array,serviceName:React.PropTypes.string,serviceIcon:React.PropTypes.string,serviceId:React.PropTypes.string,serviceDiscount:React.PropTypes.string};var Deals=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.setActiveDeal=this.setActiveDeal.bind(this),this.setSelectedDeal=this.setSelectedDeal.bind(this),this.setFilter=this.setFilter.bind(this),this.getData=this.getData.bind(this),this.handleSuccessfulFetch=this.handleSuccessfulFetch.bind(this),this.handleFailedFetch=this.handleFailedFetch.bind(this),this.state={deals:this.props.deals,activeDeal:null,selectedDeal:null,alertShown:!1,loading:!1,filterParams:{userAddress:this.props.userAddress}}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){var e=this;this.getDataDebounced=$.debounce(function(){e.getData.apply(e)},250)}},{key:"setActiveDeal",value:function(e){this.setState({activeDeal:e})}},{key:"setSelectedDeal",value:function(e){this.setState({selectedDeal:e})}},{key:"setFilter",value:function(e){var t=this,n=arguments.length<=0||e===undefined?{}:e;this.setState({filterParams:_extends({},this.state.filterParams,n)},function(){t.getDataDebounced()})}},{key:"getData",value:function(){this.setState({loading:!0});var e=this.state.filterParams,t=$.ajax({url:"/deals",type:"GET",dataType:"JSON",data:{address_id:e.userAddress.id,service_id:this.props.serviceId}});t.done(this.handleSuccessfulFetch),t.fail(this.handleFailedFetch)}},{key:"handleSuccessfulFetch",value:function(e){this.setState({loading:!1,deals:e.deals})}},{key:"handleFailedFetch",value:function(){var e=this;this.setState({loading:!1}),this.state.alertShown||(this.setState({alertShown:!0}),alertify.alert("Something went wrong. Please contact Jiffy for support",function(){e.setState({alertShown:!1})}))}},{key:"renderSkipBtn",value:function(){return 0<this.state.deals.length?React.createElement("a",{className:"btn btn-block btn-secondary",href:"/jobs/new?job[service]="+this.props.serviceId},"Skip Deals"):null}},{key:"renderBody",value:function(){return this.props.userAddress?React.createElement("div",{className:"body-container"},React.createElement(DealsServiceSection,{serviceIcon:this.props.serviceIcon,serviceName:this.props.serviceName,serviceId:this.props.serviceId,serviceDiscount:this.props.serviceDiscount}),React.createElement("div",{className:"row deals-body"},React.createElement("div",{className:"col-md-9 col-sm-12"},React.createElement(DealsMap,{userAddresses:this.props.userAddresses,setFilter:this.setFilter,filters:this.state.filterParams,userAddress:this.state.filterParams.userAddress,deals:this.state.deals,setActiveDeal:this.setActiveDeal,activeDeal:this.state.activeDeal})),React.createElement("div",{className:"col-md-3 col-sm-12"},React.createElement("div",{className:"deal-sidebar"},React.createElement(DealsList,{deals:this.state.deals,selectedDeal:this.state.selectedDeal,setSelectedDeal:this.setSelectedDeal,setActiveDeal:this.setActiveDeal,loading:this.state.loading,serviceId:this.props.serviceId}),this.renderSkipBtn())))):React.createElement("div",{className:"no-address-notice"},React.createElement("p",{className:"alert alert-info text-center"},"Want to get a deal for your job? ",React.createElement("a",{target:"_blank",href:"/user/addresses"},"Add an address now!")))}},{key:"render",value:function(){return React.createElement("div",{className:"deals-container"},this.renderBody())}}]),t}(React.Component);Deals.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={deals:React.PropTypes.array,setActiveDeal:React.PropTypes.func,setSelectedDeal:React.PropTypes.func,loading:React.PropTypes.bool,serviceId:React.PropTypes.string};var DealsList=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleHover=this.handleHover.bind(this),this.handleMouseOut=this.handleMouseOut.bind(this),this.handleClick=this.handleClick.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleHover",value:function(e,t){t.preventDefault(),this.props.setActiveDeal(e.id)}},{key:"handleMouseOut",value:function(){this.props.setActiveDeal(null)}},{key:"handleClick",value:function(e,t){t.preventDefault(),this.props.setSelectedDeal(e.id)}},{key:"renderDeals",value:function(){var n=this,e=this.props.deals;return 0<e.length?e.map(function(t){return React.createElement("li",{key:t.id,onMouseEnter:function(e){return n.handleHover(t,e)},onMouseLeave:n.handleMouseOut,className:"deal-item"},React.createElement(Deal,{deal:t,selected:n.props.selectedDeal==t.id,handleClick:n.handleClick}))}):React.createElement("li",{className:"deal-item no-deal"},React.createElement("div",{className:"deal-body"},React.createElement("p",{className:"text-center"},"No Deals Available")),React.createElement("div",{className:"deal-footer"},React.createElement("a",{href:"/jobs/new?job[service]="+this.props.serviceId,className:"btn btn-block btn-warning"},"Continue")))}},{key:"renderLoading",value:function(){return React.createElement("li",{className:"text-center loading"},React.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw"}),React.createElement("br",null),React.createElement("span",null,"Loading..."))}},{key:"render",value:function(){var e=null;return e=this.props.loading?this.renderLoading():this.renderDeals(),React.createElement("ul",{className:"deals-list list-unstyled"},e)}}]),t}(React.Component);DealsList.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={userAddresses:React.PropTypes.array,setFilter:React.PropTypes.func,filters:React.PropTypes.object,userAddress:React.PropTypes.object,deals:React.PropTypes.array,setActiveDeal:React.PropTypes.func,activeDeal:React.PropTypes.string};var DealsMap=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"map-section"},React.createElement("div",{className:"flash-deal-filters"},React.createElement(FlashDealsAddressFilter,{userAddresses:this.props.userAddresses,setFilter:this.props.setFilter,filters:this.props.filters})),React.createElement(FlashDealsMap,{userAddress:this.props.userAddress,deals:this.props.deals,setActiveDeal:this.props.setActiveDeal,activeDeal:this.props.activeDeal}))}}]),t}(React.Component);DealsMap.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={serviceIcon:React.PropTypes.string,serviceName:React.PropTypes.string,serviceDiscount:React.PropTypes.string};var DealsServiceSection=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderServiceDiscount",value:function(){return this.props.serviceDiscount?React.createElement("p",null,this.props.serviceDiscount+" OFF"):null}},{key:"render",value:function(){return React.createElement("div",{className:"deals-header"},React.createElement("div",{className:"service-info"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-9 service-section"},React.createElement("img",{src:this.props.serviceIcon,className:"service-icon img-circle"}),React.createElement("div",{className:"service-heading"},this.props.serviceName)),React.createElement("div",{className:"col-sm-3 service-discount"},this.renderServiceDiscount()))))}}]),t}(React.Component);DealsServiceSection.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={header:React.PropTypes.string.isRequired,deals:React.PropTypes.array.isRequired,setActiveDeal:React.PropTypes.func.isRequired},defaultProps={deals:[]};var FlashDealGroup=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleDealClicked=this.handleDealClicked.bind(this),this.handleHover=this.handleHover.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleDealClicked",value:function(e,t){t.preventDefault(),location.href=e.url}},{key:"handleHover",value:function(e){this.props.setActiveDeal(e.id)}},{key:"renderDeals",value:function(){var n=this;return this.props.deals.map(function(t,e){return React.createElement("div",{onClick:function(e){return n.handleDealClicked(t,e)},onMouseEnter:function(e){return n.handleHover(t,e)},className:"group-content",key:"deal-"+n.props.header+"-"+e},React.createElement("span",{className:"service-name"},t.service_name),React.createElement("div",{className:"time-slots"},n.renderTimeSlots(t.time_slots)))})}},{key:"renderTimeSlots",value:function(e){return e.map(function(e,t){return React.createElement("span",{key:"timeslot-"+t,className:"badge"},e)})}},{key:"render",value:function(){return React.createElement("li",{className:"flash-deal-group"},React.createElement("div",{className:"group-header"},this.props.header),this.renderDeals())}}]),t}(React.Component);FlashDealGroup.propTypes=propTypes,FlashDealGroup.defaultProps=defaultProps;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={userAddress:React.PropTypes.object.isRequired,deals:React.PropTypes.object,allServices:React.PropTypes.array.isRequired,todoItems:React.PropTypes.array.isRequired,userAddresses:React.PropTypes.array.isRequired,filters:React.PropTypes.object};var FlashDeals=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.setActiveDeal=this.setActiveDeal.bind(this),this.setFilter=this.setFilter.bind(this),this.getData=this.getData.bind(this),this.handleSuccessfulFetch=this.handleSuccessfulFetch.bind(this),this.handleFailedFetch=this.handleFailedFetch.bind(this),this.state={activeDeal:null,loading:!1,alertShown:!1,deals:this.props.deals,filters:{startDate:this.props.filters.startDate,endDate:this.props.filters.endDate,userAddress:this.props.userAddress,regionalServiceIds:[],filterByTodo:!1}}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){var e=this;this.getDataDebounced=$.debounce(function(){e.getData.apply(e)},250)}},{key:"setActiveDeal",value:function(e){this.setState({activeDeal:e})}},{key:"setFilter",value:function(e){var t=this,n=arguments.length<=0||e===undefined?{}:e;this.setState({filters:_extends({},this.state.filters,n)},function(){t.getDataDebounced()})}},{key:"getData",value:function(){this.setState({loading:!0});var e=this.state.filters,t=$.ajax({url:"/deals/browse",type:"GET",dataType:"JSON",data:{start_date:e.startDate,end_date:e.endDate,address_id:e.userAddress.id,regional_service_ids:e.regionalServiceIds,filter_by_todo:e.filterByTodo}});t.done(this.handleSuccessfulFetch),t.fail(this.handleFailedFetch)}},{key:"handleSuccessfulFetch",value:function(e){this.setState({loading:!1,deals:e})}},{key:"handleFailedFetch",value:function(){var e=this;this.setState({loading:!1}),this.state.alertShown||(this.setState({alertShown:!0}),alertify.alert("Something went wrong. Please contact Jiffy for support",function(){e.setState({alertShown:!1})}))}},{key:"render",value:function(){return React.createElement("div",{className:"flash-deals"},React.createElement(FlashDealsFilters,{allServices:this.props.allServices,todoItems:this.props.todoItems,userAddresses:this.props.userAddresses,filters:this.state.filters,setFilter:this.setFilter,userAddress:this.state.filters.userAddress}),React.createElement("div",{className:"flash-deals-content"},React.createElement("div",{className:"sidebar-container"},React.createElement(FlashDealsSidebar,{deals:this.state.deals,setActiveDeal:this.setActiveDeal,loading:this.state.loading})),React.createElement("div",{className:"map-container"},React.createElement(FlashDealsMap,{userAddress:this.state.filters.userAddress,deals:this.state.deals,setActiveDeal:this.setActiveDeal,currentActiveDeal:this.state.currentActiveDeal}))))}}]),t}(React.Component);FlashDeals.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={userAddresses:React.PropTypes.array.isRequired,setFilter:React.PropTypes.func.isRequired,filters:React.PropTypes.object.isRequired};var FlashDealsAddressFilter=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.setAddressSelectHeight=this.setAddressSelectHeight.bind(this),this.showAddressList=this.showAddressList.bind(this),this.hideAddressList=this.hideAddressList.bind(this),this.toggleAddressList=this.toggleAddressList.bind(this),this.state={addressListShow:!1}}return _inherits(t,e),_createClass(t,[{key:"setAddressSelectHeight",value:function(e){this.setState({addressSelectHeight:e})}},{key:"toggleAddressList",value:function(){this.setState({addressListShow:!this.state.addressListShow})}},{key:"showAddressList",value:function(){this.setState({addressListShow:!0})}},{key:"hideAddressList",value:function(){this.setState({addressListShow:!1})}},{key:"renderAddressLabel",value:function(e){var t=[e.street_number+" "+e.line1,e.line2,e.city,e.subregion,e.postal_code];return t=(t=t.filter(function(e){return null!==e&&e!==undefined&&""!==e})).join(", ")}},{key:"render",value:function(){return React.createElement("div",{className:"address-select form"},React.createElement(FlashDealsAddressSelect,{setHeight:this.setAddressSelectHeight,toggleAddressList:this.toggleAddressList,hideAddressList:this.hideAddressList,renderAddressLabel:this.renderAddressLabel,filters:this.props.filters,userAddresses:this.props.userAddresses}),React.createElement(FlashDealsAddressList,{visible:this.state.addressListShow,userAddresses:this.props.userAddresses,renderAddressLabel:this.renderAddressLabel,setFilter:this.props.setFilter}))}}]),t}(React.Component),FlashDealsAddressList=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={visible:React.PropTypes.bool.isRequired,userAddresses:React.PropTypes.array.isRequired,renderAddressLabel:React.PropTypes.func.isRequired,setFilter:React.PropTypes.func.isRequired},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleAddressClick=this.handleAddressClick.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleAddressClick",value:function(e){this.props.setFilter({userAddress:e})}},{key:"renderClass",value:function(){var e="address-select-options";return this.props.visible||(e+=" hidden"),e}},{key:"renderAddresses",value:function(){var r=this,e=this.props.userAddresses.map(function(t,e){var n=r.props.renderAddressLabel(t);return React.createElement("li",{className:"option",key:"address-list-"+e,onMouseDown:function(e){return r.handleAddressClick(t,e)}},n)});return React.createElement("ul",{className:"option-list list-unstyled"},e)}},{key:"render",value:function(){return React.createElement("div",{className:this.renderClass()},this.renderAddresses())}}]),t}(React.Component));FlashDealsAddressList.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={setHeight:React.PropTypes.func.isRequired,toggleAddressList:React.PropTypes.func.isRequired,hideAddressList:React.PropTypes.func.isRequired,renderAddressLabel:React.PropTypes.func.isRequired,userAddresses:React.PropTypes.array.isRequired,filters:React.PropTypes.object.isRequired};var FlashDealsAddressSelect=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleShowDropdown=this.handleShowDropdown.bind(this),this.handleBlur=this.handleBlur.bind(this),this.getCurrentAddress=this.getCurrentAddress.bind(this),this.renderAddressValue=this.renderAddressValue.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){var e=$(this.input).outerHeight();this.props.setHeight(e)}},{key:"handleShowDropdown",value:function(e){e.preventDefault(),this.props.toggleAddressList()}},{key:"handleBlur",value:function(e){e.preventDefault(),this.props.hideAddressList()}},{key:"renderAddressValue",value:function(){var e=this.getCurrentAddress();return this.props.renderAddressLabel(e)}},{key:"getCurrentAddress",value:function(){var t=this,n=this.props.userAddresses[-1];return this.props.userAddresses.forEach(function(e){if(e.id===t.props.filters.userAddress.id)return n=e,!1}),n}},{key:"render",value:function(){var t=this;return React.createElement("div",{ref:function(e){return t.input=e},className:"input-group input-group-sm"},React.createElement("input",{className:"form-control address-select-display",placeholder:"Select an address",readOnly:!0,value:this.renderAddressValue()}),React.createElement("button",{type:"button",className:"btn btn-default filter-btn",onClick:this.handleShowDropdown,onBlur:this.handleBlur},React.createElement("i",{className:"fa fa-caret-down"})))}}]),t}(React.Component);FlashDealsAddressSelect.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={setFilter:React.PropTypes.func.isRequired,filters:React.PropTypes.object.isRequired};var FlashDealsDateRange=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleDateChange=this.handleDateChange.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){var t=this.handleDateChange,e=this.props.filters.endDate;flatpickr(this.startDatePicker,{minDate:"today",dateFormat:"m/d/Y",enable:[{from:"today",to:e}],onChange:function(e){t(e,!0)}}),flatpickr(this.endDatePicker,{minDate:"today",dateFormat:"m/d/Y",enable:[{from:"today",to:e}],onChange:function(e){t(e,!1)}})}},{key:"handleDateChange",value:function(e,t){t?this.props.setFilter({startDate:this.formatDate(e[0])}):this.props.setFilter({endDate:this.formatDate(e[0])})}},{key:"formatDate",value:function(e){return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()}},{key:"render",value:function(){var t=this;return React.createElement("div",{ref:function(e){return t.inputGroup=e},className:"input-group input-group-sm input-daterange"},React.createElement("span",{className:"input-group-addon"},React.createElement("strong",null,"Date Range:")),React.createElement("input",{ref:function(e){return t.startDatePicker=e},className:"date-range-input form-control",placeholder:"Start Date",defaultValue:this.props.filters.startDate}),React.createElement("span",{className:"input-group-addon"},React.createElement("strong",null,"to")),React.createElement("input",{ref:function(e){return t.endDatePicker=e},className:"date-range-input form-control",placeholder:"End Date",defaultValue:this.props.filters.endDate}))}}]),t}(React.Component);FlashDealsDateRange.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s)
;if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={toggleFilterList:React.PropTypes.func.isRequired,filters:React.PropTypes.object.isRequired};var FlashDealsFilterBtn=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleShowDropDown=this.handleShowDropDown.bind(this),this.renderFilterBtnClass=this.renderFilterBtnClass.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleShowDropDown",value:function(e){e.preventDefault(),this.props.toggleFilterList()}},{key:"renderFilterBtnClass",value:function(){var e="input-group-addon filter-btn",t=this.props.filters.regionalServiceIds,n=this.props.filters.filterByTodo;return(0<t.length||n)&&(e+=" active"),e}},{key:"render",value:function(){var t=this;return React.createElement("div",{ref:function(e){return t.input=e},className:"input-group filter-btn"},React.createElement("span",{className:this.renderFilterBtnClass()},React.createElement("i",{className:"fa fa-filter"})),React.createElement("button",{type:"button",className:"btn btn-default filter-btn",onClick:this.handleShowDropDown},React.createElement("span",{className:"fa fa-caret-down"})))}}]),t}(React.Component);FlashDealsFilterBtn.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={visible:React.PropTypes.bool.isRequired,allServices:React.PropTypes.array.isRequired,todoItems:React.PropTypes.array.isRequired,setFilter:React.PropTypes.func.isRequired,filters:React.PropTypes.object.isRequired};var FlashDealsFilterList=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.setFilterGroup=this.setFilterGroup.bind(this),this.state={currentFilterGroup:"none"}}return _inherits(t,e),_createClass(t,[{key:"renderClass",value:function(){var e="filter-list-container";return this.props.visible||(e+=" hidden"),e}},{key:"setFilterGroup",value:function(e){this.setState({currentFilterGroup:e})}},{key:"render",value:function(){return React.createElement("div",{className:this.renderClass()},React.createElement("div",{className:"filter-list"},React.createElement(FlashDealsServiceFilterReset,{currentFilterGroup:this.state.currentFilterGroup,setFilterGroup:this.setFilterGroup,setFilter:this.props.setFilter}),React.createElement(FlashDealsServiceFilterTodo,{currentFilterGroup:this.state.currentFilterGroup,setFilterGroup:this.setFilterGroup,todoItems:this.props.todoItems,setFilter:this.props.setFilter,filters:this.props.filters}),React.createElement(FlashDealsServiceFilterServices,{currentFilterGroup:this.state.currentFilterGroup,setFilterGroup:this.setFilterGroup,allServices:this.props.allServices,setFilter:this.props.setFilter,filters:this.props.filters})))}}]),t}(React.Component);FlashDealsFilterList.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={allServices:React.PropTypes.array.isRequired,todoItems:React.PropTypes.array.isRequired,userAddresses:React.PropTypes.array.isRequired,setFilter:React.PropTypes.func.isRequired,filters:React.PropTypes.object.isRequired,userAddress:React.PropTypes.object.isRequired};var FlashDealsFilters=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"flash-deals-filters form"},React.createElement("div",{className:"date-range-container"},React.createElement(FlashDealsDateRange,{setFilter:this.props.setFilter,filters:this.props.filters})),React.createElement("div",{className:"filters-container"},React.createElement(FlashDealsAddressFilter,{userAddresses:this.props.userAddresses,setFilter:this.props.setFilter,filters:this.props.filters}),React.createElement(FlashDealsServiceFilter,{allServices:this.props.allServices,todoItems:this.props.todoItems,setFilter:this.props.setFilter,filters:this.props.filters})))}}]),t}(React.Component);FlashDealsFilters.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={userAddress:React.PropTypes.object.isRequired,deals:React.PropTypes.oneOfType([React.PropTypes.object,React.PropTypes.array]),setActiveDeal:React.PropTypes.func.isRequired,activeDeal:React.PropTypes.string};var FlashDealsMap=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.loadMap=this.loadMap.bind(this),this.centerMarker=this.centerMarker.bind(this),this.renderLocationMarkers=this.renderLocationMarkers.bind(this),this.getCurrentPosition=this.getCurrentPosition.bind(this),this.fitWorld=this.fitWorld.bind(this),this.coordinates=[],this.state={mapCreated:!1}}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.map=this.loadMap(),this.centerPoint=this.centerMarker(),this.map.addLayer(this.centerPoint),this.setState({mapCreated:!0})}},{key:"componentDidUpdate",value:function(){this.map.removeLayer(this.centerPoint),this.centerPoint=this.centerMarker(),this.map.addLayer(this.centerPoint)}},{key:"centerMarker",value:function(){var e=L.AwesomeMarkers.icon({icon:"home",prefix:"fa",markerColor:"orange"});return L.marker(this.getCurrentPosition(),{icon:e})}},{key:"loadMap",value:function(){var e=15,t=L.map(this.mapContainer,{center:this.getCurrentPosition(),zoom:e,minZoom:e-1,maxZoom:e+1,zoomControl:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,zoomDelta:.1,dragging:!1,keyboard:!1,touchZoom:!1});return L.tileLayer("//api.tiles.mapbox.com/v4/mapbox.high-contrast/{z}/{x}/{y}.png?access_token={accessToken}",{attribution:'&copy; <a href="//openstreetmap.org">OpenStreetMap</a> | &copy; <a href="//mapbox.com">Mapbox</a>',accessToken:"pk.eyJ1IjoiamlmZnlvbmRlbWFuZCIsImEiOiJiXzZGQ1o4In0.-cJyN_e12UG_Pjr5qZ7q3A"}).addTo(t),t}},{key:"fitWorld",value:function(e){e.push(this.getCurrentPosition());var t=L.latLngBounds(e);this.map.fitBounds(t,{padding:[60,60],maxZoom:16})}},{key:"getCurrentPosition",value:function(){return[Number(this.props.userAddress.latitude),Number(this.props.userAddress.longitude)]}},{key:"renderLocationMarkers",value:function(){var e=this.props.deals||[],t=[];return this.coordinates=[],e.constructor===Object?t=this.processDealsObject(e):e.constructor===Array&&(t=this.processDealsArray(e)),this.fitWorld(this.coordinates),t}},{key:"processDealsObject",value:function(e){var t=this,n=[];for(var r in e){if(e.hasOwnProperty(r))e[r].map(function(e){t.coordinates.push([Number(e.latitude),Number(e.longitude)]),n.push(t.renderMapMarker(e))})}return n}},{key:"processDealsArray",value:function(e){var t=this;return e.map(function(e){return t.coordinates.push([Number(e.latitude),Number(e.longitude)]),t.renderMapMarker(e)})}},{key:"renderMapMarker",value:function(e){return React.createElement(DealMapMarker,{key:e.id,map:this.map,location:e,activeDeal:this.props.activeDeal})}},{key:"render",value:function(){var t=this,e=null;return this.state.mapCreated&&(e=this.renderLocationMarkers()),React.createElement("div",{ref:function(e){return t.mapContainer=e},id:"map-react"},e)}}]),t}(React.Component);FlashDealsMap.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={allServices:React.PropTypes.array.isRequired,todoItems:React.PropTypes.array.isRequired,setFilter:React.PropTypes.func.isRequired,filters:React.PropTypes.object.isRequired};var FlashDealsServiceFilter=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.showFilterList=this.showFilterList.bind(this),this.hideFilterList=this.hideFilterList.bind(this),this.toggleFilterList=this.toggleFilterList.bind(this),this.state={filterListShow:!1}}return _inherits(t,e),_createClass(t,[{key:"toggleFilterList",value:function(){this.setState({filterListShow:!this.state.filterListShow})}},{key:"showFilterList",value:function(){this.setState({filterListShow:!0})}},{key:"hideFilterList",value:function(){this.setState({filterListShow:!1})}},{key:"render",value:function(){return React.createElement("div",{className:"filter-component"},React.createElement(FlashDealsFilterBtn,{setHeight:this.setFilterBtnHeight,toggleFilterList:this.toggleFilterList,filters:this.props.filters}),React.createElement(FlashDealsFilterList,_extends({visible:this.state.filterListShow},this.props)))}}]),t}(React.Component);FlashDealsServiceFilter.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currentFilterGroup:React.PropTypes.string.isRequired,setFilterGroup:React.PropTypes.func.isRequired,setFilter:React.PropTypes.func.isRequired};var FlashDealsServiceFilterReset=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.groupName="none",this.handleResetFilter=this.handleResetFilter.bind(this),this.selectRadioBox=this.selectRadioBox.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleResetFilter",value:function(){this.resetFilter.checked?(this.props.setFilterGroup(this.groupName),this.props.setFilter({regionalServiceIds:[],filterByTodo:!1})):this.selectRadioBox()}},{key:"selectRadioBox",value:function(){this.resetFilter.checked=!0,this.props.setFilterGroup(this.groupName)}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"filter-group",onClick:this.handleResetFilter},React.createElement("div",{className:"filter-item"},React.createElement("input",{ref:function(e){return t.resetFilter=e},type:"radio",name:"service-filter",defaultChecked:!0,onChange:this.handleResetFilter}),React.createElement("span",{onClick:this.handleResetFilter,className:"filter-item-header"},"NONE")))}}]),t}(React.Component);FlashDealsServiceFilterReset.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currentFilterGroup:React.PropTypes.string.isRequired,setFilterGroup:React.PropTypes.func.isRequired};var FlashDealsServiceFilterServices=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.groupName="services",this.handleServiceFilter=this.handleServiceFilter.bind(this),this.selectRadioBox=this.selectRadioBox.bind(this),this.handleServiceClicked=this.handleServiceClicked.bind(this),this.scanAllCheckboxes=this.scanAllCheckboxes.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleServiceFilter",value:function(){this.serviceFilter.checked?(this.props.setFilterGroup(this.groupName),this.handleServiceClicked()):this.selectRadioBox()}},{key:"handleServiceClicked",value:function(){var e=this.scanAllCheckboxes();this.props.setFilter({regionalServiceIds:e,filterByTodo:!1})}},{key:"scanAllCheckboxes",value:function(){var n=[];return $(this.serviceList).find("input[type='checkbox']").each(function(e,t){t.checked&&n.push(t.value)}),n}},{key:"selectRadioBox",value:function(){this.serviceFilter.checked=!0,this.props.setFilterGroup(this.groupName)}},{key:"renderContentClass",value:function(){var e="group-content hidden";return this.props.currentFilterGroup===this.groupName&&(e="group-content"),e}},{key:"renderServices",value:function(){var n=this,e=this.props.allServices.map(function(e,t){return React.createElement("li",{key:"regional_service-row-"+t},React.createElement("input",{type:"checkbox",value:e.id,onChange:n.handleServiceClicked})," ",e.name)});return React.createElement("ul",{ref:function(e){return n.serviceList=e},className:"service-list list-unstyled"},e)}},{key:"render",value:function(){var t=this;return React.createElement("div",{onClick:this.handleServiceFilter,className:"filter-group"},React.createElement("div",{className:"filter-item"},React.createElement("input",{ref:function(e){return t.serviceFilter=e},type:"radio",name:"service-filter",onChange:this.handleServiceFilter}),React.createElement("span",{onClick:this.handleServiceFilter,className:"filter-item-header"},"Services")),React.createElement("div",{className:this.renderContentClass()},this.renderServices()))}}]),t}(React.Component);FlashDealsServiceFilterServices.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currentFilterGroup:React.PropTypes.string.isRequired,setFilterGroup:React.PropTypes.func.isRequired,todoItems:React.PropTypes.array.isRequired,setFilter:React.PropTypes.func.isRequired};var FlashDealsServiceFilterTodo=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.groupName="todo",this.handleTodoFilter=this.handleTodoFilter.bind(this),this.selectRadioBox=this.selectRadioBox.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleTodoFilter",value:function(){this.todoFilter.checked?(this.props.setFilterGroup(this.groupName),this.props.setFilter({filterByTodo:!0,regionalServiceIds:[]})):this.selectRadioBox()}},{key:"selectRadioBox",value:function(){this.todoFilter.checked=!0,this.props.setFilterGroup(this.groupName)}},{key:"renderContentClass",value:function(){var e="group-content hidden";return this.props.currentFilterGroup===this.groupName&&(e="group-content"),e}},{key:"renderTodoItems",value:function(){var e=this.props.todoItems.map(function(e,t){return React.createElement("li",{key:"todo-item-"+t},React.createElement("span",{className:"badge todo-service-badge"},e.service_name),React.createElement("p",{className:"todo-desc"},e.description))});return React.createElement("ul",{className:"todo-list list-unstyled"},e)}},{key:"render",value:function(){var t=this;return React.createElement("div",{onClick:this.handleTodoFilter,className:"filter-group"},React.createElement("div",{className:"filter-item"},React.createElement("input",{ref:function(e){return t.todoFilter=e},type:"radio",name:"service-filter",onChange:this.handleTodoFilter}),React.createElement("span",{onClick:this.handleTodoFilter,className:"filter-item-header"},"To-Do List")),React.createElement("div",{className:this.renderContentClass()},this.renderTodoItems()))}}]),t}(React.Component);FlashDealsServiceFilterTodo.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={deals:React.PropTypes.oneOfType([React.PropTypes.object,React.PropTypes.array]),setActiveDeal:React.PropTypes.func.isRequired,loading:React.PropTypes.bool.isRequired};var FlashDealsSidebar=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderFlashDeals",value:function(){var e=this.props.deals,t=[];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],a=React.createElement(FlashDealGroup,{key:"deal-group-"+n,header:n,deals:r,setActiveDeal:this.props.setActiveDeal});t.push(a)}return 0<t.length?React.createElement("ul",{className:"flash-deals-list"},t):React.createElement("p",{className:"alert alert-info text-center"},React.createElement("i",null,"No Flash Deals Available"))}},{key:"render",value:function(){var e=null;return e=this.props.loading?React.createElement("p",{className:"alert alert-default text-center"},React.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw"}),React.createElement("br",null),React.createElement("span",null,"Loading...")):this.renderFlashDeals(),React.createElement("div",{className:"flash-deals-sidebar"},e)}}]),t}(React.Component);FlashDealsSidebar.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,displaySuccess:React.PropTypes.bool,label:React.PropTypes.string,inputHTML:React.PropTypes.object,wrapperClass:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string),errors:React.PropTypes.array},defaultProps={validate:[],errors:[]};var contextTypes={update:React.PropTypes.func.isRequired,updateObj:React.PropTypes.func,model:React.PropTypes.object.isRequired,registerValidation:React.PropTypes.func.isRequired,registerInput:React.PropTypes.func.isRequired},Input=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),this.validateInput=this.validateInput.bind(this),this.reset=this.reset.bind(this),this.disable=this.disable.bind(this),this.enable=this.enable.bind(this),this.forceInvalid=this.forceInvalid.bind(this),this.hasError=this.hasError.bind(this),this.hasSuccess=this.hasSuccess.bind(this),this.name=this.props.name,this.state={errors:[],disabled:this.props.disabled||!1,showHint:!0,dirty:!1,valid:!1,forceInvalid:!1}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.removeValidationFromForm=this.context.registerValidation(this.validateInput),this.removeInputFromForm=this.context.registerInput(this)}},{key:"componentWillUnmount",value:function(){this.removeValidationFromForm(),this.removeInputFromForm()}},{key:"onChange",value:function(e){if(this.setState({dirty:!0}),this.props.onChange)this.props.onChange(e);else{var t="checkbox"===e.target.type?e.target.checked:e.target.value;this.context.update(this.props.name,t)}}},{key:"onBlur",value:function(e){this.onChange(e),this.validateInput()}},{key:"validateInput",value:function(){var r=this,e=this.props.validate.reduce(function(e,t){var n=Validators[t](r.context.model[r.props.name],r.props.name);return e.concat(n)},[]);return 0<e.length?this.setState({errors:e,showHint:!1,valid:!1,forceInvalid:!1}):this.setState({errors:e,showHint:!0,valid:!0,forceInvalid:!1}),0===e.length}},{key:"setErrors",value:function(e){this.setState({errors:e,showHint:!1,valid:!1,forceInvalid:!1})}},{key:"forceInvalid",value:function(){this.setState({forceInvalid:!0})}},{key:"reset",value:function(){this.setState({errors:[],showHint:!0,dirty:!1,valid:!1,disabled:!1,forceInvalid:!1})}},{key:"disable",value:function(){this.setState({disabled:!0})}},{key:"enable",value:function(){this.setState({disabled:!1})}},{key:"renderInputId",value:function(){return this.props.id||this.props.name+"-input"}},{key:"renderLabel",value:function(){if(this.props.label&&""!==this.props.label)return React.createElement("label",{htmlFor:this.renderInputId()},this.props.label)}},{key:"renderInput",value:function(){throw"Not Implemented"}},{key:"renderHint",value:function(){if(this.props.hint&&""!==this.props.hint&&this.state.showHint)return React.createElement("p",{className:"help-block"},this.props.hint)}},{key:"renderError",value:function(){if(0<this.state.errors.length)return this.state.errors.map(function(e,t){return React.createElement("p",{className:"help-block",key:t},e)})}},{key:"renderWrapperClasses",value:function(){var e="form-group ";return this.props.wrapperClass&&(e+=this.props.wrapperClass),this.state.forceInvalid?e+" has-error":this.hasError()?e+" has-error":this.hasSuccess()?e+" has-success":e}},{key:"hasError",value:function(){return(0<this.state.errors.length||this.props.errors&&0<this.props.errors.length)&&!this.state.valid&&!this.state.disabled}},{key:"hasSuccess",value:function(){return this.props.displaySuccess&&this.state.dirty&&this.state.valid&&!this.state.disabled}},{key:"render",value:function(){return React.createElement("div",{className:this.renderWrapperClasses()},this.renderLabel(),this.renderInput(),this.renderError(),this.renderHint())}}]),t}(React.Component);Input.propTypes=propTypes,Input.defaultProps=defaultProps,Input.contextTypes=contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,checkboxLabel:React.PropTypes.string,checked:React.PropTypes.bool,inputHTML:React.PropTypes.object,maskPattern:React.PropTypes.string,wrapperClass:React.PropTypes.string,defaultValue:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string)};var CheckboxInput=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.getElement=this.getElement.bind(this)}return _inherits(t,Input),_createClass(t,[{key:"getElement",value:function(){return this.inputElement}},{key:"renderInput",value:function(){var t=this;return React.createElement("label",null,React.createElement("input",_extends({ref:function(e){t.inputElement=e},className:this.props.className,name:this.props.name,checked:this.props.checked,disabled:this.state.disabled,type:"checkbox",id:this.renderInputId(),onChange:this.onChange,onBlur:this.onBlur},this.props.inputHTML)),this.props.checkboxLabel)}}]),t}();CheckboxInput.propTypes=propTypes,CheckboxInput.defaultProps=Input.defaultProps,CheckboxInput.contextTypes=Input.contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,inputHTML:React.PropTypes.object,wrapperClass:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string),collection:React.PropTypes.array.isRequired,selectedValues:React.PropTypes.array.isRequired,valueMethod:React.PropTypes.func,labelMethod:React.PropTypes.func};var CheckboxesGroup=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.processLabelMethod=this.processLabelMethod.bind(this),this.processValueMethod=this.processValueMethod.bind(this),this.processKeysValues=this.processKeysValues.bind(this),this.processCheckedValues=this.processCheckedValues.bind(this),this.keyVals=this.processKeysValues()}return _inherits(t,Input),_createClass(t,[{key:"processValueMethod",value:function(e){return this.props.valueMethod?this.props.valueMethod(e):e.id}},{key:"processLabelMethod",value:function(e){return this.props.labelMethod?this.props.labelMethod(e):e.label}},{key:"processKeysValues",value:function(){var t=this,n={string:null,number:null};return this.props.collection.map(function(e){return typeof e in n?[e,e]:Array.isArray(e)?e:[t.processValueMethod(e),t.processLabelMethod(e)]})}},{key:"processCheckedValues",value:function(e){return-1<this.props.selectedValues.indexOf(e)}},{key:"renderInput",value:function(){var a=this;return this.keyVals.map(function(e){var t=e[0],n=e[1],r=a.processCheckedValues(t);return React.createElement("span",{key:t+"-checkbox",className:"checkbox"},React.createElement("label",null,React.createElement("input",_extends({ref:function(e){a.inputElement=e},className:a.props.className,name:a.props.name,checked:r,type:"checkbox",value:t,id:a.renderInputId(),onChange:a.onChange,onBlur:a.onBlur},a.props.inputHTML)),n))})}}]),t}();CheckboxesGroup.propTypes=propTypes,CheckboxesGroup.defaultProps=Input.defaultProps,CheckboxesGroup.contextTypes=Input.contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,label:React.PropTypes.string,inputHTML:React.PropTypes.object,dateFormat:React.PropTypes.string,wrapperClass:React.PropTypes.string,defaultValue:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string)};var DateInput=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderClassnames=this.renderClassnames.bind(this),this.getElement=this.getElement.bind(this)}return _inherits(t,Input),_createClass(t,[{key:"componentDidMount",value:function(){var t=this;$(this.inputElement).datepicker({format:this.props.dateFormat||"mm/dd/yyyy"}).on("changeDate",function(e){t.onChange(e)})}},{key:"getElement",value:function(){return this.inputElement}},{key:"renderClassnames",value:function(){return this.props.className?this.props.className+" form-control":"form-control"}},{key:"renderInput",value:function(){var t=this;return React.createElement("input",_extends({ref:function(e){t.inputElement=e},className:this.renderClassnames(),placeholder:this.props.placeholder,name:this.props.name,disabled:this.state.disabled,type:"text",id:this.renderInputId(),onChange:this.onChange,onBlur:this.onBlur,defaultValue:this.props.defaultValue},this.props.inputHTML))}}]),t}();DateInput.propTypes=propTypes,DateInput.defaultProps=Input.defaultProps,DateInput.contextTypes=Input.contextTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var FormExample=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.state={}}return _inherits(t,e),_createClass(t,[{key:"handleFormSubmit",value:function(e){console.log(e)}},{key:"render",value:function(){return React.createElement(Form,{onSubmit:this.handleFormSubmit,model:this.model},React.createElement(TextInput,{className:"form-control",name:"name",label:"Name",validate:["required","test"],placeholder:"Name",wrapperClass:"test-class test",inputHTML:{autoComplete:"off"},hint:"Enter your name"}),React.createElement(
SubmitButton,{className:"btn btn-default"},"Save"))}}]),t}(React.Component),childContextTypes=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={model:React.PropTypes.object.isRequired,children:React.PropTypes.node,onSubmit:React.PropTypes.func.isRequired,onValidate:React.PropTypes.func,externalErrors:React.PropTypes.object},{model:React.PropTypes.object,update:React.PropTypes.func,"delete":React.PropTypes.func,updateObj:React.PropTypes.func,submit:React.PropTypes.func,registerValidation:React.PropTypes.func,registerInput:React.PropTypes.func,isFormValid:React.PropTypes.func}),Form=(defaultProps={externalErrors:{}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.submit=this.submit.bind(this),this.update=this.update.bind(this),this["delete"]=this["delete"].bind(this),this.registerValidation=this.registerValidation.bind(this),this.removeValidation=this.removeValidation.bind(this),this.validateForm=this.validateForm.bind(this),this.updateObj=this.updateObj.bind(this),this.registerInput=this.registerInput.bind(this),this.removeInput=this.removeInput.bind(this),this.reset=this.reset.bind(this),this.disableInputs=this.disableInputs.bind(this),this.enableInputs=this.enableInputs.bind(this),this.forceInputsInvalid=this.forceInputsInvalid.bind(this),this.inputs=[],this.validations=[],this.state={defaultModel:Object.assign({},this.props.model),model:Object.assign({},this.props.model)}}return _inherits(t,e),_createClass(t,[{key:"getChildContext",value:function(){return{model:this.state.model,update:this.update,"delete":this["delete"],updateObj:this.updateObj,submit:this.submit,registerValidation:this.registerValidation,registerInput:this.registerInput,isFormValid:this.validateForm}}},{key:"componentWillReceiveProps",value:function(e){var t,n=this;objectsDiffer(this.props.externalErrors,e.externalErrors)&&(t=e.externalErrors,console.log(e.externalErrors),n.inputs.forEach(function(e){t.hasOwnProperty(e.name)&&e.setErrors(t[e.name])}))}},{key:"forceInputsInvalid",value:function(){this.inputs.forEach(function(e){e.forceInvalid()})}},{key:"registerInput",value:function(e){return this.inputs.push(e),this.removeInput.bind(this,this.inputs.length-1)}},{key:"removeInput",value:function(e){this.inputs.splice(e,1)}},{key:"registerValidation",value:function(e){return this.validations.push(e),this.removeValidation.bind(this,this.validations.length-1)}},{key:"removeValidation",value:function(e){this.validations[e]=undefined}},{key:"validateForm",value:function(){var e=this.validations.reduce(function(e,t){return t===undefined?e:t()&&e},!0);return this.props.onValidate&&this.props.onValidate(e),e}},{key:"submit",value:function(e){e&&e.preventDefault(),this.validateForm()&&this.props.onSubmit(this.state.model)}},{key:"disableInputs",value:function(){this.inputs.forEach(function(e){e.disable()})}},{key:"enableInputs",value:function(){this.inputs.forEach(function(e){e.enable()})}},{key:"delete",value:function(e){var t=Object.assign({},this.state.model);delete t[e],this.setState({model:t})}},{key:"update",value:function(e,t){var n=_defineProperty({},e,t);this.setState({model:Object.assign(this.state.model,n)})}},{key:"updateObj",value:function(e){this.setState({model:Object.assign(this.state.model,e)})}},{key:"reset",value:function(){this.formElement.reset(),this.setState({model:Object.assign({},this.state.defaultModel)}),this.inputs.forEach(function(e){return e.reset()})}},{key:"render",value:function(){var t=this;return React.createElement("form",{ref:function(e){t.formElement=e},className:this.props.className,id:this.props.id,role:"form"},this.props.children)}}]),t}(React.Component));Form.propTypes=propTypes,Form.childContextTypes=childContextTypes,Form.defaultProps=defaultProps;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,label:React.PropTypes.string,inputHTML:React.PropTypes.object,maskPattern:React.PropTypes.string,wrapperClass:React.PropTypes.string,defaultValue:React.PropTypes.string,addon:React.PropTypes.string,postAddon:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string),inputType:React.PropTypes.string},defaultProps={inputType:"number"};var NumberInputGroup=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,Input),_createClass(t,[{key:"renderAddon",value:function(){return this.props.addon?React.createElement("span",{className:"input-group-addon"},this.props.addon):null}},{key:"renderPostAddon",value:function(){return this.props.postAddon?React.createElement("span",{className:"input-group-addon"},this.props.postAddon):null}},{key:"renderInput",value:function(){var t=this;return React.createElement("div",{className:"input-group"},this.renderAddon(),React.createElement("input",_extends({ref:function(e){t.inputElement=e},className:"form-control",placeholder:this.props.placeholder,name:this.props.name,disabled:this.state.disabled,type:this.props.inputType,id:this.renderInputId(),onChange:this.onChange,onBlur:this.onBlur,defaultValue:this.props.defaultValue},this.props.inputHTML)),this.renderPostAddon())}}]),t}();NumberInputGroup.propTypes=propTypes,NumberInputGroup.defaultProps=_extends({},Input.defaultProps,defaultProps),NumberInputGroup.contextTypes=Input.contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,label:React.PropTypes.string,inputHTML:React.PropTypes.object,wrapperClass:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string),value:React.PropTypes.string.isRequired,radioLabel:React.PropTypes.string.isRequired,checked:React.PropTypes.bool};var RadioButton=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,Input),_createClass(t,[{key:"componentWillMount",value:function(){_get(Object.getPrototypeOf(t.prototype),"componentWillMount",this).call(this),this.props.checked&&this.context.update(this.props.name,this.props.value)}},{key:"renderInput",value:function(){return React.createElement("div",null,React.createElement("input",_extends({id:this.renderInputId(),name:this.props.name,type:"radio",value:this.props.value,onChange:this.onChange,disabled:this.state.disabled,checked:this.context.model[this.props.name]==this.props.value,defaultChecked:this.props.checked,onBlur:this.onBlur},this.props.inputHTML))," ",this.props.radioLabel)}}]),t}();RadioButton.propTypes=propTypes,RadioButton.defaultProps=Input.defaultProps,RadioButton.contextTypes=Input.contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,includeBlank:React.PropTypes.string,collection:React.PropTypes.array.isRequired,label:React.PropTypes.string,inputHTML:React.PropTypes.object,wrapperClass:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string),valueMethod:React.PropTypes.func,labelMethod:React.PropTypes.func};var SelectInput=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderOptions=this.renderOptions.bind(this),this.processLabelMethod=this.processLabelMethod.bind(this),this.processValueMethod=this.processValueMethod.bind(this),this.processKeysValues=this.processKeysValues.bind(this),this.keyVals=this.processKeysValues()}return _inherits(t,Input),_createClass(t,[{key:"componentWillMount",value:function(){_get(Object.getPrototypeOf(t.prototype),"componentWillMount",this).call(this),this.props.includeBlank||this.context.update(this.props.name,this.keyVals[0][0])}},{key:"processKeysValues",value:function(){var t=this,n={string:null,number:null};return this.props.collection.map(function(e){return typeof e in n?[e,e]:Array.isArray(e)?e:[t.processValueMethod(e),t.processLabelMethod(e)]})}},{key:"processValueMethod",value:function(e){return this.props.valueMethod?this.props.valueMethod(e):e.id}},{key:"processLabelMethod",value:function(e){return this.props.labelMethod?this.props.labelMethod(e):e.label}},{key:"renderOptions",value:function(){var e=this.keyVals.map(function(e){return React.createElement("option",{value:e[0],key:e[0]+"-id"},e[1])});return this.props.includeBlank?[React.createElement("option",{value:"",key:"blank-option-key"},this.props.includeBlank)].concat(e):e}},{key:"renderInput",value:function(){return React.createElement("select",_extends({className:this.props.className+" form-control",placeholder:this.props.placeholder,name:this.props.name,type:"text",id:this.renderInputId(),onChange:this.onChange,onBlur:this.onBlur,disabled:this.state.disabled,defaultValue:this.props.defaultValue},this.props.inputHTML),this.renderOptions())}}]),t}();SelectInput.propTypes=propTypes,SelectInput.defaultProps=Input.defaultProps,SelectInput.contextTypes=Input.contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,collection:React.PropTypes.array.isRequired,label:React.PropTypes.string,inputHTML:React.PropTypes.object,wrapperClass:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string),groupMethod:React.PropTypes.func,groupLabelMethod:React.PropTypes.func,valueMethod:React.PropTypes.func,labelMethod:React.PropTypes.func};var GroupedSelectInput=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderOptions=this.renderOptions.bind(this),this.renderGroupedOptions=this.renderGroupedOptions.bind(this),this.processLabelMethod=this.processLabelMethod.bind(this),this.processValueMethod=this.processValueMethod.bind(this),this.processGroupMethod=this.processGroupMethod.bind(this),this.processGroupLabelMethod=this.processGroupLabelMethod.bind(this),this.processKeysValues=this.processKeysValues.bind(this)}return _inherits(t,Input),_createClass(t,[{key:"processKeysValues",value:function(e){var t=this,n={string:null,number:null};return e.map(function(e){return typeof e in n?[e,e]:Array.isArray(e)?e:[t.processValueMethod(e),t.processLabelMethod(e)]})}},{key:"processValueMethod",value:function(e){return this.props.valueMethod?this.props.valueMethod(e):e.id}},{key:"processLabelMethod",value:function(e){return this.props.labelMethod?this.props.labelMethod(e):e.label}},{key:"processGroupLabelMethod",value:function(e){return this.props.groupLabelMethod?this.props.groupLabelMethod(e):e.label}},{key:"processGroupMethod",value:function(e){return this.props.groupMethod?this.props.groupMethod(e):e.collection}},{key:"renderOptions",value:function(e){var t=this.processGroupMethod(e);return this.processKeysValues(t).map(function(e){return React.createElement("option",{value:e[0],key:e[0]+"-id"},e[1])})}},{key:"renderGroupedOptions",value:function(e){var t=this;return e.map(function(e){return React.createElement("optgroup",{label:t.processGroupLabelMethod(e),key:t.processGroupLabelMethod(e)+"select-group-id"},t.renderOptions(e))})}},{key:"renderInput",value:function(){return React.createElement("select",_extends({className:this.props.className+" form-control",placeholder:this.props.placeholder,name:this.props.name,type:"text",id:this.renderInputId(),onChange:this.onChange,onBlur:this.onBlur,defaultValue:this.props.defaultValue,disabled:this.state.disabled},this.props.inputHTML),this.renderGroupedOptions(this.props.collection))}}]),t}();SelectInput.propTypes=propTypes,SelectInput.defaultProps=Input.defaultProps,SelectInput.contextTypes=Input.contextTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={className:React.PropTypes.string,submitDisabled:React.PropTypes.bool,id:React.PropTypes.string,onMouseDown:React.PropTypes.func,showIndicator:React.PropTypes.bool},defaultProps={submitDisabled:!1,showIndicator:!0},contextTypes={submit:React.PropTypes.func};var SubmitButton=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.loadingSpinner=this.loadingSpinner.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleSubmit",value:function(e){e&&e.preventDefault(),this.props.onMouseDown?this.props.onMouseDown(e,this.context.submit):this.context.submit(e)}},{key:"loadingSpinner",value:function(){if(this.props.submitDisabled&&this.props.showIndicator)return React.createElement("i",{className:"fa fa-spinner fa-pulse fa-fw fa-margin-left"})}},{key:"render",value:function(){return React.createElement("button",{type:"button",className:this.props.className,disabled:this.props.submitDisabled,id:this.props.id,onMouseDown:this.handleSubmit},this.props.children,this.loadingSpinner())}}]),t}(React.Component);SubmitButton.defaultProps=defaultProps,SubmitButton.contextTypes=contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,label:React.PropTypes.string,inputHTML:React.PropTypes.object,maskPattern:React.PropTypes.string,wrapperClass:React.PropTypes.string,defaultValue:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string)};var TextAreaInput=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderClassnames=this.renderClassnames.bind(this),this.getElement=this.getElement.bind(this)}return _inherits(t,Input),_createClass(t,[{key:"getElement",value:function(){return this.inputElement}},{key:"renderClassnames",value:function(){return this.props.className?this.props.className+" form-control":"form-control"}},{key:"renderInput",value:function(){var t=this;return React.createElement("textarea",_extends({ref:function(e){t.inputElement=e},className:this.renderClassnames(),placeholder:this.props.placeholder,name:this.props.name,disabled:this.state.disabled,id:this.renderInputId(),onChange:this.onChange,onBlur:this.onBlur,defaultValue:this.props.defaultValue},this.props.inputHTML))}}]),t}();TextAreaInput.propTypes=propTypes,TextAreaInput.defaultProps=Input.defaultProps,TextAreaInput.contextTypes=Input.contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,label:React.PropTypes.string,inputHTML:React.PropTypes.object,maskPattern:React.PropTypes.string,wrapperClass:React.PropTypes.string,defaultValue:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string)};var TextInput=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderClassnames=this.renderClassnames.bind(this),this.getElement=this.getElement.bind(this)}return _inherits(t,Input),_createClass(t,[{key:"componentDidMount",value:function(){this.props.maskPattern&&$(this.inputElement).mask(this.props.maskPattern)}},{key:"componentWillReceiveProps",value:function(e){e.maskPattern||$(this.inputElement).unmask(),e.maskPattern!==this.props.maskPattern&&$(this.inputElement).mask(e.maskPattern)}},{key:"getElement",value:function(){return this.inputElement}},{key:"renderClassnames",value:function(){return this.props.className?this.props.className+" form-control":"form-control"}},{key:"renderInput",value:function(){var t=this;return React.createElement("input",_extends({ref:function(e){t.inputElement=e},className:this.renderClassnames(),placeholder:this.props.placeholder,name:this.props.name,disabled:this.state.disabled,type:"text",id:this.renderInputId(),onChange:this.onChange,onBlur:this.onBlur,onFocus:this.props.onFocus,defaultValue:this.props.defaultValue},this.props.inputHTML))}}]),t}();TextInput.propTypes=propTypes,TextInput.defaultProps=Input.defaultProps,TextInput.contextTypes=Input.contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,label:React.PropTypes.string,inputHTML:React.PropTypes.object,maskPattern:React.PropTypes.string,wrapperClass:React.PropTypes.string,defaultValue:React.PropTypes.string,validate:React.PropTypes.arrayOf(React.PropTypes.string),addon:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]),postAddon:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object])};var TextInputGroup=function(){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderClassnames=this.renderClassnames.bind(this),this.getElement=this.getElement.bind(this)}return _inherits(t,Input),_createClass(t,[{key:"componentDidMount",value:function(){this.props.maskPattern&&$(this.inputElement).mask(this.props.maskPattern)}},{key:"componentWillReceiveProps",value:function(e){e.maskPattern||$(this.inputElement).unmask(),e.maskPattern!==this.props.maskPattern&&$(this.inputElement).mask(e.maskPattern)}},{key:"getElement",value:function(){return this.inputElement}},{key:"renderClassnames",value:function(){return this.props.className?this.props.className+" form-control":"form-control"}},{key:"renderAddon",value:function(){return this.props.addon?React.createElement("span",{className:"input-group-addon"},this.props.addon):null}},{key:"renderPostAddon",value:function(){return this.props.postAddon?React.createElement("span",{className:"input-group-addon"},this.props.postAddon):null}},{key:"renderInput",value:function(){var t=this;return React.createElement("div",{className:"input-group"},this.renderAddon(),React.createElement("input",_extends({ref:function(e){t.inputElement=e},className:this.renderClassnames(),placeholder:this.props.placeholder,name:this.props.name,disabled:this.state.disabled,type:"text",id:this.renderInputId(),onChange:this.onChange,onBlur:this.onBlur,onFocus:this.props.onFocus,defaultValue:this.props.defaultValue},this.props.inputHTML)),this.renderPostAddon())}}]),t}();TextInputGroup.propTypes=propTypes,TextInputGroup.defaultProps=Input.defaultProps,TextInputGroup.contextTypes=Input.contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,label:React.PropTypes.string,value:React.PropTypes.any,disabled:React.PropTypes.bool,checkboxLabel:React.PropTypes.string,inputHTML:React.PropTypes.object,wrapperClass:React.PropTypes.string};var CheckboxInputV2=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleOnChange=this.handleOnChange.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleOnChange",value:function(e){this.props.onChange&&this.props.onChange(e.target.checked),this.props.setValue(e.target.checked)}},{key:"render",value:function(){return React.createElement(FieldWrapper,{className:this.props.wrapperClass,label:this.props.label,hint:this.props.hint,errors:this.props.errors},React.createElement("span",{className:"checkbox"},React.createElement("label",null,React.createElement("input",_extends({className:this.props.className,ref:this.props.inputRef,name:this.props.name,checked:this.props.value,disabled:this.props.disabled,type:"checkbox",onChange:this.handleOnChange},this.props.inputHTML))," ",this.props.checkboxLabel)))}}]),t}(React.Component);CheckboxInputV2.propTypes=propTypes,CheckboxInputV2=withFormV2(CheckboxInputV2);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={validations:React.PropTypes.array,label:React.PropTypes.string,hint:React.PropTypes.any,wrapperClass:React.PropTypes.string,placeholder:React.PropTypes.string,name:React.PropTypes.string,className:React.PropTypes.string,onChange:React.PropTypes.func,collection:React.PropTypes.array,labelCheckedClass:React.PropTypes.string,disabled:React.PropTypes.bool};var CheckboxesInputV2=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.keysLabels=this.processKeysLabels(),this.handleOnChange=this.handleOnChange.bind(this)}return _inherits(t,e),_createClass(t,[{key:"processKeysLabels",value:function(){var t=this,n={string:null,number:null};return this.props.collection.map(function(e){return typeof e in n?[e,e]:Array.isArray(e)?e:[t.processValueMethod(e),t.processLabelMethod(e)]})}},{key:"processValueMethod",value:function(e){return this.props.valueMethod?this.props.valueMethod(e):e.id}},{key:"processLabelMethod",value:function(e){return this.props.labelMethod?this.props.labelMethod(e):e.label}},{key:"handleOnChange",value:function(e){var t=this.props.value||[];if(e.target.checked)t.push(e.target.value);else{var n=t.indexOf(e.target.value);-1!==n&&t.splice(n,1)}this.props.setValue(t),this.props.onChange&&this.props.onChange(t)}},{key:"renderCheckboxes",value:function(){var a=this;return this.keysLabels.map(function(e){var t=e[0],n=e[1],r=a.isChecked(t);return a.renderCheckbox(n,t,r)})}},{key:"isChecked",value:function(e){var t=this.props.value;return!(!t||!Array.isArray(t))&&-1<t.indexOf(e)}},{key:"renderCheckbox",value:function(e,t,n){return React.createElement("span",{key:t+"-checkbox",className:"checkbox"},React.createElement("label",{className:this.renderLabelCheckedClass(n)},React.createElement("input",{type:"checkbox",value:t,checked:n,onChange:this.handleOnChange,disabled:this.props.disabled}),e))}},{key:"renderLabelCheckedClass",value:function(e){return e?this.props.labelCheckedClass?this.props.labelCheckedClass:"checked":null}},{key:"render",value:function(){return React.createElement(FieldWrapper,{className:this.props.wrapperClass,label:this.props.label,hint:this.props.hint,errors:this.props.errors},this.renderCheckboxes())}}]),t}(React.Component);CheckboxesInputV2.propTypes=propTypes,CheckboxesInputV2=withFormV2(CheckboxesInputV2);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={label:React.PropTypes.string,hint:React.PropTypes.any,errors:React.PropTypes.array,className:React.PropTypes.string};var FieldWrapper=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderLabel",value:function(){if(this.props.label&&""!==this.props.label)return React.createElement("label",null,this.props.label)}},{key:"renderHint",value:function(){var e=this.props,t=e.hint,n=e.errors;return n&&0<n.length?null:t&&""!==t?React.createElement("p",{className:"help-block"},this.props.hint):null}},{key:"renderError",value:function(){var e=this.props.errors;return 0<e.length?e.map(function(e,t){return React.createElement("p",{className:"help-block",key:t},e)}):null}},{key:"renderWrapperClasses",value:function(){var e="",t=this.props,n=t.className,r=t.errors;return e+=n||"form-group",r&&0<r.length?e+" has-error":e}},{key:"render",value:function(){return React.createElement("div",{className:this.renderWrapperClasses()},this.renderLabel(),this.props.children,this.renderError(),this.renderHint())}}]),t}(React.Component);FieldWrapper.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;
){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={onReset:React.PropTypes.func,defaultValues:React.PropTypes.object,submit:React.PropTypes.func.isRequired,externalErrors:React.PropTypes.object},childContextTypes={formV2:React.PropTypes.object},defaultProps={externalErrors:{}};var FormV2=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.registerInput=this.registerInput.bind(this),this.unregisterInput=this.unregisterInput.bind(this),this.validateForm=this.validateForm.bind(this),this.getCurrentValues=this.getCurrentValues.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleFormReset=this.handleFormReset.bind(this),this.inputs=[],this.state={isValid:!0,isSubmitting:!1,canChange:!1,formSubmitted:!1}}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){var n,e=this;isEmptyObject(this.props.defaultValues)||(n=e.props.defaultValues,e.inputs.forEach(function(e){if(n.hasOwnProperty(e.name)){var t=n[e.name];t&&e.setValue(t)}}))}},{key:"componentWillReceiveProps",value:function(e){var t,n,r=this;objectsDiffer(this.props.externalErrors,e.externalErrors)&&(t=e.externalErrors,n=!1,r.inputs.forEach(function(e){t.hasOwnProperty(e.name)&&(e.setErrors(t[e.name]),n=!0)}),n||r.alertGenericErrors(t))}},{key:"alertGenericErrors",value:function(e){for(var t in errorList=[],e)e.hasOwnProperty(t)&&errorList.push(e[t].join(", "));0<errorList.length&&alertify.alert(errorList.join("\n"))}},{key:"getChildContext",value:function(){return{formV2:{registerInput:this.registerInput}}}},{key:"getCurrentValues",value:function(){return this.inputs.reduce(function(e,t){if(t.props.serializable){var n=t.props.name,r=Object.assign({},e);return r[n]=t.state.value,r}return e},{})}},{key:"handleFormReset",value:function(){this.setState({isValid:!0,isSubmitting:!1,canChange:!1,formSubmitted:!1}),this.inputs.forEach(function(e){e.reset()}),this.props.onReset&&this.props.onReset()}},{key:"handleFormSubmit",value:function(e){if(e&&e.preventDefault&&e.preventDefault(),this.validateForm()){var t=this.getCurrentValues();this.props.submit(t)}}},{key:"registerInput",value:function(e){return this.inputs.push(e),this.unregisterInput.bind(this,e)}},{key:"unregisterInput",value:function(e){var t=this.inputs.indexOf(e);-1<t&&this.inputs.splice(t,1)}},{key:"validateForm",value:function(){var e=this.inputs.reduce(function(e,t){return t.validate()&&e},!0);return this.setState({isValid:e}),e}},{key:"reset",value:function(){this.formElement.reset()}},{key:"render",value:function(){var t=this;return React.createElement("form",{ref:function(e){return t.formElement=e},className:this.props.className,id:this.props.id,onReset:this.handleFormReset,onSubmit:this.handleFormSubmit,role:"form"},this.props.children)}}]),t}(React.Component);FormV2.propTypes=propTypes,FormV2.childContextTypes=childContextTypes,FormV2.defaultProps=defaultProps;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var SampleFormV2=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSubmit=this.handleSubmit.bind(this),this.state={errors:{}}}return _inherits(t,e),_createClass(t,[{key:"handleSubmit",value:function(e){var n=this;console.log(e),this.fakePromise()["catch"](function(e){var t=e.responseJSON.errors;n.setState({errors:t})})}},{key:"fakePromise",value:function(){return new Promise(function(e,t){setTimeout(function(){t({responseJSON:{errors:{first_name:["is not valid"],age:["Must be over 18 years old"]}}})},500)})}},{key:"render",value:function(){return React.createElement(FormV2,{className:"form",submit:this.handleSubmit,externalErrors:this.state.errors},React.createElement(TextInputV2,{name:"first_name",label:"First Name",placeholder:"First Name",hint:"Enter your first name",validations:["required"],value:"Default"}),React.createElement(TextInputV2,{name:"last_name",label:"Last Name",placeholder:"Last Name",hint:"Enter your last name",validations:["required"]}),React.createElement(TextInputV2,{name:"age",label:"Age",placeholder:"18...",hint:"Enter your age",validations:["required","numberOnly"]}),React.createElement(SelectInputV2,{name:"gender",label:"Gender",validations:["required"],collection:["Male","Female","Other"],includeBlank:"Select your gender"}),React.createElement(TextAreaInputV2,{name:"bio",placeholder:"Your biography",label:"Biography",hint:"We need your biography"}),React.createElement(CheckboxInputV2,{name:"terms_and_conditions",checkboxLabel:"Terms and Conditions",value:!0}),React.createElement(CheckboxesInputV2,{name:"services",collection:["Service 1","Service 2","Service 3"]}),React.createElement("button",{className:"btn btn-success",type:"submit"},"Save"),React.createElement("button",{className:"btn btn-danger",type:"reset"},"Reset"))}}]),t}(React.Component),SelectInputV2=(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={validations:React.PropTypes.array,label:React.PropTypes.string,hint:React.PropTypes.string,wrapperClass:React.PropTypes.string,name:React.PropTypes.string,className:React.PropTypes.string,onChange:React.PropTypes.func,valueMethod:React.PropTypes.func,labelMethod:React.PropTypes.func,collection:React.PropTypes.array.isRequired,includeBlank:React.PropTypes.string},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleOnChange=this.handleOnChange.bind(this),this.keysLabels=this.processKeysLabels()}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.props.includeBlank||this.props.setValue(this.keysLabels[0][0])}},{key:"handleOnChange",value:function(e){this.props.onChange&&this.props.onChange(e.target.value),this.props.setValue(e.target.value)}},{key:"processKeysLabels",value:function(){var t=this,n={string:null,number:null};return this.props.collection.map(function(e){return typeof e in n?[e,e]:Array.isArray(e)?e:[t.processValueMethod(e),t.processLabelMethod(e)]})}},{key:"processValueMethod",value:function(e){return this.props.valueMethod?this.props.valueMethod(e):e.id}},{key:"processLabelMethod",value:function(e){return this.props.labelMethod?this.props.labelMethod(e):e.label}},{key:"renderOptions",value:function(){var e=this.keysLabels.map(function(e){return React.createElement("option",{value:e[0],key:e[0]+"-id"},e[1])});return this.props.includeBlank?[React.createElement("option",{value:"",key:"blank-option-key"},this.props.includeBlank)].concat(e):e}},{key:"renderClassnames",value:function(){return this.props.className?this.props.className+" form-control":"form-control"}},{key:"render",value:function(){return React.createElement(FieldWrapper,{className:this.props.wrapperClass,label:this.props.label,hint:this.props.hint,errors:this.props.errors},React.createElement("select",_extends({ref:this.props.inputRef,className:this.renderClassnames(),name:this.props.name,value:this.props.value,onChange:this.handleOnChange,disabled:this.props.disabled},this.props.inputHTML),this.renderOptions()))}}]),t}(React.Component));SelectInputV2.propTypes=propTypes,SelectInputV2=withFormV2(SelectInputV2);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={submitDisabled:React.PropTypes.bool,showIndicator:React.PropTypes.bool},defaultProps={submitDisabled:!1,showIndicator:!0};var SubmitButtonV2=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.loadingSpinner=this.loadingSpinner.bind(this)}return _inherits(t,e),_createClass(t,[{key:"loadingSpinner",value:function(){if(this.props.submitDisabled&&this.props.showIndicator)return React.createElement("i",{className:"fa fa-spinner fa-pulse fa-fw fa-margin-left"})}},{key:"render",value:function(){return React.createElement("button",{type:"submit",className:this.props.className,disabled:this.props.submitDisabled,id:this.props.id},this.props.children,this.loadingSpinner())}}]),t}(React.Component);SubmitButtonV2.propTypes=propTypes,SubmitButtonV2.defaultProps=defaultProps;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={validations:React.PropTypes.array,label:React.PropTypes.string,hint:React.PropTypes.string,wrapperClass:React.PropTypes.string,placeholder:React.PropTypes.string,name:React.PropTypes.string,className:React.PropTypes.string,onChange:React.PropTypes.func};var TextAreaInputV2=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleOnChange=this.handleOnChange.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleOnChange",value:function(e){this.props.onChange&&this.props.onChange(e.target.value),this.props.setValue(e.target.value)}},{key:"renderClassnames",value:function(){return this.props.className?this.props.className+" form-control":"form-control"}},{key:"render",value:function(){return React.createElement(FieldWrapper,{className:this.props.wrapperClass,label:this.props.label,hint:this.props.hint,errors:this.props.errors},React.createElement("textarea",_extends({ref:this.props.inputRef,className:this.renderClassnames(),placeholder:this.props.placeholder,name:this.props.name,disabled:this.props.disabled,type:"text",id:this.props.id,value:this.props.value,onChange:this.handleOnChange},this.props.inputHTML)))}}]),t}(React.Component);TextAreaInputV2.propTypes=propTypes,TextAreaInputV2=withFormV2(TextAreaInputV2);_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={name:React.PropTypes.string.isRequired,placeholder:React.PropTypes.string,label:React.PropTypes.string,inputHTML:React.PropTypes.object,wrapperClass:React.PropTypes.string,validations:React.PropTypes.arrayOf(React.PropTypes.string),addon:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]),postAddon:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object])};var TextInputGroupV2=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleOnChange=this.handleOnChange.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleOnChange",value:function(e){this.props.onChange&&this.props.onChange(e.target.value),this.props.setValue(e.target.value)}},{key:"renderClassnames",value:function(){return this.props.className?this.props.className+" form-control":"form-control"}},{key:"renderAddon",value:function(){return this.props.addon?React.createElement("span",{className:"input-group-addon"},this.props.addon):null}},{key:"renderPostAddon",value:function(){return this.props.postAddon?React.createElement("span",{className:"input-group-addon"},this.props.postAddon):null}},{key:"render",value:function(){return React.createElement(FieldWrapper,{className:this.props.wrapperClass,label:this.props.label,hint:this.props.hint,errors:this.props.errors},React.createElement("div",{className:"input-group"},this.renderAddon(),React.createElement("input",_extends({ref:this.props.inputRef,className:this.renderClassnames(),placeholder:this.props.placeholder,name:this.props.name,disabled:this.props.disabled,type:"text",value:this.props.value,onChange:this.handleOnChange},this.props.inputHTML)),this.renderPostAddon()))}}]),t}(React.Component);TextInputGroupV2.propTypes=propTypes,TextInputGroupV2=withFormV2(TextInputGroupV2);_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={validations:React.PropTypes.array,label:React.PropTypes.string,hint:React.PropTypes.string,wrapperClass:React.PropTypes.string,placeholder:React.PropTypes.string,name:React.PropTypes.string,className:React.PropTypes.string,onChange:React.PropTypes.func};var TextInputV2=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleOnChange=this.handleOnChange.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleOnChange",value:function(e){var t=e.target.value;this.props.onChange&&this.props.onChange(t,e),this.props.setValue(t)}},{key:"renderClassnames",value:function(){return this.props.className?this.props.className+" form-control":"form-control"}},{key:"render",value:function(){return React.createElement(FieldWrapper,{className:this.props.wrapperClass,label:this.props.label,hint:this.props.hint,errors:this.props.errors},React.createElement("input",_extends({ref:this.props.inputRef,className:this.renderClassnames(),placeholder:this.props.placeholder,name:this.props.name,disabled:this.props.disabled,type:"text",id:this.props.id,value:this.props.value,onChange:this.handleOnChange,defaultValue:this.props.defaultValue},this.props.inputHTML)))}}]),t}(React.Component);TextInputV2.propTypes=propTypes;var TextInputV2WithMask=withMasking(TextInputV2=withFormV2(TextInputV2)),Validators=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"required",value:function(e){return e?[]:["This field cannot be blank"]}},{key:"shortRequired",value:function(e){return e?[]:["Required"]}},{key:"numberOnly",value:function(e){return isNaN(e)?["Must be a number"]:[]}},{key:"dateFormat",value:function(e){if(e&&""!==e.strip)return"Invalid Date"!==new Date(e).toString()?[]:["Invalid date format"]}},{key:"futureDateOnly",value:function(e){if(e&&""!==e.strip){var t=new Date(e),n=new Date;return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),t.getTime()>=n.getTime()?[]:["Can't be in the past"]}}}]),e}()),IdleTimer=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={idleTime:React.PropTypes.number,onIdle:React.PropTypes.func,onActive:React.PropTypes.func,disableAlert:React.PropTypes.bool},defaultProps={idleTime:1e3,onIdle:function(){},onActive:function(){},disableAlert:!1},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.reset=this.reset.bind(this),this.toggleIdleState=this.toggleIdleState.bind(this),this.state={timeoutId:0,idle:!1}}return _inherits(t,e),_createClass(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.idleTime!==e.idleTime}},{key:"componentDidMount",value:function(){this.bindMultipleEventListeners(document,["mousemove","keydown","wheel","DOMMouseScroll","mousewheel","mousedown"],this.reset),this.reset()}},{key:"toggleIdleState",value:function(){var e=this;this.setState({idle:!this.state.idle},function(){e.state.idle?(e.props.onIdle(),e.props.disableAlert||alertify.alert("You have been idle for too long. Please refresh page to see your updates",function(){location.reload()})):e.props.onActive()})}},{key:"reset",value:function(){var e=this;if(this.state.idle){var t=this.state.timeoutId;0!==t&&clearTimeout(t),t=setTimeout(this.toggleIdleState,this.props.idleTime),this.setState({timeoutId:t,idle:!1},function(){e.props.onActive()})}}},{key:"isIdle",value:function(){return this.state.idle}},{key:"bindMultipleEventListeners",value:function(e,t,n,r){for(var a=function(){n.apply(this,r&&r instanceof Array?r:[])},s=0;s<t.length;s++)e.addEventListener(t[s],a)}},{key:"render",value:function(){return null}}]),t}(React.Component));IdleTimer.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={unit:React.PropTypes.string,unitPrice:React.PropTypes.number,unitPriceString:React.PropTypes.string,currencyString:React.PropTypes.string,quotedJob:React.PropTypes.bool,labourTaxRate:React.PropTypes.string,partsTaxRate:React.PropTypes.string,crudPaths:React.PropTypes.object.isRequired,billingModel:React.PropTypes.object.isRequired,regularJobCashable:React.PropTypes.bool,quotedJobCashable:React.PropTypes.bool};var JobBilling=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.setSubtotal=this.setSubtotal.bind(this),this.switchToSummary=this.switchToSummary.bind(this),this.switchToBillingForm=this.switchToBillingForm.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.calculateSubtotal=this.calculateSubtotal.bind(this),this.state={summary:!1,subtotal:"0.00",unitTotal:"0.00",total:"0.00",labourTax:"0.00",partsTax:"0.00",tax:"0.00",smartDevicesCost:"0.00",billingModel:_extends({},this.props.billingModel)}}return _inherits(t,e),_createClass(t,[{key:"setSubtotal",value:function(e){var t=arguments.length<=0||e===undefined?{}:e;this.setState({subtotal:t.subtotal||"0.00",unitTotal:t.unitTotal||"0.00",total:t.total||"0.00",labourTax:t.labourTax||"0.00",partsTax:t.partsTax||"0.00",tax:t.tax||"0.00",smartDevicesCost:t.smartDevicesCost||"0.00"})}},{key:"switchToSummary",value:function(e){this.setState({summary:!0,billingModel:e})}},{key:"switchToBillingForm",value:function(e){e&&e.preventDefault(),this.setState({summary:!1})}},{key:"handleSubmit",value:function(e,t){var n=$.ajax({url:this.props.crudPaths.finish,type:"PATCH",dataType:"json",data:{job:e}});n.done(function(){location.reload()}),n.fail(function(){alertify.alert("Something went wrong, please contact Jiffy for support!"),t()})}},{key:"calculateSubtotal",value:function(e){var t=this.props.utils.calculateJobTotal(e,this.props.labourTaxRate,this.props.partsTaxRate);this.setSubtotal(t)}},{key:"render",value:function(){return this.state.summary?React.createElement(JobBillingSummary,_extends({},this.props,{subtotal:this.state.subtotal,unitTotal:this.state.unitTotal,total:this.state.total,tax:this.state.tax,labourTax:this.state.labourTax,partsTax:this.state.partsTax,paymentInfo:this.state.billingModel,switchToBillingForm:this.switchToBillingForm,submitBillingInformation:this.handleSubmit,calculateSubtotal:this.calculateSubtotal,smartDevicesCost:this.state.smartDevicesCost,smartDevices:this.props.smartDevices})):React.createElement(JobBillingForm,_extends({},this.props,{calculateSubtotal:this.calculateSubtotal,setSubtotal:this.setSubtotal,subtotal:this.state.subtotal,switchToSummary:this.switchToSummary,billingModel:this.state.billingModel,billingActions:JobBillingPaymentButtons}))}}]),t}(React.Component);JobBilling.propTypes=propTypes,JobBilling=jobBillingUtilities(JobBilling);_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={unit:React.PropTypes.string,unitPrice:React.PropTypes.number,unitPriceString:React.PropTypes.string,currencyString:React.PropTypes.string,quotedJob:React.PropTypes.bool,setSubtotal:React.PropTypes.func,billingModel:React.PropTypes.object.isRequired,calculateSubtotal:React.PropTypes.func.isRequired,submitDisabled:React.PropTypes.bool,billingActions:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]).isRequired};var JobBillingForm=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleBillSubmission=this.handleBillSubmission.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleBillSubmission",value:function(e){this.props.switchToSummary(e)}},{key:"renderPricingInputGroups",value:function(){return this.props.quotedJob?React.createElement(JobBillingQuotedInputs,{currencyString:this.props.currencyString,calculateSubtotal:this.props.calculateSubtotal}):React.createElement(JobBillingUnitInput,{onChange:this.handleUnitChanged,unit:this.props.unit,unitPriceString:this.props.unitPriceString,currencyString:this.props.currencyString,calculateSubtotal:this.props.calculateSubtotal,afterHourBillable:this.props.afterHourBillable})}},{key:"renderJobBillingActions",value:function(){var e=this.props.billingActions;return React.createElement(e,_extends({},this.props,{creditable:this.props.creditable,regularJobCashable:this.props.regularJobCashable,quotedJobCashable:this.props.quotedJobCashable,quotedJob:this.props.quotedJob,submitDisabled:this.props.submitDisabled}))}},{key:"render",value:function(){return React.createElement(Form,{onSubmit:this.handleBillSubmission,model:this.props.billingModel},this.renderPricingInputGroups(),React.createElement("div",{className:"card-body"},React.createElement(TextAreaInput,{name:"notes",label:"Notes for Client",placeholder:"Include a summary of the work that was completed and make note of anything the client should be aware of.",validate:["required"],defaultValue:this.props.billingModel.notes}),React.createElement(TextAreaInput,{name:"jiffy_notes",label:"Notes for Jiffy",placeholder:"Is there anything the Jiffy team should know about this job or client?",defaultValue:this.props.billingModel.jiffy_notes}),React.createElement("div",{id:"estimated-subtotal"},React.createElement("label",null,"Subtotal:"),React.createElement("p",{id:"subtotal"},React.createElement("b",null,"$ ",this.props.subtotal)))),React.createElement("div",{className:"card-footer"},this.renderJobBillingActions()))}}]),t}(React.Component);JobBillingForm.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={creditable:React.PropTypes.bool.isRequired,regularJobCashable:React.PropTypes.bool,quotedJob:React.PropTypes.bool.isRequired},contextTypes={update:React.PropTypes.func.isRequired};var JobBillingPaymentButtons=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleChargeCredit=this.handleChargeCredit.bind(this),this.handleRecordCash=this.handleRecordCash.bind(this),this.renderBtns=this.renderBtns.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleChargeCredit",value:function(e,t){e.preventDefault(),this.context.update("payment_method","credit_card"),t()}},{key:"handleRecordCash",value:function(e,t){e.preventDefault(),this.context.update("payment_method","cash"),t()}},{key:"renderCreditBtn",value:function(e){var t=e?"card-md-12":"card-md-6";return React.createElement("div",{key:"job-billing-credit-btn",className:t},React.createElement(SubmitButton,{className:"button button-success button-block button-lg",onMouseDown:this.handleChargeCredit},"Charge Credit Card"))}},{key:"renderCashBtn",value:function(e){var t=e?"card-md-12":"card-md-6";return React.createElement("div",{key:"job-billing-cash-btn",className:t},React.createElement(SubmitButton,{className:"button button-success button-block button-lg",onMouseDown:this.handleRecordCash},"Record Direct Payment"))}},{key:"renderDisabledPaymentBtn",value:function(){return React.createElement("div",{className:"card-md-12"},React.createElement("button",{className:"button button-danger button-block disabled button-lg",disabled:!0},"User doesn't have credit card"))}},{key:"renderBtns",value:function(){return this.props.quotedJob?this.props.creditable?[this.renderCashBtn(!1),this.renderCreditBtn(!1)]:this.renderCashBtn(!0):this.props.creditable?this.props.regularJobCashable?[this.renderCashBtn(!1),this.renderCreditBtn(!1)]:this.renderCreditBtn(!0):this.props.regularJobCashable?this.renderCashBtn(!0):this.renderDisabledPaymentBtn()}},{key:"render",value:function(){return React.createElement("div",{className:"card-row"},this.renderBtns())}}]),t}(React.Component);JobBillingPaymentButtons.contextTypes=contextTypes,JobBillingPaymentButtons.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currencyString:React.PropTypes.string},defaultProps={currencyString:"CAD"},contextTypes={model:React.PropTypes.object.isRequired,update:React.PropTypes.func.isRequired};var JobBillingQuotedInputs=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleInputChanged=this.handleInputChanged.bind(this),this.additionalNotesValidation=this.additionalNotesValidation.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.props.calculateSubtotal(this.context.model),Validators.additionalNotesValidation=this.additionalNotesValidation}},{key:"additionalNotesValidation",value:function(){var e=this.context.model.additional_cost,t=this.context.model.additional_notes;return 0<Number(e)&&!t?["Must leave notes for additional cost charges"]:[]}},{key:"handleInputChanged",value:function(e,t){var n="checkbox"===e.target.type?e.target.checked:e.target.value;this.context.update(t,n),this.props.calculateSubtotal(this.context.model)}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"card-body"},React.createElement(NumberInputGroup,{name:"quoted_cost",label:"Labor Cost",placeholder:"0.00",validate:["required","numberOnly"],addon:"$",inputType:"text",defaultValue:this.context.model.quoted_cost,postAddon:this.props.currencyString,onChange:function(e){return t.handleInputChanged(e,"quoted_cost")}}),React.createElement(NumberInputGroup,{
name:"additional_cost",label:"Parts Cost",placeholder:"0.00",addon:"$",validate:["numberOnly"],postAddon:this.props.currencyString,onChange:function(e){return t.handleInputChanged(e,"additional_cost")},defaultValue:this.context.model.additional_cost,inputType:"text"}),React.createElement(TextAreaInput,{name:"additional_notes",label:"Notes for Parts",placeholder:"If you are charging for any parts, list those items here.",defaultValue:this.context.model.additional_notes,validate:["additionalNotesValidation"]}))}}]),t}(React.Component);JobBillingQuotedInputs.propTypes=propTypes,JobBillingQuotedInputs.defaultProps=defaultProps,JobBillingQuotedInputs.contextTypes=contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={subtotal:React.PropTypes.string.isRequired,paymentInfo:React.PropTypes.object.isRequired,switchToBillingForm:React.PropTypes.func,submitBillingInformation:React.PropTypes.func.isRequired,calculateSubtotal:React.PropTypes.func.isRequired};var JobBillingSummary=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleProceed=this.handleProceed.bind(this),this.disableProceed=this.disableProceed.bind(this),this.enableProceed=this.enableProceed.bind(this),this.renderPaymentMethodText=this.renderPaymentMethodText.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.props.calculateSubtotal(this.props.paymentInfo)}},{key:"handleProceed",value:function(e){e.preventDefault();var t=this.props.paymentInfo,n=this.enableProceed;this.disableProceed(),this.props.submitBillingInformation(t,n)}},{key:"disableProceed",value:function(){this.proceedBtn.classList.contains("disabled")||(this.proceedBtn.classList.add("disabled"),$(this.proceedBtn).off(),$(this.proceedBtn).on("click",function(e){return e.preventDefault(),e.stopPropagation(),!1}))}},{key:"enableProceed",value:function(){this.proceedBtn.classList.contains("disabled")&&(this.proceedBtn.classList.remove("disabled"),$(this.proceedBtn).on("click",this.handleProceed))}},{key:"renderPaymentMethodText",value:function(){return"credit_card"===this.props.paymentInfo.payment_method?"Credit Card":"Cash"}},{key:"renderSummaryTable",value:function(){return this.props.quotedJob?React.createElement(JobBillingSummaryQuote,_extends({},this.props,{renderPaymentMethodText:this.renderPaymentMethodText})):React.createElement(JobBillingSummaryUnit,_extends({},this.props,{renderPaymentMethodText:this.renderPaymentMethodText}))}},{key:"render",value:function(){var t=this;return React.createElement("div",null,React.createElement("div",{className:"card-body flush"},React.createElement("p",{className:"alert alert-info"},"Please review payment information")),React.createElement("div",{className:"card-body flush"},this.renderSummaryTable()),React.createElement("div",{className:"card-footer"},React.createElement("div",{className:"card-row"},React.createElement("div",{className:"text-left card-sm-6"},React.createElement("a",{href:"",onClick:this.props.switchToBillingForm},"Edit")),React.createElement("div",{className:"text-right card-sm-6"},React.createElement("a",{ref:function(e){return t.proceedBtn=e},href:"",className:"button button-success",onClick:this.handleProceed},"Proceed")))))}}]),t}(React.Component);JobBillingSummary.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var JobBillingSummaryFooter=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderAfterHours",value:function(){return this.props.paymentInfo.after_hours_billed?"Yes":"No"}},{key:"renderAfterHoursRow",value:function(){return this.props.quotedJob?null:React.createElement("tr",null,React.createElement("td",{colSpan:this.props.columns},React.createElement("div",{className:"pull-left"},React.createElement("strong",null,"After hours?")),React.createElement("div",{className:"pull-right"},this.renderAfterHours())))}},{key:"renderAddtionalNotesRow",value:function(){return this.props.quotedJob?null:React.createElement("tr",{key:"additional-note-label"},React.createElement("td",{colSpan:this.props.columns},React.createElement("strong",null,"Addditional notes"),React.createElement("p",null,this.props.paymentInfo.additional_notes)))}},{key:"render",value:function(){return React.createElement("tfoot",null,this.renderAfterHoursRow(),this.renderAddtionalNotesRow(),React.createElement("tr",null,React.createElement("td",{colSpan:this.props.columns},React.createElement("strong",null,"Notes for Client"),React.createElement("p",null,this.props.paymentInfo.notes))),React.createElement("tr",null,React.createElement("td",{colSpan:this.props.columns},React.createElement("strong",null,"Notes for Jiffy"),React.createElement("p",null,this.props.paymentInfo.jiffy_notes))))}}]),t}(React.Component),JobBillingSummaryQuote=(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderTax",value:function(){if(this.props.labourTaxRate===this.props.partsTaxRate)return React.createElement("tr",null,React.createElement("td",{colSpan:"2",className:"text-right"},React.createElement("strong",null,"Tax (",100*this.props.labourTaxRate,"%)")),React.createElement("td",null,"$",this.props.tax))}},{key:"renderLabourTax",value:function(){if(this.props.labourTaxRate!==this.props.partsTaxRate)return this.props.labourTax&&"0.00"!==this.props.labourTax?React.createElement("tr",null,React.createElement("td",{colSpan:"2",className:"text-right"},React.createElement("strong",null,"Tax - Labour(",100*this.props.labourTaxRate,"%)")),React.createElement("td",null,"$",this.props.labourTax)):null}},{key:"renderPartsTax",value:function(){if(this.props.labourTaxRate!==this.props.partsTaxRate)return this.props.partsTax&&"0.00"!==this.props.partsTax?React.createElement("tr",null,React.createElement("td",{colSpan:"2",className:"text-right"},React.createElement("strong",null,"Tax - Parts (",100*this.props.partsTaxRate,"%)")),React.createElement("td",null,"$",this.props.partsTax)):null}},{key:"render",value:function(){return React.createElement("table",{className:"table table-responsive"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Service"),React.createElement("th",null,"Quoted Amount"),React.createElement("th",null,"Actual Cost"))),React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",null,this.props.serviceName),React.createElement("td",null,"$",this.props.quotedAmount/100),React.createElement("td",null,"$",this.props.unitTotal)),React.createElement("tr",null,React.createElement("td",{colSpan:"2",className:"text-right"},React.createElement("strong",null,"Parts Cost")),React.createElement("td",null,"$",this.props.paymentInfo.additional_cost)),React.createElement("tr",null,React.createElement("td",{colSpan:"2",className:"text-right"},React.createElement("strong",null,"Subtotal")),React.createElement("td",null,"$",this.props.subtotal)),this.renderTax(),this.renderLabourTax(),this.renderPartsTax(),React.createElement("tr",null,React.createElement("td",{colSpan:"2",className:"text-right"},React.createElement("strong",null,"Total")),React.createElement("td",null,"$",this.props.total)),React.createElement("tr",null,React.createElement("td",{colSpan:"3"},React.createElement("strong",null,"Payment Method: "),this.props.renderPaymentMethodText()))),React.createElement(JobBillingSummaryFooter,_extends({},this.props,{columns:"3"})))}}]),t}(React.Component)),JobBillingSummaryUnit=(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderTax",value:function(){if(this.props.labourTaxRate===this.props.partsTaxRate)return React.createElement("tr",null,React.createElement("td",{colSpan:"3",className:"text-right"},React.createElement("strong",null,"Tax (",100*this.props.labourTaxRate,"%)")),React.createElement("td",null,"$",this.props.tax))}},{key:"renderLabourTax",value:function(){if(this.props.labourTaxRate!==this.props.partsTaxRate)return this.props.labourTax&&"0.00"!==this.props.labourTax?React.createElement("tr",null,React.createElement("td",{colSpan:"3",className:"text-right"},React.createElement("strong",null,"Tax - Labour (",100*this.props.labourTaxRate,"%)")),React.createElement("td",null,"$",this.props.labourTax)):null}},{key:"renderPartsTax",value:function(){if(this.props.labourTaxRate!==this.props.partsTaxRate)return this.props.partsTax&&"0.00"!==this.props.partsTax?React.createElement("tr",null,React.createElement("td",{colSpan:"3",className:"text-right"},React.createElement("strong",null,"Tax - Parts (",100*this.props.partsTaxRate,"%)")),React.createElement("td",null,"$",this.props.partsTax)):null}},{key:"renderSmartDevicesCost",value:function(){var e=this.props.smartDevices;return e&&0<e.length?React.createElement("tr",null,React.createElement("td",{className:"text-right",colSpan:"3"},React.createElement("strong",null,"Smart Devices Cost")),React.createElement("td",null,"$",this.props.smartDevicesCost||"0.00")):null}},{key:"render",value:function(){return React.createElement("table",{className:"table table-responsive"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Quantity"),React.createElement("th",null,"Unit Price"),React.createElement("th",null,"Minimum Charge"),React.createElement("th",null,"Total"))),React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",null,this.props.paymentInfo.units_billed),React.createElement("td",null,this.props.unit),React.createElement("td",null,currencyFormat(this.props.paymentInfo.minimum_charge_cents,this.props.currencyString)),React.createElement("td",null,"$",this.props.unitTotal)),React.createElement("tr",null,React.createElement("td",{className:"text-right",colSpan:"3"},React.createElement("strong",null,"Additional Cost")),React.createElement("td",null,"$",this.props.paymentInfo.additional_cost||"0.00")),this.renderSmartDevicesCost(),React.createElement("tr",null,React.createElement("td",{className:"text-right",colSpan:"3"},React.createElement("strong",null,"Subtotal")),React.createElement("td",null,"$",this.props.subtotal)),this.renderTax(),this.renderLabourTax(),this.renderPartsTax(),React.createElement("tr",null,React.createElement("td",{className:"text-right",colSpan:"3"},React.createElement("strong",null,"Total")),React.createElement("td",null,"$",this.props.total)),React.createElement("tr",null,React.createElement("td",{colSpan:"4"},React.createElement("div",{className:"pull-left"},React.createElement("strong",null,"Payment method")),React.createElement("div",{className:"pull-right"},this.props.renderPaymentMethodText())))),React.createElement(JobBillingSummaryFooter,_extends({},this.props,{columns:"4"})))}}]),t}(React.Component)),JobBillingUnitInput=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={unit:React.PropTypes.string,unitPriceString:React.PropTypes.string,calculateSubtotal:React.PropTypes.func},defaultProps={unit:"Unit",unitPriceString:"$0"},contextTypes={model:React.PropTypes.object.isRequired,update:React.PropTypes.func.isRequired},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleInputChanged=this.handleInputChanged.bind(this),this.additionalNotesValidation=this.additionalNotesValidation.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){Validators.additionalNotesValidation=this.additionalNotesValidation}},{key:"additionalNotesValidation",value:function(){var e=this.context.model.additional_cost,t=this.context.model.additional_notes;return 0<Number(e)&&!t?["Must leave notes for additional cost charges"]:[]}},{key:"componentDidMount",value:function(){this.props.calculateSubtotal(this.context.model)}},{key:"handleInputChanged",value:function(e,t){var n="checkbox"===e.target.type?e.target.checked:e.target.value;this.context.update(t,n),this.props.calculateSubtotal(this.context.model)}},{key:"renderAfterHourCheckbox",value:function(){var t=this;return this.props.afterHourBillable?React.createElement(CheckboxInput,{name:"after_hours_billed",checkboxLabel:" After hours?",onChange:function(e){return t.handleInputChanged(e,"after_hours_billed")},checked:this.context.model.after_hours_billed}):null}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"card-body"},React.createElement(NumberInputGroup,{name:"units_billed",label:this.props.unit+" billed",placeholder:"0.00",onChange:function(e){return t.handleInputChanged(e,"units_billed")},validate:["required","numberOnly"],postAddon:"x"+this.props.unitPriceString,defaultValue:this.context.model.units_billed,inputType:"text"}),this.renderAfterHourCheckbox(),React.createElement(NumberInputGroup,{name:"additional_cost",label:"Additional cost",placeholder:"0.00",addon:"$",validate:["numberOnly"],postAddon:this.props.currencyString,onChange:function(e){return t.handleInputChanged(e,"additional_cost")},defaultValue:this.context.model.additional_cost,inputType:"text"}),React.createElement(TextAreaInput,{name:"additional_notes",label:"Additional notes",placeholder:"If you are charging for any 'Additional cost', list those items here.",defaultValue:this.context.model.additional_notes,validate:["additionalNotesValidation"]}))}}]),t}(React.Component));JobBillingUnitInput.propTypes=propTypes,JobBillingUnitInput.defaultProps=defaultProps,JobBillingUnitInput.contextTypes=contextTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={unit:React.PropTypes.string,unitPrice:React.PropTypes.number,unitPriceString:React.PropTypes.string,currencyString:React.PropTypes.string,quotedJob:React.PropTypes.bool,labourTaxRate:React.PropTypes.string,partsTaxRate:React.PropTypes.string,crudPaths:React.PropTypes.object.isRequired,billingModel:React.PropTypes.object.isRequired,serviceName:React.PropTypes.string,afterHourBillable:React.PropTypes.bool};var JobBillingAmend=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.enableEdit=this.enableEdit.bind(this),this.calculateJobTotal=this.calculateJobTotal.bind(this),this.disableEdit=this.disableEdit.bind(this),this.resetBillingInformation=this.resetBillingInformation.bind(this),this.state={editable:!1,subtotal:"0.00",unitTotal:"0.00",total:"0.00",labourTax:"0.00",partsTax:"0.00",tax:"0.00",smartDevicesCost:"0.00",billingModel:_extends({},this.props.billingModel)}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.calculateJobTotal(this.state.billingModel)}},{key:"calculateJobTotal",value:function(e){var t=this.props.utils.calculateJobTotal(e,this.props.labourTaxRate,this.props.partsTaxRate);this.setState(t)}},{key:"enableEdit",value:function(){this.setState({editable:!0}),$("#charge-btn").hide()}},{key:"disableEdit",value:function(){this.resetBillingInformation(),this.setState({editable:!1}),$("#charge-btn").show()}},{key:"resetBillingInformation",value:function(){var e=this.props.billingModel,t=this.calculateJobTotal(e);this.setState(_extends({},t,{billingModel:_extends({},this.props.billingModel)}))}},{key:"setSubtotal",value:function(e){var t=arguments.length<=0||e===undefined?{}:e;this.setState({subtotal:t.subtotal||"0.00",unitTotal:t.unitTotal||"0.00",total:t.total||"0.00",labourTax:t.labourTax||"0.00",partsTax:t.partsTax||"0.00",tax:t.tax||"0.00",smartDevicesCost:t.smartDevicesCost||"0.00"})}},{key:"render",value:function(){return this.state.editable?React.createElement(JobBillingAmendForm,_extends({},this.props,{disableEdit:this.disableEdit,setSubtotal:this.setSubtotal,subtotal:this.state.subtotal,billingModel:this.state.billingModel,billingActions:JobBillingAmendActions,calculateJobTotal:this.calculateJobTotal,disableEdit:this.disableEdit,smartDevicesCost:this.state.smartDevicesCost})):React.createElement(JobBillingAmendSummary,_extends({},this.props,{subtotal:this.state.subtotal,unitTotal:this.state.unitTotal,total:this.state.total,tax:this.state.tax,labourTax:this.state.labourTax,partsTax:this.state.partsTax,paymentInfo:this.state.billingModel,calculateJobTotal:this.calculateJobTotal,enableEdit:this.enableEdit,smartDevicesCost:this.state.smartDevicesCost}))}}]),t}(React.Component);JobBillingAmend.propTypes=propTypes,JobBillingAmend=jobBillingUtilities(JobBillingAmend);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={submitDisabled:React.PropTypes.bool};var JobBillingAmendActions=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"card-md-12"},React.createElement(SubmitButton,{className:"button button-default button-block button-lg",submitDisabled:this.props.submitDisabled},"Save"))}}]),t}(React.Component);JobBillingAmendActions.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={calculateJobTotal:React.PropTypes.func.isRequired,unit:React.PropTypes.string,unitPrice:React.PropTypes.number,unitPriceString:React.PropTypes.string,currencyString:React.PropTypes.string,quotedJob:React.PropTypes.bool,setSubtotal:React.PropTypes.func,billingModel:React.PropTypes.object.isRequired,crudPaths:React.PropTypes.object.isRequired,disableEdit:React.PropTypes.func.isRequired,billingActions:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]).isRequired};var JobBillingAmendForm=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this),this.state={submitDisabled:!1}}return _inherits(t,e),_createClass(t,[{key:"handleFormSubmit",value:function(t){var n=this;alertify.confirm("Are you sure you want to modify payment information for this job?",function(){n.setState({submitDisabled:!0});var e=$.ajax({url:n.props.crudPaths.amend,method:"PATCH",type:"JSON",data:{job:t}});e.done(function(){location.reload()}),e.fail(function(){n.setState({submitDisabled:!1},function(){alertify.alert("Couldn't change payment information, please contact admin for details")})})},function(){})}},{key:"handleCancel",value:function(){this.props.disableEdit()}},{key:"render",value:function(){return React.createElement("div",null,React.createElement(JobBillingForm,_extends({},this.props,{switchToSummary:this.handleFormSubmit,calculateSubtotal:this.props.calculateJobTotal,submitDisabled:this.state.submitDisabled})),React.createElement("div",{className:"card-footer"},React.createElement("a",{className:"button button-danger button-block",href:"#",onClick:this.handleCancel},"Cancel")))}}]),t}(React.Component);JobBillingAmendForm.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var props={enableEdit:React.PropTypes.func.isRequired,paymentInfo:React.PropTypes.object.isRequired,subtotal:React.PropTypes.string.isRequired,calculateJobTotal:React.PropTypes.func.isRequired},JobBillingAmendSummary=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderPaymentMethodText=this.renderPaymentMethodText.bind(this),this.handleEditClicked=this.handleEditClicked.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleEditClicked",value:function(e){e.preventDefault(),this.props.enableEdit()}},{key:"renderPaymentMethodText",value:function(){return"credit_card"===this.props.paymentInfo.payment_method?"Credit Card":"Cash"}},{key:"renderSummaryTable",value:function(){return this.props.quotedJob?React.createElement(JobBillingSummaryQuote,_extends({},this.props,{renderPaymentMethodText:this.renderPaymentMethodText})):React.createElement(JobBillingSummaryUnit,_extends({},this.props,{renderPaymentMethodText:this.renderPaymentMethodText}))}},{key:"render",value:function(){return React.createElement("div",null,React.createElement("div",{className:"card-body flush"},React.createElement("p",{className:"alert alert-info"},"Please review payment information")),React.createElement("div",{className:"card-body flush"},this.renderSummaryTable()),React.createElement("div",{className:"card-footer"},React.createElement("div",{className:"card-row"},React.createElement("div",{className:"card-sm-12"},React.createElement("a",{href:"",onClick:this.handleEditClicked},"Edit")))))}}]),t}(React.Component),JobCCPanel=(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},props={lockIcon:React.PropTypes.string,checkIcon:React.PropTypes.string},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleCreateCard=this.handleCreateCard.bind(this),this.renderInfoMessage=this.renderInfoMessage.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.showOverlay(),this.disableConfirm()}},{key:"handleCreateCard",value:function(e){$(this.cardPanel).slideUp(),this.hideOverlay(),this.enableConfirm(),this.showCardDetails(e)}},{key:"showOverlay",value:function(){var e=$("#confirm-form");if(0<e.length)return e.addClass("show-overlay")}},{key:"hideOverlay",value:function(){var e=$("#confirm-form");if(0<e.length)return e.removeClass("show-overlay")}},{key:"showCardDetails",value:function(e){var t=$("#payment-details-panel");0<t.length&&(t.find("#card-type-field").text(e.brand),t.find("#card-number-field").text("****/"+e.last_four),t.find("#expiry-date-field").text(e.exp_month+"/"+e.exp_year),t.removeClass("hidden"))}},{key:"preventSubmit",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"disableConfirm",value:function(){var e=$("#confirm-job");e.addClass("disabled"),e.on("click",this.preventSubmit)}},{key:"enableConfirm",value:function(){var e=$("#confirm-job");e.removeClass("disabled"),e.off()}},{key:"renderInfoMessage",value:function(){if(this.props.job)return React.createElement("p",null,"Before we can continue, we need a credit card on file. You will ",React.createElement("strong",null,"not")," be charged until the job is completed by your professional.")}},{key:"render",value:function(){var t=this;return React.createElement("div",{ref:function(e){t.cardPanel=e},className:"job-details-form"},React.createElement("h3",{className:"form-title"},"Payment Details"),this.renderInfoMessage(),React.createElement(CCSatisfactionList,{lockIcon:this.props.lockIcon,checkIcon:this.props.checkIcon}),React.createElement(CardForm,_extends({},this.props,{onCreateCard:this.handleCreateCard})))}}]),t}(React.Component)),JobEtaField=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={inputId:React.PropTypes.string,timeInputId:React.PropTypes.string,label:React.PropTypes.string,name:React.PropTypes.string,timeInputName:React.PropTypes.string,strict:React.PropTypes.bool,timeLabel:React.PropTypes.string,timeRanges:React.PropTypes.array},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.filterDates=this.filterDates.bind(this),this.handleChangeDate=this.handleChangeDate.bind(this),this.state=this.initialState()}return _inherits(t,e),_createClass(t,[{key:"initialState",value:function(){var t={},e=this.selectStartDate();if(this.props.timeRanges.forEach(function(e){t[e.requested_for]=e.time_periods}),e){var n=this.formatDate(e);if(t[n]&&0<t[n].length)return{date:e,periods:t[n],strict:this.props.strict,dateRequests:t}}return{date:"",periods:this.props.allTimes,strict:!1,dateRequests:t}}},{key:"formatDate",value:function(e){return e||(e=new Date),e.getFullYear()+"-"+zeroPad(e.getMonth()+1)+"-"+zeroPad(e.getDate())}},{key:"selectStartDate",value:function(){for(var e=this.props.timeRanges,t=null,n=0,r=e.length;n<r;n++){var a=e[n],s=parseDateString(a.requested_for,"-"),i=new Date;i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),s.getTime()>=i.getTime()&&(t=t?t.getTime()>s.getTime()?s:t:s)}return t}},{key:"componentDidMount",value:function(){var e=parseDateString(this.state.date,"-"),t=$(this.dateInput).datepicker({autoclose:!0,startDate:e,endDate:"+120d",beforeShowDay:this.filterDates});t.datepicker("setDate",e),t.on("changeDate",this.handleChangeDate)}},{key:"filterDates",value:function(e){if(this.state.strict){var t=this.formatDate(e);return!!this.state.dateRequests[t]}return!0}},{key:"handleChangeDate",value:function(e){var t=e.date,n=this.formatDate(t),r=this.state.dateRequests[n];this.setState({date:t,periods:r||this.props.allTimes})}},{key:"renderTimeOptions",value:function(){var e=this.state;e.date;return e.periods.map(function(e){return React.createElement("option",{value:e[0],key:e[0]+"-time"},e[1])})}},{key:"render",value:function(){var t=this;return React.createElement("div",null,React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:this.props.inputId||"eta-date"},this.props.label),React.createElement("input",{ref:function(e){return t.dateInput=e},className:"form-control",id:this.props.inputId||"eta-date",required:!0,type:"text",name:this.props.name,onChange:this.handleChangeDate,value:this.state.date})),React.createElement("div",{
className:"form-group"},React.createElement("label",{htmlFor:this.props.timeInputId||"eta-time"},this.props.timeLabel),React.createElement("select",{className:"form-control",name:this.props.timeInputName,id:this.props.timeInputId||"eta-time",required:!0},this.renderTimeOptions())))}}]),t}(React.Component));JobEtaField.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={index:React.PropTypes.number,data:React.PropTypes.object,disableDateInput:React.PropTypes.bool,removeDateRequest:React.PropTypes.func,resetDateRequestAtIndex:React.PropTypes.func,collection:React.PropTypes.array,afterHours:React.PropTypes.bool,flashDeals:React.PropTypes.object,holidays:React.PropTypes.array,isFlashDeal:React.PropTypes.func,selectedDateRequests:React.PropTypes.array};var DateRequest=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSelectPeriods=this.handleSelectPeriods.bind(this),this.handleRemoveDate=this.handleRemoveDate.bind(this),this.handleDateChanged=this.handleDateChanged.bind(this),this.setDate=this.setDate.bind(this),this.checkNow=this.checkNow.bind(this),this.checkDateAndPeriods=this.checkDateAndPeriods.bind(this),this.renderCalendarDate=this.renderCalendarDate.bind(this),this.checkHoliday=this.checkHoliday.bind(this),this.state={afterHours:!1}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.checkNow()}},{key:"componentDidUpdate",value:function(e){isSame(this.props.flashDeals,e.flashDeals)||this.calendarInstance&&this.calendarInstance.redraw()}},{key:"componentDidMount",value:function(){this.props.disableDateInput||(this.calendarInstance=flatpickr(this.dateInput,{minDate:new Date,dateFormat:"m/d/Y",disableMobile:!0,onChange:this.handleDateChanged,onDayCreate:this.renderCalendarDate}))}},{key:"handleSelectPeriods",value:function(e){var t=this.props.value,n=Object.assign({},t,{time_periods:e,index:this.props.index});this.props.setValue(n),this.props.onChange&&this.props.onChange(n),this.checkDateAndPeriods(t.requested_for,e)}},{key:"handleDateChanged",value:function(e,t){var n=FlatpickrInstance.prototype.parseDate(t,"m/d/Y"),r=this.props.value;this.validateUniqueDate(n)?(this.setDate(n),this.dateInputComponent.setValue(this.formatDate(n)),this.checkDateAndPeriods(n,r.time_periods)):(this.handleResetDateRequest(),alertify.alert("You have already selected this date"))}},{key:"handleResetDateRequest",value:function(){this.props.selectedDateRequests.length<2||(this.dateInputComponent.reset(),this.props.resetDateRequestAtIndex&&this.props.resetDateRequestAtIndex(this.props.index))}},{key:"setDate",value:function(e){var t=this.props.value,n=Object.assign({},t,{requested_for:e,index:this.props.index});this.props.setValue(n),this.props.onChange&&this.props.onChange(n)}},{key:"validateUniqueDate",value:function(n){var e=this.props.selectedDateRequests;return!e||(e.length<1||!e.some(function(e){var t=e.requested_for;return!!t&&n.getTime()===t.getTime()}))}},{key:"handleRemoveDate",value:function(e){e.preventDefault(),this.props.removeDateRequest(this.props.index)}},{key:"checkDateAndPeriods",value:function(e,t){if(this.props.afterHours){if(!e)return!1;var n=this.checkWeekend(e),r=this.checkHoliday(e);if(n||r)return this.setState({afterHours:!0}),!0;if(t&&1==t.length&&-1<t.indexOf("evening"))return this.setState({afterHours:!0}),!0;this.setState({afterHours:!1})}}},{key:"checkNow",value:function(){if(this.props.afterHours){var e=new Date,t=this.checkWeekend(e),n=this.checkAfterHours(e),r=this.checkHoliday(e);t||n||r?this.props.afterHours&&this.setState({afterHours:!0}):this.setState({afterHours:!1})}}},{key:"checkWeekend",value:function(e){var t=e.getDay();return 0==t||6==t}},{key:"checkAfterHours",value:function(e){var t=e.getHours();return t<0||17<=t}},{key:"renderCalendarDate",value:function(e,t,n,r){var a=this.checkWeekend(r.dateObj),s=r.classList.contains("disabled"),i=r.classList.contains("nextMonthDay"),o=this.props.isFlashDeal(r.dateObj),l=this.props.afterHours;s||i||(a&&l&&r.classList.add("weekend"),o&&r.classList.add("flash-deal-day"))}},{key:"checkHoliday",value:function(e){var s=this,t=e.getDate(),n=e.getMonth(),r=e.getFullYear(),i=new Date(Date.UTC(r,n,t));return this.props.holidays.some(function(e){var t=new Date(e.observed),n=i.getTime()===t.getTime(),r=e.national,a=-1<e.observers.indexOf(s.props.region);return n&&(r||a)})}},{key:"renderRemoveLink",value:function(){return 0!==this.props.index?React.createElement("span",null,React.createElement("a",{className:"text-danger",href:"#",onClick:this.handleRemoveDate},React.createElement("i",{className:"fa fa-minus-square-o",title:"delete-date-request-icon"}))):null}},{key:"renderAfterHourWarning",value:function(){if(this.state.afterHours)return React.createElement("p",{className:"text-danger"},"After hour rate may apply.")}},{key:"formatDate",value:function(e){if(e&&e instanceof Date){var t=e.getDate(),n=e.getMonth(),r=e.getFullYear();return zeroPad(n+1)+"/"+zeroPad(t)+"/"+r}return""}},{key:"renderDiscountInfo",value:function(){return this.props.isFlash?React.createElement("span",{className:"text-danger"},"Flash deal discount applied"):null}},{key:"render",value:function(){var t=this,e=this.props.collection||[["morning","Morning"],["afternoon","Afternoon"],["evening","Evening"]];return React.createElement("div",{id:"request-periods"},React.createElement(TextInputGroupV2,{ref:function(e){return t.dateInputComponent=e},inputRef:function(e){return t.dateInput=e},name:"date_requests["+this.props.index+"].requested_for_string",validations:["required"],placeholder:"What day works for you?",onChange:function(){},addon:React.createElement("i",{className:"fa fa-calendar"}),postAddon:this.renderRemoveLink(),disabled:this.props.disableDateInput,serializable:!1}),React.createElement(CheckboxesInputV2,{collection:e,name:"date_requests["+this.props.index+"].time_periods",validations:["required"],onChange:this.handleSelectPeriods,serializable:!1,hint:this.renderDiscountInfo()}),this.renderAfterHourWarning())}}]),t}(React.Component);DateRequest.propTypes=propTypes,DateRequest=withFormV2(DateRequest);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={requestedFor:React.PropTypes.string};var FlashJobDateRequest=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleUpdateDateRequest=this.handleUpdateDateRequest.bind(this)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){var e=new Date(this.props.requestedFor);this.dateRequestInput.setDate(e),this.dateRequestInput.dateInputComponent.setValue(this.formatDate(e))}},{key:"formatDate",value:function(e){if(e&&e instanceof Date){var t=e.getDate(),n=e.getMonth(),r=e.getFullYear();return zeroPad(n+1)+"/"+zeroPad(t)+"/"+r}return""}},{key:"handleUpdateDateRequest",value:function(e){this.props.setValue([e])}},{key:"render",value:function(){var t=this;return React.createElement(DateRequest,{inputComponentRef:function(e){return t.dateRequestInput=e},index:0,disableDateInput:!0,onChange:this.handleUpdateDateRequest})}}]),t}(React.Component);FlashJobDateRequest.propTypes=propTypes,FlashJobDateRequest=withFormV2(FlashJobDateRequest);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={addDateRequest:React.PropTypes.func.isRequired};var JobAddDateRequestLink=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleAddDate=this.handleAddDate.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleAddDate",value:function(e){e.preventDefault(),this.props.addDateRequest()}},{key:"render",value:function(){return React.createElement("a",{href:"#",onClick:this.handleAddDate},React.createElement("i",{className:"fa fa-plus-square-o"})," Add more available dates")}}]),t}(React.Component);JobAddDateRequestLink.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var JobAddressAutocomplete=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleAddressClicked=this.handleAddressClicked.bind(this),this.handleLineTwoChanged=this.handleLineTwoChanged.bind(this),this.triggerOnChange=this.triggerOnChange.bind(this),this.setAddress=this.setAddress.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleLineTwoChanged",value:function(e){this.setAddress({line2:e})}},{key:"handleAddressClicked",value:function(e){var t=this.setAddress({street_number:e.street_number,line1:e.route,city:e.locality||e.sublocality_level_1,subregion:e.administrative_area_level_1,country:e.country,country_code:e.country_code,postal_code:e.postal_code,latitude:e.latitude,longitude:e.longitude});this.triggerOnChange(t)}},{key:"setAddress",value:function(e){var t=this.props.value,n=Object.assign({},t,e);return this.props.setValue(n),n}},{key:"triggerOnChange",value:function(e){this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this.props.errors.join(" ");return React.createElement("div",{className:"job-address-form"},React.createElement("div",{className:"address-details"},React.createElement(AddressAutocomplete,{hasError:this.props.hasError,errorMsg:e,onResultClicked:this.handleAddressClicked,getCountryCode:!0,getCoordinates:!0})),React.createElement("div",{className:"unit-details"},React.createElement(TextInputV2,{name:"line2",placeholder:"Unit/Suite",onChange:this.handleLineTwoChanged,serializable:!1})))}}]),t}(React.Component);JobAddressAutocomplete=withFormV2(JobAddressAutocomplete);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={flashDeals:React.PropTypes.array};var JobDateRequest=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.dateRequestsLimit=3,this.addDateRequest=this.addDateRequest.bind(this),this.removeDateRequest=this.removeDateRequest.bind(this),this.handleDateChanged=this.handleDateChanged.bind(this),this.resetDateRequests=this.resetDateRequests.bind(this),this.resetDateRequestAtIndex=this.resetDateRequestAtIndex.bind(this),this.isFlashDeal=this.isFlashDeal.bind(this),this.setIsFlash=this.setIsFlash.bind(this),this.getIsFlash=this.getIsFlash.bind(this),this.state={date_requests:[this.dateRequestModel()],isFlash:!1}}return _inherits(t,e),_createClass(t,[{key:"resetDateRequests",value:function(){this.setState({date_requests:[]},this.addDateRequest)}},{key:"resetDateRequestAtIndex",value:function(e){var t=this.state.date_requests;t[e]=this.dateRequestModel(),this.setState({date_requests:t})}},{key:"removeDateRequest",value:function(e){var t=this.state.date_requests;t.splice(e,1),this.setState({date_requests:t})}},{key:"dateRequestModel",value:function(){return{requested_for:null,time_periods:[]}}},{key:"addDateRequest",value:function(){var e=this.state.date_requests;e.push(this.dateRequestModel()),this.setState({date_requests:e})}},{key:"handleDateChanged",value:function(e){var t=this.state.date_requests,n=t[e.index];this.setIsFlash(e)?t=[Object.assign({},n,e)]:t[e.index]=Object.assign({},n,e),this.setState({date_requests:t}),this.props.setValue(t)}},{key:"setIsFlash",value:function(e){var t=!1;return 0===e.index&&(t=this.isFlashDeal(e.requested_for)),this.setState({isFlash:t},function(){PubSub.publish("flashDateSelected",t)}),t}},{key:"isFlashDeal",value:function(e){if(!e)return!1;var t=e.getDate(),n=e.getMonth()+1,r=e.getFullYear();if(this.props.flashDeals&&!isEmptyObject(this.props.flashDeals)){var a=this.props.flashDeals[r+"-"+zeroPad(n)+"-"+zeroPad(t)];return a&&Array.isArray(a)&&0<a.length}return!1}},{key:"getIsFlash",value:function(){return this.state.isFlash}},{key:"renderDateRequests",value:function(){var n=this;return this.state.date_requests.map(function(e,t){return React.createElement(DateRequest,{key:t+"-date-request",index:t,serializable:!1,onChange:n.handleDateChanged,afterHours:n.props.afterHours,holidays:n.props.holidays,region:n.props.region,removeDateRequest:n.removeDateRequest,selectedDateRequests:n.state.date_requests,resetDateRequestAtIndex:n.resetDateRequestAtIndex,flashDeals:n.props.flashDeals,isFlashDeal:n.isFlashDeal,isFlash:n.state.isFlash})})}},{key:"renderAddDateLink",value:function(){return!this.state.isFlash&&this.state.date_requests.length<this.dateRequestsLimit?React.createElement(JobAddDateRequestLink,{addDateRequest:this.addDateRequest}):null}},{key:"render",value:function(){return React.createElement("div",null,this.renderDateRequests(),this.renderAddDateLink())}}]),t}(React.Component);JobDateRequest=withFormV2(JobDateRequest);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={label:React.PropTypes.string.isRequired,order:React.PropTypes.number};var JobField=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"form-horizontal-group",style:{order:this.props.order}},React.createElement("label",{className:"horizontal-label",htmlFor:this.props.htmlFor},this.props.label),React.createElement("div",{className:"horizontal-input-group"},this.props.children))}}]),t}(React.PureComponent);JobField.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={submit:React.PropTypes.func.isRequired,externalErrors:React.PropTypes.object};var JobForm=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{id:"job-form"},React.createElement(FormV2,_extends({className:"form"},this.props),this.props.children))}}]),t}(React.Component);JobForm.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={title:React.PropTypes.string.isRequired};var JobFormLayout=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"job-details-form"},React.createElement("h3",{className:"form-title"},this.props.title),this.props.children)}}]),t}(React.PureComponent);JobFormLayout.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={addresses:React.PropTypes.array,disabled:React.PropTypes.bool,value:React.PropTypes.any,fetchFlashDeals:React.PropTypes.func,addressInRegionValidationPath:React.PropTypes.string},defaultProps={addresses:[],disabled:!1};var JobLocation=function(e){function n(e){_classCallCheck(this,n),_get(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.switchInput=this.switchInput.bind(this),this.handleSetAddress=this.handleSetAddress.bind(this),this.getAddressObject=this.getAddressObject.bind(this),this.validateAddressInServiceRegion=this.validateAddressInServiceRegion.bind(this),this.validateAddressDebounced=$.debounce(this.validateAddressInServiceRegion,1e3),this.changeAddress=this.changeAddress.bind(this),this.handleChangeAddress=this.handleChangeAddress.bind(this);var t=this.props.addresses&&0<this.props.addresses.length;this.state={useExisting:t,addressNotInServiceRegion:!1}}return _inherits(n,e),_createClass(n,[{key:"validateAddressInServiceRegion",value:function(e){var t=this;if(this.state.useExisting)return!0;this.setState({addressNotInServiceRegion:!1});var n=$.ajax({url:this.props.addressInRegionValidationPath,type:"POST",dataType:"JSON",data:{address:e}});n.done(function(){return!0}),n.fail(function(e){return 422!==e.status||(t.state.addressNotInServiceRegion||alertify.alert("Oh no! Jiffy isn\u2019t in your area yet.          We\u2019re expanding quickly so please do check back soon!"),t.setState({addressNotInServiceRegion:!0})),!1})}},{key:"handleSetAddress",value:function(e){var t=this.getAddressObject(e);this.previousAddress?isSame(this.previousAddress,t)||this.handleChangeAddress(t,e):this.changeAddress(t,e),this.validateAddressDebounced(t)}},{key:"getAddressObject",value:function(t){return this.state.useExisting?this.props.addresses.find(function(e){return e.id===Number(t)}):t}},{key:"handleChangeAddress",value:function(e,t){var n=this,r=this.props.resetDateRequests();r.then(function(){n.changeAddress(e,t)}),r["catch"](function(){n.resetToPrevious()})}},{key:"changeAddress",value:function(e,t){this.props.fetchFlashDeals&&this.props.fetchFlashDeals(e.latitude,e.longitude),this.previousAddress={existing:this.state.useExisting,address:t}}},{key:"resetToPrevious",value:function(){this.previousAddress&&(this.previousAddress.existing!==this.state.useExisting&&this.setState({useExisting:this.previousAddress.existing}),this.state.useExisting,this.addressSelect.setValue(this.previousAddress.address))}},{key:"switchInput",value:function(e){e.preventDefault();var t=this.state.useExisting;this.setState({useExisting:!t})}},{key:"processLabel",value:function(e){var t=e.street_number+" "+e.line1;return e.line2&&(t+=" "+e.line2),t}},{key:"renderAddressSelect",value:function(){var t=this;return React.createElement("div",{id:"address-select-input"},React.createElement(SelectInputV2,{ref:function(e){return t.addressSelect=e},name:"address_id",wrapperClass:"form-group margin-bottom-sm",collection:this.props.addresses,includeBlank:"Select an address",labelMethod:this.processLabel,value:this.props.value,disabled:this.props.disabled,validations:["required"],onChange:this.handleSetAddress}),this.renderSwitcher())}},{key:"renderSwitcher",value:function(){if(!this.props.addresses)return null;if(0===this.props.addresses.length)return null;if(this.props.disabled)return null;var e="Use an existing address";return this.state.useExisting&&(e="Enter a different address"),React.createElement("a",{onClick:this.switchInput,className:"small pull-right",href:"#"},e)}},{key:"renderAddressAutocomplete",value:function(){var t=this;return React.createElement("div",{id:"address-autocomplete-fields"},React.createElement(JobAddressAutocomplete,{ref:function(e){return t.addressAutocomplete=e},name:"address_attributes",validations:["required"],onChange:this.handleSetAddress}),this.renderSwitcher())}},{key:"render",value:function(){return this.state.useExisting?this.renderAddressSelect():this.renderAddressAutocomplete()}}]),n}(React.Component);JobLocation.propTypes=propTypes,JobLocation.defaultProps=defaultProps;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var JobQuestionBanner=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{id:"questions-banner"},React.createElement("p",{className:"title"},"Any questions about billing?"),React.createElement("p",{className:"text"},"Reach out to us at any time. We're always available to answer your questions by ",React.createElement("a",{href:"#",id:"intercom-show"},"chat"),", ",React.createElement("a",{href:"mailto:info@jiffyondemand.com"},"email")," or text ",React.createElement("a",{href:"sms:647-490-1524"},"647-490-1524")))}}]),t}(React.PureComponent),JobRequestPeriods=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={collection:React.PropTypes.array.isRequired,name:React.PropTypes.string.isRequired,onChange:React.PropTypes.func.isRequired,selectedPeriods:React.PropTypes.array,type:React.PropTypes.string},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleChange=this.handleChange.bind(this),this.validateInput=this.validateInput.bind(this),this.keyLabels=this.processCollection(this.props.collection),this.state={data:_defineProperty({},this.props.name,this.props.selectedPeriods||[]),errors:[]}}return _inherits(t,e),_createClass(t,[{key:"validateInput",value:function(){var e=this.props.name;return 0<this.state.data[e].length?(this.setState({errors:[]}),!0):(this.setState({errors:["Can't be blank"]}),!1)}},{key:"processCollection",value:function(e){return e.map(function(e){if("string"==typeof e)return[e,titleize(e)];if(Array.isArray(e)){if(2!==e.length)throw new TypeError("collection must be array of arrays of 2 items");return e}})}},{key:"processChecked",value:function(e){var t=this.props.name;return-1<this.state.data[t].indexOf(e)}},{key:"handleChange",value:function(e){var t=this,n=this.props.name,r=this.state.data[n];if(e.target.checked)this.setState({data:_defineProperty({},n,[].concat(_toConsumableArray(r),[e.target.value])),errors:[]},function(){t.props.onChange(t.state.data)});else{var a=e.target.value;r.splice(r.indexOf(a),1);var s=0<r.length?[]:["Can't be blank"];this.setState({data:_defineProperty({},n,r),errors:s},function(){t.props.onChange(t.state.data)})}}},{key:"renderPeriodWrapperClass",value:function(){return"checkbox"===this.props.type?"checkbox":"radio"}},{key:"renderPeriods",value:function(){var s=this;return this.keyLabels.map(function(e){var t=e[0],n=e[1],r=s.processChecked(t),a=r?"checked":"";return React.createElement("span",{key:t+"-checkbox",className:s.renderPeriodWrapperClass()},React.createElement("label",{className:a},React.createElement("input",{checked:r,type:s.props.type,value:t,onChange:s.handleChange}),n))})}},{key:"renderError",value:function(){return 0<this.state.errors.length?this.state.errors.map(function(e,t){return React.createElement("p",{key:t+"-error",className:"help-block text-danger"},e)}):null}},{key:"renderWrapperClass",value:function(){return 0<this.state.errors.length?"form-group request-periods has-error":"form-group request-periods"}},{key:"render",value:function(){return React.createElement("div",{className:this.renderWrapperClass()},this.renderPeriods(),this.renderError())}}]),t}(React.Component));JobRequestPeriods.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={regionalService:React.PropTypes.object.isRequired,isFlash:React.PropTypes.bool,quotedService:React.PropTypes.bool,isSmartHomeInstall:React.PropTypes.bool,isFreeInstall:React.PropTypes.bool};var LandingRateCard=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleFlashDateSelected=this.handleFlashDateSelected.bind(this),this.handleSmartDeviceChanged=this.handleSmartDeviceChanged.bind(this),this.state={isFlash:this.props.isFlash,isFreeInstall:this.props.isFreeInstall||!1}}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){PubSub.subscribe("flashDateSelected",this.handleFlashDateSelected),PubSub.subscribe("smartDeviceChanged",this.handleSmartDeviceChanged)}},{key:"handleFlashDateSelected",value:function(e,t){this.setState({isFlash:t})}},{key:"handleSmartDeviceChanged",value:function(e,t){if(this.props.isSmartHomeInstall){var n=t&&0<t.length;this.setState({isFreeInstall:n})}}},{key:"renderQuotedContent",value:function(){return this.props.quotedService?React.createElement("div",{className:"rate-quote"},React.createElement("p",{className:"quote-heading"},"Free",React.createElement("br",null),"Quote"),React.createElement("p",{className:"subdued"},"We'll instantly match you with an amazing company to provide a quote. It's that easy.")):null}},{key:"renderRate",value:function(){var e=this.props.regionalService,t=e.local_minimum_charge,n=e.minimum_charge;return this.state.isFlash?React.createElement("span",null,React.createElement("strike",{className:"text-muted"},"$",n)," $",t):React.createElement("span",null,"$",n)}},{key:"renderAdditionalRate",value:function(){var e=this.props.regionalService;return e.use_alt_unit_price?[React.createElement("label",{key:"additional-rate-label",className:"rate-label"},"Every additional ",e.alt_unit),React.createElement("span",{key:"additional-rate-rate",className:"rate"},"$",e.alt_unit_price)]:[React.createElement("label",{key:"additional-rate-label",className:"rate-label"},"Every additional ",e.unit),React.createElement("span",{key:"additional-rate-rate",className:"rate"},"$",e.unit_price)]}},{key:"renderAfterHoursFooter",value:function(){return this.props.regionalService.after_hours?React.createElement("div",{className:"card-footer"},React.createElement("p",null,"After Hours (M-F after 5pm, weekends & holidays) ",React.createElement("strong",null,"1.5x"))):null}},{key:"renderFreeInstallContent",value:function(){return this.state.isFreeInstall?React.createElement("div",{className:"rate-quote"},React.createElement("p",{className:"quote-heading"},"Free",React.createElement("br",null),"Installation"),React.createElement("p",{className:"subdued"},"Free installation accounts for 1.5 hours of work per smart home device. Any additional hours will be billed at $",this.props.regionalService.unit_price,"/",this.props.regionalService.unit,".")):null}},{key:"renderRegularContent",value:function(){return this.props.quotedService||this.state.isFreeInstall?null:React.createElement("div",null,React.createElement("div",{className:"rate-details"},React.createElement("label",{className:"rate-label"},"For the first ",this.props.regionalService.minimum_units," ",this.props.regionalService.unit),React.createElement("span",{className:"rate"},this.renderRate())),React.createElement("div",{className:"rate-details"},this.renderAdditionalRate()),React.createElement("div",{className:"rate-details"},React.createElement("label",{className:"rate-label"},"Materials (if required)"),React.createElement("span",{className:"rate"},"TBD")),React.createElement("div",{className:"rate-description"},React.createElement("p",null,this.props.regionalService.description)))}},{key:"render",value:function(){return React.createElement("div",{className:"card",id:"rate-card"},React.createElement("div",{className:"card-heading"},React.createElement("p",null,this.props.regionalService.name," Rates")),React.createElement("div",{className:"card-body"},this.renderQuotedContent(),this.renderRegularContent(),
this.renderFreeInstallContent()),this.renderAfterHoursFooter())}}]),t}(React.Component);LandingRateCard.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={index:React.PropTypes.number,smartDevice:React.PropTypes.object,withAction:React.PropTypes.bool,withRemove:React.PropTypes.bool,onAdd:React.PropTypes.func,onRemove:React.PropTypes.func};var SmartDevice=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleAdd=this.handleAdd.bind(this),this.handleRemoveDevice=this.handleRemoveDevice.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleRemoveDevice",value:function(e){e.preventDefault(),this.props.onRemove(this.props.index)}},{key:"handleAdd",value:function(e){e.preventDefault(),this.props.onAdd(this.props.smartDevice)}},{key:"renderActions",value:function(){return this.props.withAction?React.createElement("div",{className:"card-footer text-center"},React.createElement("a",{className:"add-btn",href:"",onClick:this.handleAdd},"Add")):null}},{key:"renderRemoveIcon",value:function(){return this.props.withRemove?React.createElement("a",{href:"#",onClick:this.handleRemoveDevice,className:"remove-device-icon"},React.createElement("i",{className:"fa fa-remove"})):null}},{key:"renderPrice",value:function(){var e=this.props.smartDevice.device_prices;if(e&&0<e.length){var t=e[0];return React.createElement("p",{className:"device-price"},"$"+t.price)}return null}},{key:"render",value:function(){return React.createElement("div",{className:"card smart-device"},React.createElement("div",{className:"card-body smart-device-content"},this.renderRemoveIcon(),React.createElement("img",{className:"device-image",src:this.props.smartDevice.image}),React.createElement("p",{className:"device-name"},this.props.smartDevice.name),this.renderPrice()),this.renderActions())}}]),t}(React.Component);SmartDevice.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={smartDevices:React.PropTypes.array};var SmartDevicesInput=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleAddDevice=this.handleAddDevice.bind(this),this.showSmartDevicesModal=this.showSmartDevicesModal.bind(this),this.handleRemoveDevice=this.handleRemoveDevice.bind(this),this.notifySubscribers=this.notifySubscribers.bind(this),this.setValue=this.setValue.bind(this),this.state={smartDevices:[]}}return _inherits(t,e),_createClass(t,[{key:"showSmartDevicesModal",value:function(e){e.preventDefault(),this.smartDevicesModal.showModal()}},{key:"handleAddDevice",value:function(e){var t=this.state.smartDevices;t.push(e),alertify.parent(this.smartDevicesModal.getModalElement()),alertify.logPosition("top right"),alertify.success(e.name+" Added"),this.setState({smartDevices:t}),this.notifySubscribers(),this.setValue(t)}},{key:"handleRemoveDevice",value:function(e){var t=this.state.smartDevices;t.splice(e,1),this.setState({smartDevices:t}),this.notifySubscribers(),this.setValue(t)}},{key:"notifySubscribers",value:function(){PubSub.publish("smartDeviceChanged",this.state.smartDevices)}},{key:"setValue",value:function(e){this.props.setValue(e.map(function(e){return{smart_device_id:e.id}}))}},{key:"render",value:function(){var t=this;return React.createElement("div",null,React.createElement(SmartDevicesList,{smartDevices:this.state.smartDevices,withRemove:!0,onRemove:this.handleRemoveDevice}),React.createElement("a",{href:"#",onClick:this.showSmartDevicesModal},"Add More Devices"),React.createElement(SmartDevicesModal,{ref:function(e){return t.smartDevicesModal=e},smartDevices:this.props.smartDevices,onAdd:this.handleAddDevice}))}}]),t}(React.Component);SmartDevicesInput.propTypes=propTypes,SmartDevicesInput=withFormV2(SmartDevicesInput);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={smartDevices:React.PropTypes.array,label:React.PropTypes.string,withAction:React.PropTypes.bool,withRemove:React.PropTypes.bool,onAdd:React.PropTypes.func,onRemove:React.PropTypes.func};var SmartDevicesList=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderSmartDevices",value:function(){var n=this;return this.props.smartDevices.map(function(e,t){return React.createElement(SmartDevice,{key:"smart-device-"+t,index:t,smartDevice:e,withRemove:n.props.withRemove,withAction:n.props.withAction,onAdd:n.props.onAdd,onRemove:n.props.onRemove})})}},{key:"renderLabel",value:function(){return this.props.label?React.createElement("h4",{className:"margin-bottom-sm"},this.props.label):null}},{key:"renderPlaceholder",value:function(){return 0===this.props.smartDevices.length?React.createElement("div",{className:"smart-device-placeholder"},"Smart Device",React.createElement("span",{className:"smart-device-placeholder-icon"},React.createElement("i",{className:"fa fa-plus"}))):null}},{key:"render",value:function(){return React.createElement("div",{className:"smart-devices-list"},this.renderLabel(),this.renderSmartDevices(),this.renderPlaceholder())}}]),t}(React.Component);SmartDevicesList.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={smartDevices:React.PropTypes.array};var SmartDevicesModal=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.showModal=this.showModal.bind(this),this.closeModal=this.closeModal.bind(this),this.state={smartDevicesGroups:this.groupSmartDevices(),display:!1}}return _inherits(t,e),_createClass(t,[{key:"groupSmartDevices",value:function(){return this.props.smartDevices.reduce(function(e,t){return e[t.brand]?e[t.brand].push(t):e[t.brand]=[t],e},{})}},{key:"showModal",value:function(e){e&&e.preventDefault(),this.setState({display:!0})}},{key:"closeModal",value:function(e){e&&e.preventDefault(),this.setState({display:!1})}},{key:"getModalElement",value:function(){return this.reactModal}},{key:"renderDevicesLists",value:function(){var n=this,r=this.state.smartDevicesGroups;return Object.keys(r).map(function(e,t){return r.hasOwnProperty(e)?React.createElement(SmartDevicesList,{key:"smart-devices-list-"+t,smartDevices:r[e],label:e,withAction:!0,onAdd:n.props.onAdd}):null})}},{key:"render",value:function(){var t=this;return this.state.display?React.createElement("div",{ref:function(e){return t.reactModal=e},className:"react-modal"},React.createElement("div",{className:"modal-backdrop"}),React.createElement("div",{className:"modals"},React.createElement("div",{className:"modal-heading primary"},React.createElement("h2",{className:"modal-title"},"Choose a smart device"),React.createElement("a",{onClick:this.closeModal,className:"modal-close-toggle"},React.createElement("i",{className:"fa fa-remove"}))),React.createElement("div",{className:"modal-content"},this.renderDevicesLists()))):null}}]),t}(React.Component);SmartDevicesModal.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={formType:React.PropTypes.oneOf(["regular","quoted","flash"]),holidays:React.PropTypes.array,region:React.PropTypes.string};var JobFormContainer=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){switch(this.props.formType){case"regular":return React.createElement(RegularJobForm,this.props);case"quoted":return React.createElement(QuotedJobForm,this.props);case"flash":return React.createElement(ReverseFlashForm,this.props)}}}]),t}(React.Component);JobFormContainer.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={addresses:React.PropTypes.array,submitPath:React.PropTypes.string.isRequired,submitMethod:React.PropTypes.string,addresses:React.PropTypes.array,serviceId:React.PropTypes.number,todoItemId:React.PropTypes.string,addressInRegionValidationPath:React.PropTypes.string};var QuotedJobForm=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSubmit=this.handleSubmit.bind(this),this.state={errors:{}}}return _inherits(t,e),_createClass(t,[{key:"handleSubmit",value:function(e){var n=this;e.service_id=this.props.serviceId,e.todo_item_id=this.props.todoItemId;var t=$.ajax({url:this.props.submitPath,type:"POST",dataType:"JSON",contentType:"application/json",data:JSON.stringify({job:e})});this.setState({errors:{}}),t.then(function(e){window.location=e.redirect_url}),t.fail(function(e){var t=e.responseJSON;422==e.status?n.setState({errors:t.errors}):alertify.alert("Could not submit job information, please contact Jiffy for support")})}},{key:"render",value:function(){return React.createElement(JobForm,{submit:this.handleSubmit,externalErrors:this.state.errors,defaultValues:this.props.defaultValues},React.createElement(JobFormLayout,{title:"Job Information"},React.createElement(JobField,{label:"Date and Time"},React.createElement(JobDateRequest,{name:"date_requests_attributes"})),React.createElement(JobField,{label:"Job Deadline"},React.createElement(TextAreaInputV2,{name:"deadline",placeholder:"When would you like the job to be finished by?"})),React.createElement(JobField,{label:"Location"},React.createElement(JobLocation,{addresses:this.props.addresses,addressInRegionValidationPath:this.props.addressInRegionValidationPath})),React.createElement(JobField,{label:"Job Description"},React.createElement(TextAreaInputV2,{name:"description",placeholder:"Type in a brief description of the job",validate:["required"]}))),React.createElement(JobQuestionBanner,null),React.createElement(SubmitButtonV2,{className:"btn btn-lg btn-block btn-secondary"},"Continue"))}}]),t}(React.Component);QuotedJobForm.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={addresses:React.PropTypes.array,submitPath:React.PropTypes.string.isRequired,submitMethod:React.PropTypes.string,addresses:React.PropTypes.array,serviceId:React.PropTypes.number,todoItemId:React.PropTypes.string,flashDealsPath:React.PropTypes.string,enableSmartDevices:React.PropTypes.bool,isSmartHomeInstall:React.PropTypes.bool,smartDevices:React.PropTypes.array,addressInRegionValidationPath:React.PropTypes.string};var RegularJobForm=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSubmit=this.handleSubmit.bind(this),this.fetchFlashDeals=this.fetchFlashDeals.bind(this),this.resetDateRequests=this.resetDateRequests.bind(this),this.handleConfirmResetDates=this.handleConfirmResetDates.bind(this),this.state={flashDeals:{},errors:{}}}return _inherits(t,e),_createClass(t,[{key:"handleSubmit",value:function(e){var n=this;e.service_id=this.props.serviceId,e.todo_item_id=this.props.todoItemId;var t=$.ajax({url:this.props.submitPath,type:"POST",dataType:"JSON",contentType:"application/json",data:JSON.stringify({job:e})});this.setState({errors:{}}),t.then(function(e){window.location="/job_confirmation?id="+e.job.slug}),t.fail(function(e){var t=e.responseJSON;422===e.status?n.setState({errors:t.errors}):alertify.alert("Could not submit job information, please contact Jiffy for support")})}},{key:"handleConfirmResetDates",value:function(){this.jobDateRequestInput.resetDateRequests()}},{key:"fetchFlashDeals",value:function(e,t){var n=this,r=$.ajax({url:this.props.flashDealsPath,type:"GET",dataType:"JSON",data:{flash_deals:{latitude:e,longitude:t}}});r.done(function(e){var t=n.groupFlashDeals(e.flash_deals);n.setState({flashDeals:t})}),r.fail(function(){console.error("Could not fetch flash deals")})}},{key:"groupFlashDeals",value:function(e){return e.length<1?{}:e.reduce(function(e,t){var n=t.date.split("T")[0],r=e[n]||[];return r.push(t),e[n]=r,e},{})}},{key:"renderSmartDevicesSelection",value:function(){if(!this.props.enableSmartDevices)return null;var e=null;return this.props.isSmartHomeInstall||(e=1),React.createElement(JobField,{label:"Select Smart Devices",order:e},React.createElement(SmartDevicesInput,{name:"job_devices_attributes",smartDevices:this.props.smartDevices}))}},{key:"resetDateRequests",value:function(){var n=this;return new Promise(function(e){if(n.jobDateRequestInput.getIsFlash()){var t="We see that you've selected a flash deal.         This deal is address specific and may not be available if you change your address.         Would you like to continue?";alertify.confirm(t,function(){n.handleConfirmResetDates(),e(!0)})}else e(!0)})}},{key:"render",value:function(){var t=this;return React.createElement(JobForm,{submit:this.handleSubmit,externalErrors:this.state.errors,defaultValues:this.props.defaultValues},React.createElement(JobFormLayout,{title:"Job Information"},this.renderSmartDevicesSelection(),React.createElement(JobField,{label:"Location",htmlFor:"location"},React.createElement(JobLocation,{ref:function(e){return t.jobLocationInput=e},addresses:this.props.addresses,fetchFlashDeals:this.fetchFlashDeals,resetDateRequests:this.resetDateRequests,addressInRegionValidationPath:this.props.addressInRegionValidationPath})),React.createElement(JobField,{label:"Date and Time"},React.createElement(JobDateRequest,{inputComponentRef:function(e){return t.jobDateRequestInput=e},name:"date_requests_attributes",afterHours:this.props.afterHours,flashDeals:this.state.flashDeals,holidays:this.props.holidays,region:this.props.region})),React.createElement(JobField,{label:"Timing Constraints",htmlFor:"timing_constraints"},React.createElement(TextAreaInputV2,{name:"timing_constraints",id:"timing_constraints",placeholder:"Let us know about any timing constraints or flexibility",validations:["required"]})),React.createElement(JobField,{label:"Job Description",htmlFor:"job_description"},React.createElement(TextAreaInputV2,{name:"description",placeholder:"Type in a brief description of the job",validations:["required"],id:"job_description"}))),React.createElement(JobQuestionBanner,null),React.createElement(SubmitButtonV2,{className:"btn btn-lg btn-block btn-secondary"},"Continue"))}}]),t}(React.Component);RegularJobForm.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={submitPath:React.PropTypes.string,address:React.PropTypes.object,addresses:React.PropTypes.array,requestedFor:React.PropTypes.string};var ReverseFlashForm=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSubmit=this.handleSubmit.bind(this),this.state={errors:{}}}return _inherits(t,e),_createClass(t,[{key:"handleSubmit",value:function(e){var n=this;this.parseDateRequest(e);var t=$.ajax({url:this.props.submitPath,type:"post",dataType:"json",contentType:"application/json",data:JSON.stringify({job:e})});this.setState({errors:{}}),t.then(function(e){window.location=e.redirect_url}),t.fail(function(e){var t=e.responseJSON;422==e.status?n.setState({errors:t.errors}):alertify.alert("Could not submit job information, please contact Jiffy for support")})}},{key:"parseDateRequest",value:function(e){e.date_requests_attributes=e.date_requests_attributes.map(function(e){return e.requested_for=parseDateString(e.requested_for,"/","%m %d %y"),e})}},{key:"render",value:function(){return React.createElement(JobForm,{submit:this.handleSubmit,externalErrors:this.state.errors},React.createElement(JobFormLayout,{title:"Job Information"},React.createElement(JobField,{label:"Date and Time"},React.createElement(FlashJobDateRequest,{name:"date_requests_attributes",requestedFor:this.props.requestedFor})),React.createElement(JobField,{label:"Timing Constraints"},React.createElement(TextAreaInputV2,{name:"timing_constraints",placeholder:"Let us know about any timing constraints or flexibility",validations:["required"]})),React.createElement(JobField,{label:"Location"},React.createElement(JobLocation,{addresses:this.props.addresses,disabled:!0,value:this.props.address.id})),React.createElement(JobField,{label:"Job Description"},React.createElement(TextAreaInputV2,{name:"description",placeholder:"Type in a brief description of the job",validations:["required"]}))),React.createElement(JobQuestionBanner,null),React.createElement(SubmitButtonV2,{className:"btn btn-lg btn-block btn-secondary"},"Continue"))}}]),t}(React.Component);ReverseFlashForm.propTypes=propTypes;_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={data:React.PropTypes.arrayOf(React.PropTypes.object).isRequired,columns:React.PropTypes.arrayOf(React.PropTypes.object).isRequired,row:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]).isRequired,onSort:React.PropTypes.func.isRequired,onSetActiveJob:React.PropTypes.func,onUnsetActiveJob:React.PropTypes.func};var JobTable=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.setActiveJob=this.setActiveJob.bind(this),this.unsetActiveJob=this.unsetActiveJob.bind(this),this.renderColumns=this.renderColumns.bind(this),this.renderRows=this.renderRows.bind(this)}return _inherits(t,e),_createClass(t,[{key:"setActiveJob",value:function(e){this.props.onSetActiveJob&&this.props.onSetActiveJob(e)}},{key:"unsetActiveJob",value:function(){this.props.onUnsetActiveJob&&this.props.onUnsetActiveJob()}},{key:"renderColumns",value:function(){var n=this;return this.props.columns.map(function(e,t){return e.column?React.createElement(SortableHeading,{onToggle:n.props.onSort,label:e.label,column:e.column,currentSort:n.props.currentSort,currentSortDirection:n.props.currentDirection,key:t}):React.createElement("th",{key:t},e.label)})}},{key:"renderRows",value:function(){var t=this,e=this.props,n=e.data,r=e.columns,a=this.props.row;return 0<n.length?n.map(function(e){return React.createElement(a,{data:e,key:e.id,setActiveJob:t.setActiveJob,unsetActiveJob:t.unsetActiveJob})}):React.createElement("tr",null,React.createElement("td",{colSpan:r.length},"There are no jobs available at this moment."))}},{key:"render",value:function(){return React.createElement("table",{className:"table table-hover"},React.createElement("thead",null,React.createElement("tr",null,this.renderColumns())),React.createElement("tbody",null,this.renderRows()))}}]),t}(React.Component);JobTable.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={data:React.PropTypes.arrayOf(React.PropTypes.object).isRequired,columns:React.PropTypes.arrayOf(React.PropTypes.object).isRequired,row:React.PropTypes.oneOfType([React.PropTypes.func,React.PropTypes.object]).isRequired,onSort:React.PropTypes.func.isRequired,onSetActiveJob:React.PropTypes.func,onUnsetActiveJob:React.PropTypes.func,metadata:React.PropTypes.object.isRequired,onPageChange:React.PropTypes.func.isRequired,filters:React.PropTypes.array,shortcuts:React.PropTypes.array,currentFilters:React.PropTypes.object,onFilterSet:React.PropTypes.func,onApplyFilters:React.PropTypes.func,onClearFilters:React.PropTypes.func},defaultProps={filters:[]};var JobTableCard=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderFilters",value:function(){return 0<this.props.filters.length?React.createElement(JobTableFilters,{filters:this.props.filters,shortcuts:this.props.shortcuts,currentFilters:this.props.currentFilters,onFilterSet:this.props.onFilterSet,onApplyFilters:this.props.onApplyFilters,onClearFilters:this.props.onClearFilters}):null}},{key:"render",value:function(){return React.createElement("div",{className:"card"},this.renderFilters(),React.createElement("div",{className:"card-body flush"},React.createElement(JobTable,this.props)),React.createElement("div",{className:"card-footer"},React.createElement(Pagination,{paginate:this.props.metadata,onPageChange:this.props.onPageChange})))}}]),t}(React.Component);JobTableCard.propTypes=propTypes,JobTableCard.defaultProps=defaultProps;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={currentFilters:React.PropTypes.object.isRequired,onFilterSet:React.PropTypes.func.isRequired,filter:React.PropTypes.object.isRequired,shortcuts:React.PropTypes.array};var filterTypes={DATE_RANGE:"date_range",MULTI_SELECT:"multi_select",CHECKBOXES:"checkboxes"},JobTableFilterGroup=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleShortcutClicked=this.handleShortcutClicked.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleShortcutClicked",value:function(e,t){t.preventDefault();var n={};n[this.props.filter.column]=e.values,this.props.onFilterSet(n)}},{key:"renderFilterType",value:function(){var e={filterColumn:this.props.filter.column,filterData:this.props.filter.data,onFilterSet:this.props.onFilterSet,currentFilters:this.props.currentFilters};switch(this.props.filter.type){case filterTypes.DATE_RANGE:return React.createElement(DateRangeFilter,e);case filterTypes.CHECKBOXES:return React.createElement(CheckboxesFilter,e);default:return React.createElement(MultiSelectFilter,e)}}},{key:"renderFilterShortCuts",value:function(){var n=this,e=this.props.shortcuts;if(e)return e.map(function(t){return React.createElement("a",{key:"shortcut-"+n.props.filter.column+"-"+t.label,className:"btn btn-sm btn-default filter-shortcut-item",href:"#",onClick:function(e){return n.handleShortcutClicked(t,e)}},t.label)})}},{key:"render",value:function(){return React.createElement("div",{className:this.props.className},React.createElement("div",{className:"form-group"},React.createElement("label",null,React.createElement("strong",null,this.props.filter.label)),this.renderFilterType()),React.createElement("div",{className:"filter-shortcuts-container"},this.renderFilterShortCuts()))}}]),t}(React.Component);JobTableFilterGroup.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={filters:React.PropTypes.array.isRequired,currentFilters:React.PropTypes.object.isRequired,onFilterSet:React.PropTypes.func.isRequired,onApplyFilters:React.PropTypes.func.isRequired,onClearFilters:React.PropTypes.func.isRequired};var JobTableFilters=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.toggle=this.toggle.bind(this),this.handleApplyFilters=this.handleApplyFilters.bind(this),this.handleClearFilters=this.handleClearFilters.bind(this),this.renderFilters=this.renderFilters.bind(this)}return _inherits(t,e),_createClass(t,[{key:"toggle",value:function(e){e.preventDefault(),$(this.filterTable).toggle()}},{key:"handleApplyFilters",value:function(e){e.preventDefault(),this.props.onApplyFilters()}},{key:"handleClearFilters",value:function(){this.props.onClearFilters()}},{key:"getFilterShortcut",value:function(t){if(this.props.shortcuts){var e=this.props.shortcuts.filter(function(e){return e.column===t.column});return 0<e.length?e[0].data:[]}}},{key:"renderFilters",value:function(){var n=this;return this.props.filters.map(function(e,t){return React.createElement(JobTableFilterGroup,{key:"job-filters-"+t,className:"card-sm-3",filter:e,shortcuts:n.getFilterShortcut(e),onFilterSet:n.props.onFilterSet,currentFilters:n.props.currentFilters})})}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"card-body"},React.createElement("a",{href:"",onClick:this.toggle},"Filters ",React.createElement("i",{className:"fa fa-filter"})),React.createElement("div",{ref:function(e){return t.filterTable=e},className:"filter-table",style:{display:"none"}},React.createElement("form",null,React.createElement("div",{className:"card-row"},this.renderFilters()),React.createElement("button",{type:"reset",onClick:this.handleClearFilters,className:"button button-danger button-sm filter-controls"},"Clear"))))}}]),t}(React.Component);JobTableFilters.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var JobsMapTable=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:this.props.className},React.createElement(JobsMap,{jobs:this.props.jobs,activeJobId:this.props.activeJobId,namespace:this.props.namespace}),React.createElement("div",{className:"job-content dashboard-container"},React.createElement("div",{className:"card-row"},React.createElement("div",{className:"card-col-12"},React.createElement(JobTableCard,{data:this.props.jobs,columns:this.props.columns,metadata:this.props.metadata,onPageChange:this.props.handlePageChanged,row:this.props.row,onSort:this.props.handleSort,onSetActiveJob:this.props.setActiveJob,onUnsetActiveJob:this.props.unsetActiveJob,currentSort:this.props.sort,currentSortDirection:this.props.direction})))))}}]),t}(React.Component)
;JobsMapTable=jobTableHOC(JobsMapTable);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={row:React.PropTypes.string};var JobsSearchTable=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={row:window[this.props.row]}}return _inherits(t,e),_createClass(t,[{key:"filterShortcuts",value:function(){return[{column:"service_name",data:[{label:"None",values:[]},{label:"Regular",values:this.props.regularServicesName},{label:"Quoted",values:this.props.quotedServicesName}]}]}},{key:"render",value:function(){return React.createElement("div",{className:"dashboard-container"},React.createElement("div",{className:"card-row"},React.createElement("div",{className:"card-col-12"},React.createElement(ElasticSearchBar,{onSearch:this.props.handleSearch}),React.createElement(JobTableCard,{data:this.props.jobs,columns:this.props.columns,metadata:this.props.metadata,onPageChange:this.props.handlePageChanged,row:this.state.row,onSort:this.props.handleSort,currentSort:this.props.sort,currentSortDirection:this.props.direction,filters:this.props.filters,shortcuts:this.filterShortcuts(),onFilterSet:this.props.handleSetFilters,onApplyFilters:this.props.handleApplyFilters,onClearFilters:this.props.handleClearFilters,currentFilters:this.props.currentFilters}))))}}]),t}(React.Component);(JobsSearchTable=jobTableHOC(JobsSearchTable)).propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={showMap:React.PropTypes.bool};var JobsWithMap=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,e),_createClass(t,[{key:"renderJobTableClasses",value:function(){var e=this.props.className||"";return this.props.showMap?"jobs-with-map"+e:"jobs-without-map"+e}},{key:"renderMap",value:function(){if(this.props.showMap)return React.createElement(JobsMap,{jobs:this.props.jobs,activeJobId:this.props.activeJobId,namespace:this.props.namespace})}},{key:"render",value:function(){return React.createElement("div",{className:this.renderJobTableClasses()},this.renderMap(),React.createElement("div",{className:"job-content dashboard-container"},React.createElement("div",{className:"card-row"},React.createElement("div",null,React.createElement(ElasticSearchBar,{onSearch:this.props.handleSearch}),React.createElement(JobTableCard,{data:this.props.jobs,columns:this.props.columns,metadata:this.props.metadata,onPageChange:this.props.handlePageChanged,row:this.props.row,onSort:this.props.handleSort,currentSort:this.props.sort,currentDirection:this.props.direction,onSetActiveJob:this.props.setActiveJob,onUnsetActiveJob:this.props.unsetActiveJob,filters:this.props.filters,shortcuts:this.props.shortcuts,onFilterSet:this.props.handleSetFilters,onApplyFilters:this.props.handleApplyFilters,onClearFilters:this.props.handleClearFilters,currentFilters:this.props.currentFilters})))))}}]),t}(React.Component);JobsWithMap.propTypes=propTypes,JobsWithMap=jobTableHOC(JobsWithMap);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={jobs:React.PropTypes.arrayOf(React.PropTypes.object).isRequired,activeJobId:React.PropTypes.number,namespace:React.PropTypes.oneOf(["admin","professional","user"]),mapCreated:React.PropTypes.bool,fitWorld:React.PropTypes.func};var JobsMap=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.props.initializeMap(this.mapElement),this.props.fitWorld(this.serializeCoordinates())}},{key:"componentDidUpdate",value:function(e){this.compareWithCurrentJobs(e.jobs)&&0<this.props.jobs.length&&this.props.mapCreated&&this.props.fitWorld(this.serializeCoordinates())}},{key:"compareWithCurrentJobs",value:function(e){var t=this.props.jobs;if(t.length!==e.length)return!0;for(var n=0,r=t.length;n<r;n++)if(t[n].id!==e[n].id)return!0;return!1}},{key:"serializeCoordinates",value:function(){return this.props.jobs.map(function(e){return[e.address.latitude,e.address.longitude]})}},{key:"renderMarkers",value:function(){var t=this;return this.props.mapCreated?markers=this.props.jobs.map(function(e){return React.createElement(JobsMapMarker,{key:e.id,job:e,namespace:t.props.namespace,activeJobId:t.props.activeJobId,map:t.props.getMap()})}):null}},{key:"render",value:function(){var t=this;return React.createElement("div",{className:"job-map"},React.createElement("div",{className:"overlay"}),React.createElement("div",{ref:function(e){return t.mapElement=e},id:"map-react"},this.renderMarkers()))}}]),t}(React.Component);JobsMap.propTypes=propTypes,JobsMap=withLeafletMap(JobsMap);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={job:React.PropTypes.object.isRequired,namespace:React.PropTypes.oneOf(["admin","professional","user"]),activeJobId:React.PropTypes.number,map:React.PropTypes.object.isRequired};var JobsMapMarker=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.drawMarker()}},{key:"componentDidUpdate",value:function(){this.props.job.id==this.props.activeJobId?(this.marker.setZIndexOffset(999),$(this.marker._icon).addClass("selected-marker")):(this.marker.setZIndexOffset(0),$(this.marker._icon).removeClass("selected-marker"))}},{key:"componentWillUnmount",value:function(){this.props.map.removeLayer(this.marker)}},{key:"drawMarker",value:function(){var e={icon:new L.Icon.Default},t=L.latLng([this.props.job.address.latitude,this.props.job.address.longitude]),n=this.infoHtml();this.marker=L.marker(t,e).addTo(this.props.map).bindPopup(n)}},{key:"infoHtml",value:function(){var e=this.props.job;if("requested"==e.aasm_state)var t="<p><strong>"+e.service_name+"</strong></p>";else t="<p><strong>"+e.service_name+"</strong><br/>"+e.address.short_line+"</p>";if("admin"==this.props.namespace)var n=e.admin_url;else if("professional"==this.props.namespace)n=e.professional_url;else n=e.user_url;return t+="<a href="+n+" class='btn btn-block btn-default btn-xs'>View Job</a>"}},{key:"render",value:function(){return React.createElement("div",{className:"map-marker"})}}]),t}(React.Component);JobsMapMarker.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var Pagination=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.firstPage=this.firstPage.bind(this),this.lastPage=this.lastPage.bind(this),this.nextPage=this.nextPage.bind(this),this.prevPage=this.prevPage.bind(this),this.pageChange=this.pageChange.bind(this),this.renderFirstArrow=this.renderFirstArrow.bind(this),this.renderPrevArrow=this.renderPrevArrow.bind(this),this.renderNextArrow=this.renderNextArrow.bind(this),this.renderLastArrow=this.renderLastArrow.bind(this)}return _inherits(t,e),_createClass(t,[{key:"firstPage",value:function(e){e.preventDefault(),this.pageChange(1)}},{key:"lastPage",value:function(e){e.preventDefault(),this.pageChange(this.props.paginate.total_pages)}},{key:"nextPage",value:function(e){e.preventDefault(),this.pageChange(this.props.paginate.next_page)}},{key:"prevPage",value:function(e){e.preventDefault(),this.pageChange(this.props.paginate.prev_page)}},{key:"pageChange",value:function(e){this.props.onPageChange(e)}},{key:"renderFirstArrow",value:function(){if(this.props.paginate.prev_page)return React.createElement("li",null,React.createElement("a",{href:"#","aria-label":"First",onClick:this.firstPage},React.createElement("span",{"aria-hidden":"true"},"\xab")))}},{key:"renderPrevArrow",value:function(){if(this.props.paginate.prev_page)return React.createElement("li",null,React.createElement("a",{href:"#","aria-label":"Previous",onClick:this.prevPage},React.createElement("span",{"aria-hidden":"true"},"\u2039")))}},{key:"renderNextArrow",value:function(){if(this.props.paginate.next_page)return React.createElement("li",null,React.createElement("a",{href:"#","aria-label":"Next",onClick:this.nextPage},React.createElement("span",{"aria-hidden":"true"},"\u203a")))}},{key:"renderLastArrow",value:function(){if(this.props.paginate.next_page)return React.createElement("li",null,React.createElement("a",{href:"#","aria-label":"Last",onClick:this.lastPage},React.createElement("span",{"aria-hidden":"true"},"\xbb")))}},{key:"renderPageNumbers",value:function(){for(var e=[],t=1;t<=this.props.paginate.total_pages;t++){Math.abs(this.props.paginate.current_page-t)<=3&&e.push(React.createElement(PaginationItem,{page:t,current_page:this.props.paginate.current_page,onPageChange:this.pageChange,key:t}))}return e}},{key:"renderPagingSummary",value:function(){var e=this.props.paginate,t=e.total_pages,n=e.total_count,r=e.current_page;if(0<t)return React.createElement("p",null,"Page ",r," of ",t," - ",n," record(s)")}},{key:"render",value:function(){return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12"},React.createElement("ul",{className:"pagination"},this.renderFirstArrow(),this.renderPrevArrow(),this.renderPageNumbers(),this.renderNextArrow(),this.renderLastArrow()),this.renderPagingSummary()))}}]),t}(React.Component),PaginationItem=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handlePageChange=this.handlePageChange.bind(this),this.renderLiClasses=this.renderLiClasses.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handlePageChange",value:function(e){e.preventDefault(),this.props.onPageChange(this.props.page)}},{key:"renderLiClasses",value:function(){return this.props.page==this.props.current_page?"active":""}},{key:"render",value:function(){return React.createElement("li",{className:this.renderLiClasses()},React.createElement("a",{href:"#",onClick:this.handlePageChange},this.props.page))}}]),t}(React.Component)),RatingStars=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderStars=this.renderStars.bind(this),this.handleRating=this.handleRating.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.renderCommentForm=this.renderCommentForm.bind(this),this.handleCommentChanged=this.handleCommentChanged.bind(this),this.submitRating=this.submitRating.bind(this),this.submitRatingDebounced=$.debounce(this.submitRating,1e3),this.state={rating:this.props.rating,comment:this.props.rater_comment,showCommentForm:!1,hoverStar:0}}return _inherits(t,e),_createClass(t,[{key:"submitRating",value:function(e,t){var n=this,r=$.ajax({url:this.props.path,dataType:"json",method:"POST",data:{stars:e,rater_comment:t}});r.done(function(){n.setState({rating:e})}),r.fail(function(){alertify.alert("Could not rate user. Please try again!")})}},{key:"handleRating",value:function(e){this.setState({rating:e,showCommentForm:e<4}),this.submitRatingDebounced(e,this.state.comment)}},{key:"handleSubmit",value:function(){var e=this;(this.submitRatingDebounced(this.state.rating,this.state.comment),this.state.showCommentForm)&&($("#user-comment-form").slideUp(),$("#user-comment-feedback").show(),setTimeout(function(){$("#user-comment-feedback").slideUp(400,function(){e.setState({showCommentForm:!1})})},1500))}},{key:"handleCommentChanged",value:function(e){this.setState({comment:e.target.value})}},{key:"mouseEnterStar",value:function(e){this.setState({hoverStar:e})}},{key:"mouseLeaveStar",value:function(){this.setState({hoverStar:0})}},{key:"renderStars",value:function(){var n=this;return[1,2,3,4,5].map(function(t){return React.createElement("div",{className:"rating-star",key:t},React.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),n.handleRating(t)},onMouseEnter:function(){return n.mouseEnterStar(t)},onMouseLeave:function(){return n.mouseLeaveStar()}},React.createElement("i",{className:n.setStarClass(t)})))})}},{key:"setStarClass",value:function(e){return this.state.hoverStar>=e||0==this.state.hoverStar&&this.state.rating>=e?"fa fa-star":"fa fa-star-o"}},{key:"renderCommentForm",value:function(){return this.state.showCommentForm?React.createElement("div",{className:"user-comment-container"},React.createElement("div",{className:"form text-center",id:"user-comment-form"},React.createElement("textarea",{name:"rater_comment",className:"form-control user-comment-input",cols:"30",rows:"3",placeholder:"Please tell us about your experience, and how we can improve",id:"user-comment-input",onChange:this.handleCommentChanged}),React.createElement("button",{className:"btn btn-primary center-block",onClick:this.handleSubmit},"Send")),React.createElement("p",{className:"alert alert-success text-center",id:"user-comment-feedback",style:{display:"none"}},"Thank you for your feedback!")):null}},{key:"render",value:function(){return React.createElement("div",null,React.createElement("div",{className:"rating-stars rating-stars-xl rating-form rating-stars-center"},this.renderStars()),this.renderCommentForm())}}]),t}(React.Component)),Star=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){var e=$(this.star).width()*($(this.star).data("fill")/100);$(this.star).find("i:last-of-type").css({width:e})}},{key:"render",value:function(){var t=this;return React.createElement("div",{ref:function(e){return t.star=e},className:"rating-star","data-fill":this.props.percentage},React.createElement("i",{className:"fa fa-star-o"}),React.createElement("i",{className:"fa fa-star"}))}}]),t}(React.Component)),Stars=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.drawStars=this.drawStars.bind(this),this.renderClassName=this.renderClassName(this)}return _inherits(t,e),_createClass(t,[{key:"renderClassName",value:function(){return this.props.size?"rating-stars rating-stars-"+this.props.size:"rating-stars rating-stars-sm"}},{key:"drawStars",value:function(){for(var e=Math.floor(this.props.rating),t=Math.floor(5-this.props.rating),n=this.props.rating%1*100,r=[],a=0;a<e;a++)r.push(React.createElement(Star,{percentage:"100",key:"whole-"+(a+1)}));0!=n&&r.push(React.createElement(Star,{percentage:n,key:"partial"}));for(a=0;a<t;a++)r.push(React.createElement(Star,{percentage:"0",key:"empty-"+(a+1)}));return r}},{key:"render",value:function(){return React.createElement("div",{className:this.renderClassName},this.drawStars())}}]),t}(React.Component)),ServiceSearch=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.searchServices=this.searchServices.bind(this),this.searchServicesDebounced=$.debounce(this.searchServices,300),this.handleSearch=this.handleSearch.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.selectService=this.selectService.bind(this),this.goToService=this.goToService.bind(this),this.state={service:{},services:[]}}return _inherits(t,e),_createClass(t,[{key:"componentWillMount",value:function(){this.searchServices()}},{key:"searchServices",value:function(e){var r=this,t=$.ajax({url:"/regional_services/search",dataType:"json",method:"GET",data:{query:e}});t.done(function(e){r.setState({services:e})}),t.fail(function(e,t,n){console.error(r.props.url,t,n.toString())})}},{key:"handleSearch",value:function(e){this.searchServicesDebounced(e)}},{key:"handleSubmit",value:function(){this.state.service.id&&(window.location.href="/jobs/new?job[service]="+this.state.service.service_id)}},{key:"selectService",value:function(e){this.setState({service:e})}},{key:"goToService",value:function(e){var t=this;this.setState({service:e},function(){t.handleSubmit()})}},{key:"render",value:function(){return React.createElement("div",{id:"service-search"},React.createElement(ServiceSearchBar,{onSearch:this.handleSearch,placeholder:"What can we help you with?",value:this.state.query,onSubmit:this.handleSubmit,results:this.state.services,onResultClicked:this.goToService}))}}]),t}(React.Component)),ServiceSearchBar=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleQueryChange=this.handleQueryChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleQueryChange",value:function(e){this.props.onSearch(e)}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.onSubmit(!0)}},{key:"render",value:function(){var t=this;return React.createElement("form",{className:"service-search-form",onSubmit:function(e){return t.handleSubmit(e)}},React.createElement(ServiceSearchInputs,{placeholder:this.props.placeholder,onInputChanged:this.handleQueryChange,autoFocus:!0,results:this.props.results,resultClicked:this.props.onResultClicked,resultRow:ServiceSearchResultRow}))}}]),t}(React.Component)),ServiceSearchInputs=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"renderResultVisibility",value:function(){return this.props.state.showResult?"results show":"results hidden"}},{key:"render",value:function(){return React.createElement("div",{className:"autocomplete-form"},React.createElement("div",{className:"input-group"},React.createElement(AutocompleteInput,{autofocus:this.props.autofocus,placeholder:this.props.placeholder,inputClass:"form-control service-search-bar",bindKeyboard:this.props.fns.bindKeyboard,handleOnBlur:this.props.fns.handleOnBlur,handleOnClick:this.props.fns.showResult,selected:this.props.state.selected,handleOnChange:this.props.fns.handleInputChange}),React.createElement("span",{className:"input-group-btn"},React.createElement("button",{type:"button",className:"btn btn-default dropdown-btn",onClick:this.props.fns.toggleResult,onBlur:this.props.fns.hideResult},React.createElement("i",{className:"fa fa-angle-down"})))),React.createElement("div",{className:this.renderResultVisibility()},React.createElement(AutocompleteResult,{setPointer:this.props.fns.setPointer,pointer:this.props.state.pointer,registerRowRefs:this.props.fns.registerRowRefs,selected:this.props.state.selected,setSelected:this.props.fns.setSelected,processLabel:this.props.fns.processLabel,resultRow:this.props.resultRow,resultClicked:this.props.resultClicked,results:this.props.results,emptyRow:React.createElement("a",{href:"/contact_us"},"Need help? Contact us!")})))}}]),t}(React.Component));ServiceSearchInputs=autocompleteHOC(ServiceSearchInputs);_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var ServiceSearchResultRow=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("span",null,this.props.item.name)}}]),t}(React.Component),RateCard=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={service:React.PropTypes.object,flash_job:React.PropTypes.bool,regional_service:React.PropTypes.object,service_icon:React.PropTypes.string,user_signed_in:React.PropTypes.bool,coin_icon:React.PropTypes.string,timer_icon:React.PropTypes.string,appliance_love:React.PropTypes.bool,appliance_love_icon:React.PropTypes.string,regional_service_alerts:React.PropTypes.array},defaultProps={regional_service_alerts:[]},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderToDoModal=this.renderToDoModal.bind(this),this.renderAddToDo=this.renderAddToDo.bind(this),this.renderRatesSection=this.renderRatesSection.bind(this),this.renderServiceIcon=this.renderServiceIcon.bind(this),this.renderServiceName=this.renderServiceName.bind(this)}return _inherits(t,e),_createClass(t,[{key:"renderAddToDo",value:function(){return this.props.user_signed_in?React.createElement("p",null,React.createElement("a",{href:"#","data-toggle":"modal","data-target":"#to-do-modal"},React.createElement("i",{className:"fa fa-plus"})," Add to Todo list")):null}},{key:"renderToDoModal",value:function(){return this.props.user_signed_in?React.createElement(ToDoModal,{service_id:this.props.service.id}):null}},{key:"renderServiceIcon",value:function(){return className="service-icon img-circle",this.props.appliance_love?(src=this.props.appliance_love_icon,className+=" appliance-love-bg"):src=this.props.service_icon,React.createElement("img",{src:src,className:className})}},{key:"renderServiceName",value:function(){return customName=this.props.regional_service.custom_name||this.props.service.name,this.props.appliance_love?React.createElement("div",{className:"service-heading appliance-love"},React.createElement("p",null,customName),React.createElement("p",{className:"appliance-love-subheading"},"by Appliance Love")):React.createElement("div",{className:"service-heading"},React.createElement("p",null,customName))}},{key:"renderRatesSection",value:function(){return this.props.service.quoted?React.createElement(RateCardQuoted,null):React.createElement(RateCardRates,{quoted:this.props.service.quoted,flash_job:this.props.flash_job,flash_discount_cents:this.props.regional_service.local_discount_cents,unit_price_cents:this.props.regional_service.unit_price_cents,unit_price_currency:this.props.regional_service.currency,minimum_charge_cents:this.props.regional_service.minimum_charge_cents,minimum_charge_currency:this.props.regional_service.currency,alt_unit_price_cents:this.props.regional_service.alt_unit_price_cents,alt_unit:this.props.regional_service.alt_unit,unit:this.props.regional_service.unit,after_hours:this.props.regional_service.after_hours,coin_icon:this.props.coin_icon,timer_icon:this.props.timer_icon,use_alt_unit_price:this.props.regional_service.use_alt_unit_price,notice:this.props.regional_service.notice,appliance_love:this.props.appliance_love})}},{key:"renderServiceAlerts",value:function(){return 0<this.props.regional_service_alerts.length?this.props.regional_service_alerts.map(function(e){var t="alert alert-info";return"good"===e.sentiment?t="alert alert-success":"bad"===e.sentiment&&(t="alert alert-danger"),React.createElement("p",{key:"service-alert-"+e.id,className:t},e.message)}):null}},{key:"render",value:function(){return React.createElement("div",{id:"rate-card"},React.createElement("div",{id:"rate-left",className:"border-right"},this.renderServiceIcon(),this.renderServiceName(),React.createElement("p",{className:"service-description"},this.props.regional_service.description),this.renderServiceAlerts(),React.createElement("div",{className:"service-rating"},React.createElement(Stars,{rating:"4.5",size:"md"}),React.createElement("p",null,"Only 4+ Star Professionals"),this.renderAddToDo())),this.renderRatesSection(),React.createElement("div",{id:"rate-bottom"},React.createElement(RateCardDetails,{service:this.props.service})),this.renderToDoModal())}}]),t}(React.Component));RateCard.propTypes=propTypes,RateCard.defaultProps=defaultProps;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var RateCardAfterHours=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"afterHoursClass",value:function(){return this.props.appliance_love?"rate-secondary appliance-love":"rate-secondary"}},{key:"render",value:function(){return this.props.after_hours?React.createElement("div",{className:"rate-row"},React.createElement("div",{className:"rate-label"},React.createElement("img",{className:"icon",src:this.props.timer_icon}),React.createElement("p",{className:this.afterHoursClass()},React.createElement("span",null,"1.5x"),React.createElement("br",null),React.createElement("span",{className:"small"},"After hour rate")),React.createElement("p",{className:"subdued"},"M-F after 5pm, Sat-Sun and Holidays"))):null}}]),t}(React.Component),RateCardDetails=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,
r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.toggleRateDetails=this.toggleRateDetails.bind(this),this.renderVisibleMsg=this.renderVisibleMsg.bind(this),this.state={visible:!1}}return _inherits(t,e),_createClass(t,[{key:"toggleRateDetails",value:function(e){e.preventDefault(),this.setState({visible:!this.state.visible}),this.state.visible?$(".rate-details").slideUp():($(".rate-details").slideDown(),analytics.track("Pricing Details Viewed",{service:this.props.service}))}},{key:"renderVisibleMsg",value:function(){return this.state.visible?"Okay, got it!":"Questions about our rates?"}},{key:"render",value:function(){return React.createElement("div",{id:"rate-details-container"},React.createElement("p",{className:"text-hr"},React.createElement("i",{className:"fa toggle-details",onClick:this.toggleRateDetails},this.renderVisibleMsg())),React.createElement("div",{className:"rate-details"},React.createElement("p",null,"We've already done the work of calling around! Jiffy rates and job minimums are based on industry averages per category."),React.createElement("p",null,React.createElement("b",null,"Have a large job?"),React.createElement("br",null),"For larger jobs (think $500+), our professionals are happy to provide a free, flat-rate quote. Simply request that you'd like a free quote in the job description. Your credit card is still required to submit the request, but rest assured nothing is charged until after the job is complete."),React.createElement("p",null,React.createElement("b",null,"What happens next?"),React.createElement("br",null),"Once your job is accepted, your professional will be in touch, and if possible, give a quick idea of scope prior to arrival. Keep in mind it's often difficult to determine the scope of a job until they arrive on-site."),React.createElement("p",null,React.createElement("b",null,"Need to cancel? No problem!"),React.createElement("br",null),"If for any reason you aren't satisfied with the pre-arrival discussion and/or their estimate - you can cancel up until they've left for the appointment for no charge."),React.createElement("hr",null)))}}]),t}(React.Component)),RateCardMinimum=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"showAfterHours",value:function(){if(this.props.after_hours)return"M-F before 5pm"}},{key:"minimumChargeClass",value:function(){return this.props.appliance_love?"rate-primary appliance-love":"rate-primary"}},{key:"render",value:function(){return React.createElement("div",{className:"rate-row primary-row"},React.createElement("p",{className:this.minimumChargeClass()},this.props.minimum_charge),React.createElement("p",{className:"subdued"},"For the first",this.props.unit))}}]),t}(React.Component)),RateCardQuoted=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{id:"rate-right"},React.createElement("div",{className:"rate-quote"},React.createElement("p",{className:"quote-heading"},"FREE",React.createElement("br",null),"QUOTE!"),React.createElement("p",{className:"subdued subdued-sm"},"We'll instantly match you with an amazing company to provide a quote. It's that easy.")))}}]),t}(React.Component)),RateCardRates=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"getUnit",value:function(){var e=(this.props.minimum_charge_cents/this.props.unit_price_cents).toFixed(1);return 1==e?" "+this.props.unit:" "+e+" "+this.props.unit+"s"}},{key:"formatCurrency",value:function(e,t){if(e&&t)return"$"+e/100}},{key:"getMinimumCharge",value:function(){var e=this.props.minimum_charge_cents;return this.props.flash_job&&(e-=this.props.flash_discount_cents),this.formatCurrency(e,this.props.minimum_charge_currency)}},{key:"getUnitPrice",value:function(e){return this.formatCurrency(e,this.props.unit_price_currency)}},{key:"renderUnitPrice",value:function(){return this.props.use_alt_unit_price?React.createElement(RateCardUnitPrice,{unit_price:this.getUnitPrice(this.props.alt_unit_price_cents),unit:this.props.alt_unit,coin_icon:this.props.coin_icon,appliance_love:this.props.appliance_love}):React.createElement(RateCardUnitPrice,{unit_price:this.getUnitPrice(this.props.unit_price_cents),unit:this.props.unit,coin_icon:this.props.coin_icon,appliance_love:this.props.appliance_love})}},{key:"render",value:function(){return React.createElement("div",{id:"rate-right"},React.createElement(RateCardMinimum,{minimum_charge:this.getMinimumCharge(),unit:this.getUnit(),after_hours:this.props.after_hours,appliance_love:this.props.appliance_love}),this.renderUnitPrice(),React.createElement("hr",null),React.createElement(RateCardAfterHours,{after_hours:this.props.after_hours,timer_icon:this.props.timer_icon,appliance_love:this.props.appliance_love}),React.createElement("div",{className:"rate-row"},React.createElement("p",{className:"subdued subdued-sm"},this.props.notice)))}}]),t}(React.Component)),RateCardUnitPrice=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"unitPriceClass",value:function(){return this.props.appliance_love?"rate-secondary appliance-love":"rate-secondary"}},{key:"render",value:function(){return React.createElement("div",{className:"rate-row"},React.createElement("div",{className:"rate-label"},React.createElement("img",{className:"icon",src:this.props.coin_icon}),React.createElement("p",{className:this.unitPriceClass()},this.props.unit_price),React.createElement("p",{className:"subdued"},"Every additional ",this.props.unit)))}}]),t}(React.Component)),ToDoModal=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},propTypes={service_id:React.PropTypes.number},function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{id:"to-do-modal",className:"modal fade",role:"dialog"},React.createElement("div",{className:"modal-dialog",role:"document"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("h4",{className:"modal-title"},"Add to Todos")),React.createElement("form",{action:"/todo_items",method:"POST"},React.createElement("div",{className:"modal-body"},React.createElement("input",{type:"hidden",value:this.props.service_id,name:"todo_item[service_id]"}),React.createElement("input",{type:"hidden",value:$("meta[name=csrf-token]").attr("content"),name:"authenticity_token"}),React.createElement("div",{className:"form-group"},React.createElement("label",null," Description "),React.createElement("textarea",{name:"todo_item[description]",className:"form-control"}))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"submit",className:"btn btn-primary"},"Add"))))))}}]),t}(React.Component));ToDoModal.propTypes=propTypes;_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}};var Txns=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleSubmit=this.handleSubmit.bind(this)}return _inherits(t,e),_createClass(t,[{key:"handleSubmit",value:function(e){var t=this,n=$.ajax({url:this.props.crudPaths.create,dataType:"JSON",data:{txn:e},type:"POST"});n.done(function(){t.modalForm.reset(),$("#credit-form-modal").modal("hide")}),n.fail(function(){alertify.alert("Could not add credit for user!")})}},{key:"render",value:function(){var t=this;return React.createElement("div",null,React.createElement(TxnsModal,{ref:function(e){t.modalForm=e},model:this.props.model,crudPaths:this.props.crudPaths,onSubmit:this.handleSubmit}))}}]),t}(React.Component),TxnsForm=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.reset=this.reset.bind(this)}return _inherits(t,e),_createClass(t,[{key:"reset",value:function(){this.formRef.reset()}},{key:"render",value:function(){var t=this;return React.createElement(Form,{ref:function(e){t.formRef=e},model:this.props.model,onSubmit:this.props.onSubmit},React.createElement(SelectInput,{name:"label",label:"Label",collection:USER_TRANSACTION_FORM_LABELS}),React.createElement(NumberInputGroup,{name:"amount",label:"Amount",placeholder:"0.00",validate:["required"],addon:"$"}),React.createElement(SelectInput,{name:"currency",label:"Amount Currency",collection:["CAD","USD"]}),React.createElement(SubmitButton,{className:"btn btn-primary"},"Add"))}}]),t}(React.Component)),TxnsModal=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.reset=this.reset.bind(this)}return _inherits(t,e),_createClass(t,[{key:"reset",value:function(){this.formRef.reset()}},{key:"render",value:function(){var t=this;return React.createElement("div",{id:"credit-form-modal",className:"modal fade",role:"dialog"},React.createElement("div",{className:"modal-dialog",role:"document"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("button",{className:"close","data-dismiss":"modal"},React.createElement("i",{className:"fa fa-remove"})),React.createElement("h4",{className:"modal-title"},"Add Credit")),React.createElement("div",{className:"modal-body"},React.createElement(TxnsForm,{ref:function(e){t.formRef=e},model:this.props.model,crudPaths:this.props.crudPaths,onSubmit:this.props.onSubmit})))))}}]),t}(React.Component)),TxnsTable=(_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,s=t,i=n;r=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,s);if(o!==undefined){if("value"in o)return o.value;var l=o.get;return l===undefined?undefined:l.call(i)}var c=Object.getPrototypeOf(a);if(null===c)return undefined;e=c,t=s,n=i,r=!0,o=c=undefined}},ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.renderTxns=this.renderTxns.bind(this)}return _inherits(t,e),_createClass(t,[{key:"renderTxns",value:function(){return this.props.txns.map(function(e){return React.createElement(TxnsShow,{txn:e,key:e.id})})}},{key:"render",value:function(){return React.createElement("table",{className:"table table-bordered table-responsive table-hover"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Label"),React.createElement("th",null,"Amount"),React.createElement("th",null,"Source"),React.createElement("th",null,"Refunded?"),React.createElement("th",null,"Date"))),React.createElement(ReactCSSTransitionGroup,{component:"tbody",transitionName:"user-address",transitionEnterTimeout:2500,transitionLeaveTimeout:300,transitionAppearTimeout:500},this.renderTxns()))}}]),t}(React.Component));